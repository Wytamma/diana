import{s as ne,y as Q,A as _e,e as L,a as N,c as z,b as j,g as H,f as k,O as ue,p,v as K,i as W,h as D,P as F,B as ve,C as be,D as pe,J as Ue,Q as de,w as qe,z as me,R as B,F as De,t as Z,o as Y,d as J,n as X,aa as Je,L as Ge,j as he,G as Oe,I as Xe,k as re,S as Le}from"../chunks/scheduler.BVA84ec8.js";import{S as ae,i as ie,t as A,g as G,a as P,c as O,f as Ke,b as x,d as $,m as ee,e as te}from"../chunks/index.Cyvcw4y5.js";import{e as Se}from"../chunks/each.CoIRocyS.js";import{g as Ye}from"../chunks/stores.3EWPjMOX.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.C3cgmb5b.js";import{g as Qe}from"../chunks/spread.CN4WR7uZ.js";import{P as xe}from"../chunks/ProgressRadial.BSuWWcpg.js";import{a as fe}from"../chunks/annotationStore.BCJ_-HM9.js";import{i as oe}from"../chunks/insertStore.CrAMoOJo.js";import{t as ze}from"../chunks/TAStore.C5NiA75b.js";import{r as le}from"../chunks/refStore.yinBdsTv.js";import{i as ce}from"../chunks/igvStore.Bpt_H-Bn.js";const $e=s=>({}),Ve=s=>({}),et=s=>({}),Me=s=>({}),tt=s=>({}),Re=s=>({});function je(s){let e,t,l;const i=s[18].lead,n=_e(i,s,s[17],Re);return{c(){e=L("div"),n&&n.c(),this.h()},l(a){e=z(a,"DIV",{class:!0});var c=j(e);n&&n.l(c),c.forEach(k),this.h()},h(){p(e,"class",t="dropzone-lead "+s[5])},m(a,c){W(a,e,c),n&&n.m(e,null),l=!0},p(a,c){n&&n.p&&(!l||c[0]&131072)&&ve(n,i,a,a[17],l?pe(i,a[17],c,tt):be(a[17]),Re),(!l||c[0]&32&&t!==(t="dropzone-lead "+a[5]))&&p(e,"class",t)},i(a){l||(A(n,a),l=!0)},o(a){P(n,a),l=!1},d(a){a&&k(e),n&&n.d(a)}}}function st(s){let e,t="Upload a file",l;return{c(){e=L("strong"),e.textContent=t,l=Z(" or drag and drop")},l(i){e=z(i,"STRONG",{"data-svelte-h":!0}),Y(e)!=="svelte-13uz6lq"&&(e.textContent=t),l=J(i," or drag and drop")},m(i,n){W(i,e,n),W(i,l,n)},p:X,d(i){i&&(k(e),k(l))}}}function Ae(s){let e,t,l;const i=s[18].meta,n=_e(i,s,s[17],Ve);return{c(){e=L("small"),n&&n.c(),this.h()},l(a){e=z(a,"SMALL",{class:!0});var c=j(e);n&&n.l(c),c.forEach(k),this.h()},h(){p(e,"class",t="dropzone-meta "+s[7])},m(a,c){W(a,e,c),n&&n.m(e,null),l=!0},p(a,c){n&&n.p&&(!l||c[0]&131072)&&ve(n,i,a,a[17],l?pe(i,a[17],c,$e):be(a[17]),Ve),(!l||c[0]&128&&t!==(t="dropzone-meta "+a[7]))&&p(e,"class",t)},i(a){l||(A(n,a),l=!0)},o(a){P(n,a),l=!1},d(a){a&&k(e),n&&n.d(a)}}}function lt(s){let e,t,l,i,n,a,c,h,g,V,u,_,v,b,I,y,S=[{type:"file"},{name:s[2]},{class:l="dropzone-input "+s[9]},s[11]()],o={};for(let m=0;m<S.length;m+=1)o=Q(o,S[m]);let d=s[13].lead&&je(s);const T=s[18].message,w=_e(T,s,s[17],Me),M=w||st();let f=s[13].meta&&Ae(s);return{c(){e=L("div"),t=L("input"),i=N(),n=L("div"),a=L("div"),d&&d.c(),c=N(),h=L("div"),M&&M.c(),V=N(),f&&f.c(),this.h()},l(m){e=z(m,"DIV",{class:!0,"data-testid":!0});var E=j(e);t=z(E,"INPUT",{type:!0,name:!0,class:!0}),i=H(E),n=z(E,"DIV",{class:!0});var R=j(n);a=z(R,"DIV",{class:!0});var C=j(a);d&&d.l(C),c=H(C),h=z(C,"DIV",{class:!0});var U=j(h);M&&M.l(U),U.forEach(k),V=H(C),f&&f.l(C),C.forEach(k),R.forEach(k),E.forEach(k),this.h()},h(){ue(t,o),p(h,"class",g="dropzone-message "+s[6]),p(a,"class",u="dropzone-interface-text "+s[4]),p(n,"class",_="dropzone-interface "+s[8]+" "+s[3]),p(e,"class",v="dropzone "+s[10]),p(e,"data-testid","file-dropzone"),K(e,"opacity-50",s[12].disabled)},m(m,E){W(m,e,E),D(e,t),t.autofocus&&t.focus(),s[32](t),D(e,i),D(e,n),D(n,a),d&&d.m(a,null),D(a,c),D(a,h),M&&M.m(h,null),D(a,V),f&&f.m(a,null),b=!0,I||(y=[F(t,"change",s[31]),F(t,"change",s[19]),F(t,"dragenter",s[20]),F(t,"dragover",s[21]),F(t,"dragleave",s[22]),F(t,"drop",s[23]),F(t,"click",s[24]),F(t,"keydown",s[25]),F(t,"keyup",s[26]),F(t,"keypress",s[27]),F(t,"focus",s[28]),F(t,"focusin",s[29]),F(t,"focusout",s[30])],I=!0)},p(m,E){ue(t,o=Qe(S,[{type:"file"},(!b||E[0]&4)&&{name:m[2]},(!b||E[0]&512&&l!==(l="dropzone-input "+m[9]))&&{class:l},m[11]()])),m[13].lead?d?(d.p(m,E),E[0]&8192&&A(d,1)):(d=je(m),d.c(),A(d,1),d.m(a,c)):d&&(G(),P(d,1,1,()=>{d=null}),O()),w&&w.p&&(!b||E[0]&131072)&&ve(w,T,m,m[17],b?pe(T,m[17],E,et):be(m[17]),Me),(!b||E[0]&64&&g!==(g="dropzone-message "+m[6]))&&p(h,"class",g),m[13].meta?f?(f.p(m,E),E[0]&8192&&A(f,1)):(f=Ae(m),f.c(),A(f,1),f.m(a,null)):f&&(G(),P(f,1,1,()=>{f=null}),O()),(!b||E[0]&16&&u!==(u="dropzone-interface-text "+m[4]))&&p(a,"class",u),(!b||E[0]&264&&_!==(_="dropzone-interface "+m[8]+" "+m[3]))&&p(n,"class",_),(!b||E[0]&1024&&v!==(v="dropzone "+m[10]))&&p(e,"class",v),(!b||E[0]&5120)&&K(e,"opacity-50",m[12].disabled)},i(m){b||(A(d),A(M,m),A(f),b=!0)},o(m){P(d),P(M,m),P(f),b=!1},d(m){m&&k(e),s[32](null),d&&d.d(),M&&M.d(m),f&&f.d(),I=!1,Ue(y)}}}const nt="textarea relative flex justify-center items-center",at="w-full absolute top-0 left-0 right-0 bottom-0 z-[1] opacity-0 disabled:!opacity-0 cursor-pointer",it="flex justify-center items-center text-center";function rt(s,e,t){let l,i,n;const a=["files","fileInput","name","border","padding","rounded","regionInterface","regionInterfaceText","slotLead","slotMessage","slotMeta"];let c=de(e,a),{$$slots:h={},$$scope:g}=e;const V=qe(h);let{files:u=void 0}=e,{fileInput:_=void 0}=e,{name:v}=e,{border:b="border-2 border-dashed"}=e,{padding:I="p-4 py-8"}=e,{rounded:y="rounded-container-token"}=e,{regionInterface:S=""}=e,{regionInterfaceText:o=""}=e,{slotLead:d="mb-4"}=e,{slotMessage:T=""}=e,{slotMeta:w="opacity-75"}=e;function M(){return delete c.class,c}function f(r){B.call(this,s,r)}function m(r){B.call(this,s,r)}function E(r){B.call(this,s,r)}function R(r){B.call(this,s,r)}function C(r){B.call(this,s,r)}function U(r){B.call(this,s,r)}function q(r){B.call(this,s,r)}function se(r){B.call(this,s,r)}function ke(r){B.call(this,s,r)}function Te(r){B.call(this,s,r)}function Ie(r){B.call(this,s,r)}function ye(r){B.call(this,s,r)}function Ee(){u=this.files,t(0,u)}function we(r){De[r?"unshift":"push"](()=>{_=r,t(1,_)})}return s.$$set=r=>{t(33,e=Q(Q({},e),me(r))),t(12,c=de(e,a)),"files"in r&&t(0,u=r.files),"fileInput"in r&&t(1,_=r.fileInput),"name"in r&&t(2,v=r.name),"border"in r&&t(14,b=r.border),"padding"in r&&t(15,I=r.padding),"rounded"in r&&t(16,y=r.rounded),"regionInterface"in r&&t(3,S=r.regionInterface),"regionInterfaceText"in r&&t(4,o=r.regionInterfaceText),"slotLead"in r&&t(5,d=r.slotLead),"slotMessage"in r&&t(6,T=r.slotMessage),"slotMeta"in r&&t(7,w=r.slotMeta),"$$scope"in r&&t(17,g=r.$$scope)},s.$$.update=()=>{t(10,l=`${nt} ${b} ${I} ${y} ${e.class??""}`)},t(9,i=`${at}`),t(8,n=`${it}`),e=me(e),[u,_,v,S,o,d,T,w,n,i,l,M,c,V,b,I,y,g,h,f,m,E,R,C,U,q,se,ke,Te,Ie,ye,Ee,we]}class ot extends ae{constructor(e){super(),ie(this,e,rt,lt,ne,{files:0,fileInput:1,name:2,border:14,padding:15,rounded:16,regionInterface:3,regionInterfaceText:4,slotLead:5,slotMessage:6,slotMeta:7},null,[-1,-1])}}function Ce(s){let e,t;const l=s[22].default,i=_e(l,s,s[21],null);return{c(){e=L("div"),i&&i.c(),this.h()},l(n){e=z(n,"DIV",{class:!0});var a=j(e);i&&i.l(a),a.forEach(k),this.h()},h(){p(e,"class","slide-toggle-text ml-3")},m(n,a){W(n,e,a),i&&i.m(e,null),t=!0},p(n,a){i&&i.p&&(!t||a[0]&2097152)&&ve(i,l,n,n[21],t?pe(l,n[21],a,null):be(n[21]),null)},i(n){t||(A(i,n),t=!0)},o(n){P(i,n),t=!1},d(n){n&&k(e),i&&i.d(n)}}}function ct(s){let e,t,l,i,n,a,c,h,g,V,u,_,v,b,I,y=[{type:"checkbox"},{class:"slide-toggle-input hidden"},{name:s[1]},s[8](),{disabled:i=s[9].disabled}],S={};for(let d=0;d<y.length;d+=1)S=Q(S,y[d]);let o=s[10].default&&Ce(s);return{c(){e=L("div"),t=L("label"),l=L("input"),n=N(),a=L("div"),c=L("div"),V=N(),o&&o.c(),this.h()},l(d){e=z(d,"DIV",{id:!0,class:!0,"data-testid":!0,role:!0,"aria-label":!0,"aria-checked":!0,tabindex:!0});var T=j(e);t=z(T,"LABEL",{class:!0});var w=j(t);l=z(w,"INPUT",{type:!0,class:!0,name:!0}),n=H(w),a=z(w,"DIV",{class:!0});var M=j(a);c=z(M,"DIV",{class:!0}),j(c).forEach(k),M.forEach(k),V=H(w),o&&o.l(w),w.forEach(k),T.forEach(k),this.h()},h(){ue(l,S),p(c,"class",h="slide-toggle-thumb "+s[3]),K(c,"cursor-not-allowed",s[9].disabled),p(a,"class",g="slide-toggle-track "+s[4]),K(a,"cursor-not-allowed",s[9].disabled),p(t,"class",u="slide-toggle-label "+s[5]),p(e,"id",s[2]),p(e,"class",_="slide-toggle "+s[6]),p(e,"data-testid","slide-toggle"),p(e,"role","switch"),p(e,"aria-label",s[2]),p(e,"aria-checked",s[0]),p(e,"tabindex","0")},m(d,T){W(d,e,T),D(e,t),D(t,l),l.autofocus&&l.focus(),l.checked=s[0],D(t,n),D(t,a),D(a,c),D(t,V),o&&o.m(t,null),v=!0,b||(I=[F(l,"change",s[31]),F(l,"click",s[23]),F(l,"keydown",s[24]),F(l,"keyup",s[25]),F(l,"keypress",s[26]),F(l,"mouseover",s[27]),F(l,"change",s[28]),F(l,"focus",s[29]),F(l,"blur",s[30]),F(e,"keydown",s[7])],b=!0)},p(d,T){ue(l,S=Qe(y,[{type:"checkbox"},{class:"slide-toggle-input hidden"},(!v||T[0]&2)&&{name:d[1]},d[8](),(!v||T[0]&512&&i!==(i=d[9].disabled))&&{disabled:i}])),T[0]&1&&(l.checked=d[0]),(!v||T[0]&8&&h!==(h="slide-toggle-thumb "+d[3]))&&p(c,"class",h),(!v||T[0]&520)&&K(c,"cursor-not-allowed",d[9].disabled),(!v||T[0]&16&&g!==(g="slide-toggle-track "+d[4]))&&p(a,"class",g),(!v||T[0]&528)&&K(a,"cursor-not-allowed",d[9].disabled),d[10].default?o?(o.p(d,T),T[0]&1024&&A(o,1)):(o=Ce(d),o.c(),A(o,1),o.m(t,null)):o&&(G(),P(o,1,1,()=>{o=null}),O()),(!v||T[0]&32&&u!==(u="slide-toggle-label "+d[5]))&&p(t,"class",u),(!v||T[0]&4)&&p(e,"id",d[2]),(!v||T[0]&64&&_!==(_="slide-toggle "+d[6]))&&p(e,"class",_),(!v||T[0]&4)&&p(e,"aria-label",d[2]),(!v||T[0]&1)&&p(e,"aria-checked",d[0])},i(d){v||(A(o),v=!0)},o(d){P(o),v=!1},d(d){d&&k(e),o&&o.d(),b=!1,Ue(I)}}}const ft="inline-block",ut="unstyled flex items-center",dt="flex transition-all duration-[200ms] cursor-pointer",mt="w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow";function ht(s,e,t){let l,i,n,a,c,h,g,V;const u=["name","checked","size","background","active","border","rounded","label"];let _=de(e,u),{$$slots:v={},$$scope:b}=e;const I=qe(v),y=Je();let{name:S}=e,{checked:o=!1}=e,{size:d="md"}=e,{background:T="bg-surface-400 dark:bg-surface-700"}=e,{active:w="bg-surface-900 dark:bg-surface-300"}=e,{border:M=""}=e,{rounded:f="rounded-full"}=e,{label:m=""}=e,E;switch(d){case"sm":E="w-12 h-6";break;case"lg":E="w-20 h-10";break;default:E="w-16 h-8"}function R(r){["Enter","Space"].includes(r.code)&&(r.preventDefault(),y("keyup",r),r.currentTarget.firstChild.click())}function C(){return delete _.class,_}function U(r){B.call(this,s,r)}function q(r){B.call(this,s,r)}function se(r){B.call(this,s,r)}function ke(r){B.call(this,s,r)}function Te(r){B.call(this,s,r)}function Ie(r){B.call(this,s,r)}function ye(r){B.call(this,s,r)}function Ee(r){B.call(this,s,r)}function we(){o=this.checked,t(0,o)}return s.$$set=r=>{t(9,e=Q(Q({},e),me(r))),t(33,_=de(e,u)),"name"in r&&t(1,S=r.name),"checked"in r&&t(0,o=r.checked),"size"in r&&t(11,d=r.size),"background"in r&&t(12,T=r.background),"active"in r&&t(13,w=r.active),"border"in r&&t(14,M=r.border),"rounded"in r&&t(15,f=r.rounded),"label"in r&&t(2,m=r.label),"$$scope"in r&&t(21,b=r.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&12289&&t(19,l=o?w:`${T} cursor-pointer`),s.$$.dirty[0]&1&&t(18,i=o?"bg-white/75":"bg-white"),s.$$.dirty[0]&1&&t(17,n=o?"translate-x-full":""),t(20,a=e.disabled===!0?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer"),t(6,c=`${ft} ${f} ${a} ${e.class??""}`),s.$$.dirty[0]&638976&&t(4,g=`${dt} ${M} ${f} ${E} ${l}`),s.$$.dirty[0]&425984&&t(3,V=`${mt} ${f} ${i} ${n}`)},t(5,h=`${ut}`),e=me(e),[o,S,m,V,g,h,c,R,C,e,I,d,T,w,M,f,E,n,i,l,a,b,v,U,q,se,ke,Te,Ie,ye,Ee,we]}class gt extends ae{constructor(e){super(),ie(this,e,ht,ct,ne,{name:1,checked:0,size:11,background:12,active:13,border:14,rounded:15,label:2},null,[-1,-1])}}const ge=s=>s.replace(/\.[^/.]+$/,"");function _t(s){let e,t=s[0]?"Treatment":"Control",l,i;return{c(){e=L("span"),l=Z(t),this.h()},l(n){e=z(n,"SPAN",{class:!0});var a=j(e);l=J(a,t),a.forEach(k),this.h()},h(){p(e,"class",i=`chip ${s[0]?"variant-soft-primary":"variant-soft-surface"}`)},m(n,a){W(n,e,a),D(e,l)},p(n,a){a&1&&t!==(t=n[0]?"Treatment":"Control")&&he(l,t),a&1&&i!==(i=`chip ${n[0]?"variant-soft-primary":"variant-soft-surface"}`)&&p(e,"class",i)},d(n){n&&k(e)}}}function vt(s){let e,t,l,i,n=ge(s[1])+"",a,c,h,g,V,u,_,v='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',b,I,y;function S(d){s[4](d)}let o={active:"variant-soft-primary",size:"sm",class:"mr-2",name:"slide",$$slots:{default:[_t]},$$scope:{ctx:s}};return s[0]!==void 0&&(o.checked=s[0]),g=new gt({props:o}),De.push(()=>Ke(g,"checked",S)),g.$on("change",s[5]),{c(){e=L("div"),t=L("div"),l=L("div"),i=L("p"),a=Z(n),c=N(),h=L("div"),x(g.$$.fragment),u=N(),_=L("button"),_.innerHTML=v,this.h()},l(d){e=z(d,"DIV",{class:!0});var T=j(e);t=z(T,"DIV",{class:!0});var w=j(t);l=z(w,"DIV",{class:!0});var M=j(l);i=z(M,"P",{class:!0});var f=j(i);a=J(f,n),f.forEach(k),c=H(M),h=z(M,"DIV",{class:!0});var m=j(h);$(g.$$.fragment,m),u=H(m),_=z(m,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Y(_)!=="svelte-1m0ck3b"&&(_.innerHTML=v),m.forEach(k),M.forEach(k),w.forEach(k),T.forEach(k),this.h()},h(){p(i,"class","text-lg"),p(_,"type","button"),p(_,"class","btn-icon hover:variant-ringed-tertiary"),p(h,"class","flex justify-between items-center min-w-64"),p(l,"class","flex flex-col space-y-2 w-full"),p(t,"class","flex justify-center items-center space-x-2"),p(e,"class","card p-4")},m(d,T){W(d,e,T),D(e,t),D(t,l),D(l,i),D(i,a),D(l,c),D(l,h),ee(g,h,null),D(h,u),D(h,_),b=!0,I||(y=F(_,"click",function(){Ge(s[2])&&s[2].apply(this,arguments)}),I=!0)},p(d,[T]){s=d,(!b||T&2)&&n!==(n=ge(s[1])+"")&&he(a,n);const w={};T&65&&(w.$$scope={dirty:T,ctx:s}),!V&&T&1&&(V=!0,w.checked=s[0],Oe(()=>V=!1)),g.$set(w)},i(d){b||(A(g.$$.fragment,d),b=!0)},o(d){P(g.$$.fragment,d),b=!1},d(d){d&&k(e),te(g),I=!1,y()}}}function bt(s,e,t){let{filename:l}=e,{onRemove:i}=e,{onToggle:n}=e,{isTreatment:a=!1}=e;function c(g){a=g,t(0,a)}const h=()=>n(a);return s.$$set=g=>{"filename"in g&&t(1,l=g.filename),"onRemove"in g&&t(2,i=g.onRemove),"onToggle"in g&&t(3,n=g.onToggle),"isTreatment"in g&&t(0,a=g.isTreatment)},[a,l,i,n,c,h]}class pt extends ae{constructor(e){super(),ie(this,e,bt,vt,ne,{filename:1,onRemove:2,onToggle:3,isTreatment:0})}}function kt(s){let e,t,l,i,n=ge(s[0])+"",a,c,h,g,V,u,_,v,b='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',I,y;return{c(){e=L("div"),t=L("div"),l=L("div"),i=L("p"),a=Z(n),c=N(),h=L("div"),g=L("span"),V=Z(s[2]),_=N(),v=L("button"),v.innerHTML=b,this.h()},l(S){e=z(S,"DIV",{class:!0});var o=j(e);t=z(o,"DIV",{class:!0});var d=j(t);l=z(d,"DIV",{class:!0});var T=j(l);i=z(T,"P",{class:!0});var w=j(i);a=J(w,n),w.forEach(k),c=H(T),h=z(T,"DIV",{class:!0});var M=j(h);g=z(M,"SPAN",{class:!0});var f=j(g);V=J(f,s[2]),f.forEach(k),_=H(M),v=z(M,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Y(v)!=="svelte-1m0ck3b"&&(v.innerHTML=b),M.forEach(k),T.forEach(k),d.forEach(k),o.forEach(k),this.h()},h(){p(i,"class","text-lg"),p(g,"class",u=`chip ${s[3]}`),p(v,"type","button"),p(v,"class","btn-icon hover:variant-ringed-tertiary"),p(h,"class","flex justify-between items-center min-w-64"),p(l,"class","flex flex-col space-y-2 w-full"),p(t,"class","flex justify-center items-center space-x-2"),p(e,"class","card p-4")},m(S,o){W(S,e,o),D(e,t),D(t,l),D(l,i),D(i,a),D(l,c),D(l,h),D(h,g),D(g,V),D(h,_),D(h,v),I||(y=F(v,"click",function(){Ge(s[1])&&s[1].apply(this,arguments)}),I=!0)},p(S,[o]){s=S,o&1&&n!==(n=ge(s[0])+"")&&he(a,n),o&4&&he(V,s[2]),o&8&&u!==(u=`chip ${s[3]}`)&&p(g,"class",u)},i:X,o:X,d(S){S&&k(e),I=!1,y()}}}function Tt(s,e,t){let{filename:l}=e,{onRemove:i}=e,{type:n}=e,{chip:a="variant-soft-success"}=e;return s.$$set=c=>{"filename"in c&&t(0,l=c.filename),"onRemove"in c&&t(1,i=c.onRemove),"type"in c&&t(2,n=c.type),"chip"in c&&t(3,a=c.chip)},[l,i,n,a]}class Ze extends ae{constructor(e){super(),ie(this,e,Tt,kt,ne,{filename:0,onRemove:1,type:2,chip:3})}}function It(s){const e=s.split(`
`),t=["##gff-version 3"],l=[];let i="",n=!1,a=null;const c=[];let h="";const g=u=>{let _="+";u.startsWith("complement(")&&(_="-",u=u.replace("complement(","").replace(")",""));const[v,b]=u.split("..");return{start:parseInt(v,10),end:parseInt(b,10),strand:_}},V=()=>{if(h&&i){l.push(`>${h}`);for(let u=0;u<i.length;u+=60)l.push(i.slice(u,u+60));c.forEach(u=>{u.attributes.gene?u.attributes.Name=u.attributes.gene:u.attributes.product?u.attributes.Name=u.attributes.product:u.attributes.note&&(u.attributes.Name=u.attributes.note),u.type==="source"&&(u.attributes.Name=u.attributes.organism);const _=Object.entries(u.attributes||{}).map(([v,b])=>`${v}=${b}`).join(";");t.push(`${h}	diana	${u.type}	${u.start}	${u.end}	.	${u.strand}	.	${_}`)}),i="",c.length=0}};return e.forEach(u=>{if(u.startsWith("LOCUS"))V(),h=u.split(/\s+/)[1];else if(!u.startsWith("FEATURES"))if(u.startsWith("ORIGIN"))n=!0;else if(n)i+=u.replace(/[^a-zA-Z]/g,"");else if(u.trim().startsWith("CDS")||u.trim().startsWith("gene")||u.trim().startsWith("source")){const _=u.trim().split(/\s+/,2);if(_.length===2){const v=_[0],b=_[1],{start:I,end:y,strand:S}=g(b);a&&c.push(a),a={type:v,start:I,end:y,strand:S,attributes:{}}}}else if(a&&u.trim().startsWith("/")){const _=u.trim().match(/^\/(\S+?)=(?:"(.+?)"|(.+))/);if(_){const[,v,b,I]=_,y=b||I||"";a.attributes[v]=y}}else if(a&&/^\s+[^/]/.test(u)){const _=Object.keys(a.attributes).pop();_&&(a.attributes[_]+=u.trim())}else console.log("Unhandled line:",u)}),V(),{gff:t.join(`
`),fasta:l.join(`
`)}}function Fe(s,e,t){const l=s.slice();return l[11]=e[t][0],l[12]=e[t][1].isTreatment,l[14]=t,l}function Pe(s){let e,t,l;return t=new Ze({props:{type:"Reference",filename:s[2].filename,onRemove:le.reset}}),{c(){e=L("div"),x(t.$$.fragment),this.h()},l(i){e=z(i,"DIV",{class:!0});var n=j(e);$(t.$$.fragment,n),n.forEach(k),this.h()},h(){p(e,"class","m-2 w-full md:w-auto")},m(i,n){W(i,e,n),ee(t,e,null),l=!0},p(i,n){const a={};n&4&&(a.filename=i[2].filename),t.$set(a)},i(i){l||(A(t.$$.fragment,i),l=!0)},o(i){P(t.$$.fragment,i),l=!1},d(i){i&&k(e),te(t)}}}function We(s){let e,t,l;return t=new Ze({props:{type:"Annotations",chip:"variant-soft-warning",filename:s[3].filename,onRemove:fe.reset}}),{c(){e=L("div"),x(t.$$.fragment),this.h()},l(i){e=z(i,"DIV",{class:!0});var n=j(e);$(t.$$.fragment,n),n.forEach(k),this.h()},h(){p(e,"class","m-2 w-full md:w-auto")},m(i,n){W(i,e,n),ee(t,e,null),l=!0},p(i,n){const a={};n&8&&(a.filename=i[3].filename),t.$set(a)},i(i){l||(A(t.$$.fragment,i),l=!0)},o(i){P(t.$$.fragment,i),l=!1},d(i){i&&k(e),te(t)}}}function Be(s){let e,t,l,i;function n(...c){return s[6](s[11],...c)}function a(){return s[7](s[11])}return t=new pt({props:{isTreatment:s[12],onToggle:n,onRemove:a,filename:s[11]}}),{c(){e=L("div"),x(t.$$.fragment),l=N(),this.h()},l(c){e=z(c,"DIV",{class:!0});var h=j(e);$(t.$$.fragment,h),l=H(h),h.forEach(k),this.h()},h(){p(e,"class","m-2 w-full md:w-auto ")},m(c,h){W(c,e,h),ee(t,e,null),D(e,l),i=!0},p(c,h){s=c;const g={};h&16&&(g.isTreatment=s[12]),h&16&&(g.onToggle=n),h&16&&(g.onRemove=a),h&16&&(g.filename=s[11]),t.$set(g)},i(c){i||(A(t.$$.fragment,c),i=!0)},o(c){P(t.$$.fragment,c),i=!1},d(c){c&&k(e),te(t)}}}function yt(s){let e,t,l;function i(a){s[8](a)}let n={padding:"py-4",name:"files",multiple:!0,$$slots:{meta:[zt],message:[Lt],lead:[wt]},$$scope:{ctx:s}};return s[0]!==void 0&&(n.files=s[0]),e=new ot({props:n}),De.push(()=>Ke(e,"files",i)),e.$on("change",s[5]),e.$on("click",Ne),e.$on("drop",Ne),{c(){x(e.$$.fragment)},l(a){$(e.$$.fragment,a)},m(a,c){ee(e,a,c),l=!0},p(a,c){const h={};c&32768&&(h.$$scope={dirty:c,ctx:a}),!t&&c&1&&(t=!0,h.files=a[0],Oe(()=>t=!1)),e.$set(h)},i(a){l||(A(e.$$.fragment,a),l=!0)},o(a){P(e.$$.fragment,a),l=!1},d(a){te(e,a)}}}function Et(s){let e,t,l;return t=new xe({props:{value:void 0,width:"w-16",strokeLinecap:"round"}}),{c(){e=L("div"),x(t.$$.fragment),this.h()},l(i){e=z(i,"DIV",{class:!0});var n=j(e);$(t.$$.fragment,n),n.forEach(k),this.h()},h(){p(e,"class","flex items-center justify-center align-middle")},m(i,n){W(i,e,n),ee(t,e,null),l=!0},p:X,i(i){l||(A(t.$$.fragment,i),l=!0)},o(i){P(t.$$.fragment,i),l=!1},d(i){i&&k(e),te(t)}}}function wt(s){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-8"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg>';return{c(){e=L("div"),e.innerHTML=t,this.h()},l(l){e=z(l,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-stz8rw"&&(e.innerHTML=t),this.h()},h(){p(e,"class","flex justify-center")},m(l,i){W(l,e,i)},p:X,d(l){l&&k(e)}}}function Lt(s){let e,t='<span class="font-semibold">Load files</span> or drag and drop';return{c(){e=L("p"),e.innerHTML=t,this.h()},l(l){e=z(l,"P",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-10rbgmq"&&(e.innerHTML=t),this.h()},h(){p(e,"class","text-xl ")},m(l,i){W(l,e,i)},p:X,d(l){l&&k(e)}}}function zt(s){let e;return{c(){e=Z("GENBANK, GFF, FASTA and userplot files allowed.")},l(t){e=J(t,"GENBANK, GFF, FASTA and userplot files allowed.")},m(t,l){W(t,e,l)},d(t){t&&k(e)}}}function Dt(s){let e,t='<div class="flex flex-col items-center align-baseline justify-center max-w-4xl space-y-8 "><figure class="card-hover rounded-full svelte-ppo8by"><div><section class="img-bg svelte-ppo8by"></section></div> <img class="logo-img mt-8 svelte-ppo8by" src="/images/logo2.png" alt="Skeleton Logo"/></figure> <h1 class="text-center text-3xl mx-2">Transposon Sequencing Data Visualiser</h1></div>',l,i,n,a,c,h,g,V,u,_,v,b,I=s[2].filename&&Pe(s),y=s[3].filename&&We(s),S=Se(Array.from(s[4].entries()).sort(He)),o=[];for(let f=0;f<S.length;f+=1)o[f]=Be(Fe(s,S,f));const d=f=>P(o[f],1,1,()=>{o[f]=null}),T=[Et,yt],w=[];function M(f,m){return f[1]?0:1}return _=M(s),v=w[_]=T[_](s),{c(){e=L("div"),e.innerHTML=t,l=N(),i=L("div"),n=L("div"),I&&I.c(),a=N(),y&&y.c(),c=N(),h=L("div");for(let f=0;f<o.length;f+=1)o[f].c();g=N(),V=L("div"),u=L("div"),v.c(),this.h()},l(f){e=z(f,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-kcnmyh"&&(e.innerHTML=t),l=H(f),i=z(f,"DIV",{class:!0});var m=j(i);n=z(m,"DIV",{class:!0});var E=j(n);I&&I.l(E),a=H(E),y&&y.l(E),E.forEach(k),c=H(m),h=z(m,"DIV",{class:!0});var R=j(h);for(let q=0;q<o.length;q+=1)o[q].l(R);R.forEach(k),m.forEach(k),g=H(f),V=z(f,"DIV",{class:!0});var C=j(V);u=z(C,"DIV",{class:!0});var U=j(u);v.l(U),U.forEach(k),C.forEach(k),this.h()},h(){p(e,"class","flex justify-center mb-6"),p(n,"class","flex flex-wrap justify-center w-full"),p(h,"class","flex flex-wrap justify-center "),p(i,"class","flex flex-col justify-center items-center mb-6"),p(u,"class","w-full max-w-3xl mx-4 mb-4"),p(V,"class","flex justify-center ")},m(f,m){W(f,e,m),W(f,l,m),W(f,i,m),D(i,n),I&&I.m(n,null),D(n,a),y&&y.m(n,null),D(i,c),D(i,h);for(let E=0;E<o.length;E+=1)o[E]&&o[E].m(h,null);W(f,g,m),W(f,V,m),D(V,u),w[_].m(u,null),b=!0},p(f,[m]){if(f[2].filename?I?(I.p(f,m),m&4&&A(I,1)):(I=Pe(f),I.c(),A(I,1),I.m(n,a)):I&&(G(),P(I,1,1,()=>{I=null}),O()),f[3].filename?y?(y.p(f,m),m&8&&A(y,1)):(y=We(f),y.c(),A(y,1),y.m(n,null)):y&&(G(),P(y,1,1,()=>{y=null}),O()),m&16){S=Se(Array.from(f[4].entries()).sort(He));let R;for(R=0;R<S.length;R+=1){const C=Fe(f,S,R);o[R]?(o[R].p(C,m),A(o[R],1)):(o[R]=Be(C),o[R].c(),A(o[R],1),o[R].m(h,null))}for(G(),R=S.length;R<o.length;R+=1)d(R);O()}let E=_;_=M(f),_===E?w[_].p(f,m):(G(),P(w[E],1,1,()=>{w[E]=null}),O(),v=w[_],v?v.p(f,m):(v=w[_]=T[_](f),v.c()),A(v,1),v.m(u,null))},i(f){if(!b){A(I),A(y);for(let m=0;m<S.length;m+=1)A(o[m]);A(v),b=!0}},o(f){P(I),P(y),o=o.filter(Boolean);for(let m=0;m<o.length;m+=1)P(o[m]);P(v),b=!1},d(f){f&&(k(e),k(l),k(i),k(g),k(V)),I&&I.d(),y&&y.d(),Xe(o,f),w[_].d()}}}function St(s){const e=s.split(`
`);let t="",l="",i=!1;for(const n of e){if(n.startsWith("##FASTA")){i=!0;continue}i&&(n.startsWith(">")?(l&&(t+=l+`
`),l=n+`
`):l+=n.trim())}return l&&(t+=l+`
`),t.trim()}function Ne(){const s=document.getElementsByName("files")[0];s.value=""}const He=([s],[e])=>s.localeCompare(e);function Vt(s,e,t){let l,i,n,a;re(s,ce,b=>t(9,l=b)),re(s,le,b=>t(2,i=b)),re(s,fe,b=>t(3,n=b)),re(s,oe,b=>t(4,a=b));const c=Ye();let h,g=!1;function V(b){if(!h||h.length===0)return;t(1,g=!0);let I=[];for(let y=0;y<h.length;y++){const S=h[y],o=S.name,d=new FileReader;I.push(new Promise((T,w)=>{d.onload=async M=>{var m,E;let f=(E=(m=M.target)==null?void 0:m.result)==null?void 0:E.toString();if(o.endsWith(".gb")||o.endsWith(".gbk")||o.endsWith(".genbank")){const{gff:R,fasta:C}=It(f);await fe.load(o,R),Le(ce,l.locus=void 0,l),C.length>0&&(await le.load(o,C).catch(U=>{console.error("Error loading reference:",U);const se={message:"Error loading reference: "+U,background:"variant-glass-error"};c.trigger(se)}),await ze.load(C),T(0))}else if(o.endsWith(".gff")||o.endsWith(".gff3")){await fe.load(o,f),Le(ce,l.locus=void 0,l);const R=St(f);R.length>0&&(await le.load(o,R).catch(C=>{console.error("Error loading reference:",C);const q={message:"Error loading reference: "+C,background:"variant-glass-error"};c.trigger(q)}),await ze.load(R),T(0))}else if(o.endsWith(".fasta")||o.endsWith(".fa"))await le.load(o,f),await ze.load(f),Le(ce,l.locus=void 0,l),T(0);else if(o.endsWith(".userplot")||o.endsWith(".plot"))await oe.load(o,f);else{console.error("Unsupported file type:",o);const C={message:"Unsupported file type: "+o,background:"variant-glass-error"};c.trigger(C),w("Unsupported file type: "+o)}T(0)},d.onerror=w,d.readAsText(S)}))}Promise.all(I).then(y=>{t(1,g=!1)}).catch(y=>{console.error("Error reading files:",y),t(1,g=!1)})}const u=(b,I)=>oe.setIsTreatment(b,I),_=b=>oe.remove(b);function v(b){h=b,t(0,h)}return[h,g,i,n,a,V,u,_,v]}class Gt extends ae{constructor(e){super(),ie(this,e,Vt,Dt,ne,{})}}export{Gt as component};
