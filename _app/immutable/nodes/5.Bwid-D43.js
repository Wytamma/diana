import{s as At,e as L,a as U,c as N,b as X,f as $,g as j,o as kr,p as de,u as wr,i as ae,h as b,M as dn,n as pt,P as fn,k as Rt,I as pn,t as le,d as ue,j as Ce}from"../chunks/scheduler.Cnzm-Pn7.js";import{S as xt,i as Dt,t as O,g as Or,a as B,c as Pr,b as F,d as V,m as q,e as z}from"../chunks/index.BWxcAyja.js";import{i as mn}from"../chunks/insertStore.BQt5VxlP.js";import{a as yn}from"../chunks/annotationStore.DGj68on5.js";import{g as gr}from"../chunks/generateGeneInsertSites.ozbo97IV.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.aA2OJerz.js";import{P as wn}from"../chunks/ProgressRadial.ILNWxSmG.js";import{P as dt}from"../chunks/plotly.cbd5aJyv.js";import{e as br}from"../chunks/each.SoU_5gPK.js";import{S as gn,T as Me,a as Le,R as bn,b as vn,P as En,D as _n}from"../chunks/Datatable.svelte_svelte_type_style_lang.nWv56wJ0.js";var Lt={},Tn=Object.create,Ir=Object.defineProperty,Rn=Object.getOwnPropertyDescriptor,$n=Object.getOwnPropertyNames,Sn=Object.getPrototypeOf,An=Object.prototype.hasOwnProperty,rr=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xn=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of $n(t))!An.call(e,i)&&i!==r&&Ir(e,i,{get:()=>t[i],enumerable:!(n=Rn(t,i))||n.enumerable});return e},nr=(e,t,r)=>(r=e!=null?Tn(Sn(e)):{},xn(!e||!e.__esModule?Ir(r,"default",{value:e,enumerable:!0}):r,e)),sr=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},f=(e,t,r)=>(sr(e,t,"read from private field"),r?r.call(e):t.get(e)),D=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},ie=(e,t,r,n)=>(sr(e,t,"write to private field"),t.set(e,r),r),me=(e,t,r)=>(sr(e,t,"access private method"),r),Ut=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getUint64=e.getInt64=e.setInt64=e.setUint64=e.UINT32_MAX=void 0,e.UINT32_MAX=4294967295;function t(a,s,o){let c=o/4294967296,u=o;a.setUint32(s,c),a.setUint32(s+4,u)}e.setUint64=t;function r(a,s,o){let c=Math.floor(o/4294967296),u=o;a.setUint32(s,c),a.setUint32(s+4,u)}e.setInt64=r;function n(a,s){let o=a.getInt32(s),c=a.getUint32(s+4);return o*4294967296+c}e.getInt64=n;function i(a,s){let o=a.getUint32(s),c=a.getUint32(s+4);return o*4294967296+c}e.getUint64=i}),ir=ne(e=>{var t,r,n;Object.defineProperty(e,"__esModule",{value:!0}),e.utf8DecodeTD=e.TEXT_DECODER_THRESHOLD=e.utf8DecodeJs=e.utf8EncodeTE=e.TEXT_ENCODER_THRESHOLD=e.utf8EncodeJs=e.utf8Count=void 0;var i=Ut(),a=(typeof process>"u"||((t=process==null?void 0:Lt)===null||t===void 0?void 0:t.TEXT_ENCODING)!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function s(l){let h=l.length,v=0,d=0;for(;d<h;){let R=l.charCodeAt(d++);if(R&4294967168)if(!(R&4294965248))v+=2;else{if(R>=55296&&R<=56319&&d<h){let _=l.charCodeAt(d);(_&64512)===56320&&(++d,R=((R&1023)<<10)+(_&1023)+65536)}R&4294901760?v+=4:v+=3}else{v++;continue}}return v}e.utf8Count=s;function o(l,h,v){let d=l.length,R=v,_=0;for(;_<d;){let x=l.charCodeAt(_++);if(x&4294967168)if(!(x&4294965248))h[R++]=x>>6&31|192;else{if(x>=55296&&x<=56319&&_<d){let A=l.charCodeAt(_);(A&64512)===56320&&(++_,x=((x&1023)<<10)+(A&1023)+65536)}x&4294901760?(h[R++]=x>>18&7|240,h[R++]=x>>12&63|128,h[R++]=x>>6&63|128):(h[R++]=x>>12&15|224,h[R++]=x>>6&63|128)}else{h[R++]=x;continue}h[R++]=x&63|128}}e.utf8EncodeJs=o;var c=a?new TextEncoder:void 0;e.TEXT_ENCODER_THRESHOLD=a?typeof process<"u"&&((r=process==null?void 0:Lt)===null||r===void 0?void 0:r.TEXT_ENCODING)!=="force"?200:0:i.UINT32_MAX;function u(l,h,v){h.set(c.encode(l),v)}function m(l,h,v){c.encodeInto(l,h.subarray(v))}e.utf8EncodeTE=c!=null&&c.encodeInto?m:u;var y=4096;function g(l,h,v){let d=h,R=d+v,_=[],x="";for(;d<R;){let A=l[d++];if(!(A&128))_.push(A);else if((A&224)===192){let se=l[d++]&63;_.push((A&31)<<6|se)}else if((A&240)===224){let se=l[d++]&63,P=l[d++]&63;_.push((A&31)<<12|se<<6|P)}else if((A&248)===240){let se=l[d++]&63,P=l[d++]&63,ce=l[d++]&63,ee=(A&7)<<18|se<<12|P<<6|ce;ee>65535&&(ee-=65536,_.push(ee>>>10&1023|55296),ee=56320|ee&1023),_.push(ee)}else _.push(A);_.length>=y&&(x+=String.fromCharCode(..._),_.length=0)}return _.length>0&&(x+=String.fromCharCode(..._)),x}e.utf8DecodeJs=g;var E=a?new TextDecoder:null;e.TEXT_DECODER_THRESHOLD=a?typeof process<"u"&&((n=process==null?void 0:Lt)===null||n===void 0?void 0:n.TEXT_DECODER)!=="force"?200:0:i.UINT32_MAX;function T(l,h,v){let d=l.subarray(h,h+v);return E.decode(d)}e.utf8DecodeTD=T}),Br=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtData=void 0;var t=class{constructor(r,n){this.type=r,this.data=n}};e.ExtData=t}),ar=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DecodeError=void 0;var t=class extends Error{constructor(r){super(r);let n=Object.create(t.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:t.name})}};e.DecodeError=t}),Cr=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.timestampExtension=e.decodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimestampExtension=e.encodeDateToTimeSpec=e.encodeTimeSpecToTimestamp=e.EXT_TIMESTAMP=void 0;var t=ar(),r=Ut();e.EXT_TIMESTAMP=-1;var n=4294967296-1,i=17179869184-1;function a({sec:m,nsec:y}){if(m>=0&&y>=0&&m<=i)if(y===0&&m<=n){let g=new Uint8Array(4);return new DataView(g.buffer).setUint32(0,m),g}else{let g=m/4294967296,E=m&4294967295,T=new Uint8Array(8),l=new DataView(T.buffer);return l.setUint32(0,y<<2|g&3),l.setUint32(4,E),T}else{let g=new Uint8Array(12),E=new DataView(g.buffer);return E.setUint32(0,y),(0,r.setInt64)(E,4,m),g}}e.encodeTimeSpecToTimestamp=a;function s(m){let y=m.getTime(),g=Math.floor(y/1e3),E=(y-g*1e3)*1e6,T=Math.floor(E/1e9);return{sec:g+T,nsec:E-T*1e9}}e.encodeDateToTimeSpec=s;function o(m){if(m instanceof Date){let y=s(m);return a(y)}else return null}e.encodeTimestampExtension=o;function c(m){let y=new DataView(m.buffer,m.byteOffset,m.byteLength);switch(m.byteLength){case 4:return{sec:y.getUint32(0),nsec:0};case 8:{let g=y.getUint32(0),E=y.getUint32(4),T=(g&3)*4294967296+E,l=g>>>2;return{sec:T,nsec:l}}case 12:{let g=(0,r.getInt64)(y,4),E=y.getUint32(0);return{sec:g,nsec:E}}default:throw new t.DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${m.length}`)}}e.decodeTimestampToTimeSpec=c;function u(m){let y=c(m);return new Date(y.sec*1e3+y.nsec/1e6)}e.decodeTimestampExtension=u,e.timestampExtension={type:e.EXT_TIMESTAMP,encode:o,decode:u}}),or=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensionCodec=void 0;var t=Br(),r=Cr(),n=class{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(r.timestampExtension)}register({type:i,encode:a,decode:s}){if(i>=0)this.encoders[i]=a,this.decoders[i]=s;else{let o=1+i;this.builtInEncoders[o]=a,this.builtInDecoders[o]=s}}tryToEncode(i,a){for(let s=0;s<this.builtInEncoders.length;s++){let o=this.builtInEncoders[s];if(o!=null){let c=o(i,a);if(c!=null){let u=-1-s;return new t.ExtData(u,c)}}}for(let s=0;s<this.encoders.length;s++){let o=this.encoders[s];if(o!=null){let c=o(i,a);if(c!=null){let u=s;return new t.ExtData(u,c)}}}return i instanceof t.ExtData?i:null}decode(i,a,s){let o=a<0?this.builtInDecoders[-1-a]:this.decoders[a];return o?o(i,a,s):new t.ExtData(a,i)}};e.ExtensionCodec=n,n.defaultCodec=new n}),Mr=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDataView=e.ensureUint8Array=void 0;function t(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n instanceof ArrayBuffer?new Uint8Array(n):Uint8Array.from(n)}e.ensureUint8Array=t;function r(n){if(n instanceof ArrayBuffer)return new DataView(n);let i=t(n);return new DataView(i.buffer,i.byteOffset,i.byteLength)}e.createDataView=r}),Lr=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Encoder=e.DEFAULT_INITIAL_BUFFER_SIZE=e.DEFAULT_MAX_DEPTH=void 0;var t=ir(),r=or(),n=Ut(),i=Mr();e.DEFAULT_MAX_DEPTH=100,e.DEFAULT_INITIAL_BUFFER_SIZE=2048;var a=class{constructor(s=r.ExtensionCodec.defaultCodec,o=void 0,c=e.DEFAULT_MAX_DEPTH,u=e.DEFAULT_INITIAL_BUFFER_SIZE,m=!1,y=!1,g=!1,E=!1){this.extensionCodec=s,this.context=o,this.maxDepth=c,this.initialBufferSize=u,this.sortKeys=m,this.forceFloat32=y,this.ignoreUndefined=g,this.forceIntegerToFloat=E,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}reinitializeState(){this.pos=0}encodeSharedRef(s){return this.reinitializeState(),this.doEncode(s,1),this.bytes.subarray(0,this.pos)}encode(s){return this.reinitializeState(),this.doEncode(s,1),this.bytes.slice(0,this.pos)}doEncode(s,o){if(o>this.maxDepth)throw new Error(`Too deep objects in depth ${o}`);s==null?this.encodeNil():typeof s=="boolean"?this.encodeBoolean(s):typeof s=="number"?this.encodeNumber(s):typeof s=="string"?this.encodeString(s):this.encodeObject(s,o)}ensureBufferSizeToWrite(s){let o=this.pos+s;this.view.byteLength<o&&this.resizeBuffer(o*2)}resizeBuffer(s){let o=new ArrayBuffer(s),c=new Uint8Array(o),u=new DataView(o);c.set(this.bytes),this.view=u,this.bytes=c}encodeNil(){this.writeU8(192)}encodeBoolean(s){s===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(s){Number.isSafeInteger(s)&&!this.forceIntegerToFloat?s>=0?s<128?this.writeU8(s):s<256?(this.writeU8(204),this.writeU8(s)):s<65536?(this.writeU8(205),this.writeU16(s)):s<4294967296?(this.writeU8(206),this.writeU32(s)):(this.writeU8(207),this.writeU64(s)):s>=-32?this.writeU8(224|s+32):s>=-128?(this.writeU8(208),this.writeI8(s)):s>=-32768?(this.writeU8(209),this.writeI16(s)):s>=-2147483648?(this.writeU8(210),this.writeI32(s)):(this.writeU8(211),this.writeI64(s)):this.forceFloat32?(this.writeU8(202),this.writeF32(s)):(this.writeU8(203),this.writeF64(s))}writeStringHeader(s){if(s<32)this.writeU8(160+s);else if(s<256)this.writeU8(217),this.writeU8(s);else if(s<65536)this.writeU8(218),this.writeU16(s);else if(s<4294967296)this.writeU8(219),this.writeU32(s);else throw new Error(`Too long string: ${s} bytes in UTF-8`)}encodeString(s){if(s.length>t.TEXT_ENCODER_THRESHOLD){let o=(0,t.utf8Count)(s);this.ensureBufferSizeToWrite(5+o),this.writeStringHeader(o),(0,t.utf8EncodeTE)(s,this.bytes,this.pos),this.pos+=o}else{let o=(0,t.utf8Count)(s);this.ensureBufferSizeToWrite(5+o),this.writeStringHeader(o),(0,t.utf8EncodeJs)(s,this.bytes,this.pos),this.pos+=o}}encodeObject(s,o){let c=this.extensionCodec.tryToEncode(s,this.context);if(c!=null)this.encodeExtension(c);else if(Array.isArray(s))this.encodeArray(s,o);else if(ArrayBuffer.isView(s))this.encodeBinary(s);else if(typeof s=="object")this.encodeMap(s,o);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(s)}`)}encodeBinary(s){let o=s.byteLength;if(o<256)this.writeU8(196),this.writeU8(o);else if(o<65536)this.writeU8(197),this.writeU16(o);else if(o<4294967296)this.writeU8(198),this.writeU32(o);else throw new Error(`Too large binary: ${o}`);let c=(0,i.ensureUint8Array)(s);this.writeU8a(c)}encodeArray(s,o){let c=s.length;if(c<16)this.writeU8(144+c);else if(c<65536)this.writeU8(220),this.writeU16(c);else if(c<4294967296)this.writeU8(221),this.writeU32(c);else throw new Error(`Too large array: ${c}`);for(let u of s)this.doEncode(u,o+1)}countWithoutUndefined(s,o){let c=0;for(let u of o)s[u]!==void 0&&c++;return c}encodeMap(s,o){let c=Object.keys(s);this.sortKeys&&c.sort();let u=this.ignoreUndefined?this.countWithoutUndefined(s,c):c.length;if(u<16)this.writeU8(128+u);else if(u<65536)this.writeU8(222),this.writeU16(u);else if(u<4294967296)this.writeU8(223),this.writeU32(u);else throw new Error(`Too large map object: ${u}`);for(let m of c){let y=s[m];this.ignoreUndefined&&y===void 0||(this.encodeString(m),this.doEncode(y,o+1))}}encodeExtension(s){let o=s.data.length;if(o===1)this.writeU8(212);else if(o===2)this.writeU8(213);else if(o===4)this.writeU8(214);else if(o===8)this.writeU8(215);else if(o===16)this.writeU8(216);else if(o<256)this.writeU8(199),this.writeU8(o);else if(o<65536)this.writeU8(200),this.writeU16(o);else if(o<4294967296)this.writeU8(201),this.writeU32(o);else throw new Error(`Too large extension object: ${o}`);this.writeI8(s.type),this.writeU8a(s.data)}writeU8(s){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,s),this.pos++}writeU8a(s){let o=s.length;this.ensureBufferSizeToWrite(o),this.bytes.set(s,this.pos),this.pos+=o}writeI8(s){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,s),this.pos++}writeU16(s){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,s),this.pos+=2}writeI16(s){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,s),this.pos+=2}writeU32(s){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,s),this.pos+=4}writeI32(s){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,s),this.pos+=4}writeF32(s){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,s),this.pos+=4}writeF64(s){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,s),this.pos+=8}writeU64(s){this.ensureBufferSizeToWrite(8),(0,n.setUint64)(this.view,this.pos,s),this.pos+=8}writeI64(s){this.ensureBufferSizeToWrite(8),(0,n.setInt64)(this.view,this.pos,s),this.pos+=8}};e.Encoder=a}),Dn=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.encode=void 0;var t=Lr(),r={};function n(i,a=r){return new t.Encoder(a.extensionCodec,a.context,a.maxDepth,a.initialBufferSize,a.sortKeys,a.forceFloat32,a.ignoreUndefined,a.forceIntegerToFloat).encodeSharedRef(i)}e.encode=n}),Un=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.prettyByte=void 0;function t(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}e.prettyByte=t}),jn=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CachedKeyDecoder=void 0;var t=ir(),r=16,n=16,i=class{constructor(a=r,s=n){this.maxKeyLength=a,this.maxLengthPerKey=s,this.hit=0,this.miss=0,this.caches=[];for(let o=0;o<this.maxKeyLength;o++)this.caches.push([])}canBeCached(a){return a>0&&a<=this.maxKeyLength}find(a,s,o){let c=this.caches[o-1];e:for(let u of c){let m=u.bytes;for(let y=0;y<o;y++)if(m[y]!==a[s+y])continue e;return u.str}return null}store(a,s){let o=this.caches[a.length-1],c={bytes:a,str:s};o.length>=this.maxLengthPerKey?o[Math.random()*o.length|0]=c:o.push(c)}decode(a,s,o){let c=this.find(a,s,o);if(c!=null)return this.hit++,c;this.miss++;let u=(0,t.utf8DecodeJs)(a,s,o),m=Uint8Array.prototype.slice.call(a,s,s+o);return this.store(m,u),u}};e.CachedKeyDecoder=i}),lr=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.DataViewIndexOutOfBoundsError=void 0;var t=Un(),r=or(),n=Ut(),i=ir(),a=Mr(),s=jn(),o=ar(),c=l=>{let h=typeof l;return h==="string"||h==="number"},u=-1,m=new DataView(new ArrayBuffer(0)),y=new Uint8Array(m.buffer);e.DataViewIndexOutOfBoundsError=(()=>{try{m.getInt8(0)}catch(l){return l.constructor}throw new Error("never reached")})();var g=new e.DataViewIndexOutOfBoundsError("Insufficient data"),E=new s.CachedKeyDecoder,T=class{constructor(l=r.ExtensionCodec.defaultCodec,h=void 0,v=n.UINT32_MAX,d=n.UINT32_MAX,R=n.UINT32_MAX,_=n.UINT32_MAX,x=n.UINT32_MAX,A=E){this.extensionCodec=l,this.context=h,this.maxStrLength=v,this.maxBinLength=d,this.maxArrayLength=R,this.maxMapLength=_,this.maxExtLength=x,this.keyDecoder=A,this.totalPos=0,this.pos=0,this.view=m,this.bytes=y,this.headByte=u,this.stack=[]}reinitializeState(){this.totalPos=0,this.headByte=u,this.stack.length=0}setBuffer(l){this.bytes=(0,a.ensureUint8Array)(l),this.view=(0,a.createDataView)(this.bytes),this.pos=0}appendBuffer(l){if(this.headByte===u&&!this.hasRemaining(1))this.setBuffer(l);else{let h=this.bytes.subarray(this.pos),v=(0,a.ensureUint8Array)(l),d=new Uint8Array(h.length+v.length);d.set(h),d.set(v,h.length),this.setBuffer(d)}}hasRemaining(l){return this.view.byteLength-this.pos>=l}createExtraByteError(l){let{view:h,pos:v}=this;return new RangeError(`Extra ${h.byteLength-v} of ${h.byteLength} byte(s) found at buffer[${l}]`)}decode(l){this.reinitializeState(),this.setBuffer(l);let h=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return h}*decodeMulti(l){for(this.reinitializeState(),this.setBuffer(l);this.hasRemaining(1);)yield this.doDecodeSync()}async decodeAsync(l){let h=!1,v;for await(let x of l){if(h)throw this.createExtraByteError(this.totalPos);this.appendBuffer(x);try{v=this.doDecodeSync(),h=!0}catch(A){if(!(A instanceof e.DataViewIndexOutOfBoundsError))throw A}this.totalPos+=this.pos}if(h){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return v}let{headByte:d,pos:R,totalPos:_}=this;throw new RangeError(`Insufficient data in parsing ${(0,t.prettyByte)(d)} at ${_} (${R} in the current buffer)`)}decodeArrayStream(l){return this.decodeMultiAsync(l,!0)}decodeStream(l){return this.decodeMultiAsync(l,!1)}async*decodeMultiAsync(l,h){let v=h,d=-1;for await(let R of l){if(h&&d===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(R),v&&(d=this.readArraySize(),v=!1,this.complete());try{for(;yield this.doDecodeSync(),--d!==0;);}catch(_){if(!(_ instanceof e.DataViewIndexOutOfBoundsError))throw _}this.totalPos+=this.pos}}doDecodeSync(){e:for(;;){let l=this.readHeadByte(),h;if(l>=224)h=l-256;else if(l<192)if(l<128)h=l;else if(l<144){let d=l-128;if(d!==0){this.pushMapState(d),this.complete();continue e}else h={}}else if(l<160){let d=l-144;if(d!==0){this.pushArrayState(d),this.complete();continue e}else h=[]}else{let d=l-160;h=this.decodeUtf8String(d,0)}else if(l===192)h=null;else if(l===194)h=!1;else if(l===195)h=!0;else if(l===202)h=this.readF32();else if(l===203)h=this.readF64();else if(l===204)h=this.readU8();else if(l===205)h=this.readU16();else if(l===206)h=this.readU32();else if(l===207)h=this.readU64();else if(l===208)h=this.readI8();else if(l===209)h=this.readI16();else if(l===210)h=this.readI32();else if(l===211)h=this.readI64();else if(l===217){let d=this.lookU8();h=this.decodeUtf8String(d,1)}else if(l===218){let d=this.lookU16();h=this.decodeUtf8String(d,2)}else if(l===219){let d=this.lookU32();h=this.decodeUtf8String(d,4)}else if(l===220){let d=this.readU16();if(d!==0){this.pushArrayState(d),this.complete();continue e}else h=[]}else if(l===221){let d=this.readU32();if(d!==0){this.pushArrayState(d),this.complete();continue e}else h=[]}else if(l===222){let d=this.readU16();if(d!==0){this.pushMapState(d),this.complete();continue e}else h={}}else if(l===223){let d=this.readU32();if(d!==0){this.pushMapState(d),this.complete();continue e}else h={}}else if(l===196){let d=this.lookU8();h=this.decodeBinary(d,1)}else if(l===197){let d=this.lookU16();h=this.decodeBinary(d,2)}else if(l===198){let d=this.lookU32();h=this.decodeBinary(d,4)}else if(l===212)h=this.decodeExtension(1,0);else if(l===213)h=this.decodeExtension(2,0);else if(l===214)h=this.decodeExtension(4,0);else if(l===215)h=this.decodeExtension(8,0);else if(l===216)h=this.decodeExtension(16,0);else if(l===199){let d=this.lookU8();h=this.decodeExtension(d,1)}else if(l===200){let d=this.lookU16();h=this.decodeExtension(d,2)}else if(l===201){let d=this.lookU32();h=this.decodeExtension(d,4)}else throw new o.DecodeError(`Unrecognized type byte: ${(0,t.prettyByte)(l)}`);this.complete();let v=this.stack;for(;v.length>0;){let d=v[v.length-1];if(d.type===0)if(d.array[d.position]=h,d.position++,d.position===d.size)v.pop(),h=d.array;else continue e;else if(d.type===1){if(!c(h))throw new o.DecodeError("The type of key must be string or number but "+typeof h);if(h==="__proto__")throw new o.DecodeError("The key __proto__ is not allowed");d.key=h,d.type=2;continue e}else if(d.map[d.key]=h,d.readCount++,d.readCount===d.size)v.pop(),h=d.map;else{d.key=null,d.type=1;continue e}}return h}}readHeadByte(){return this.headByte===u&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=u}readArraySize(){let l=this.readHeadByte();switch(l){case 220:return this.readU16();case 221:return this.readU32();default:{if(l<160)return l-144;throw new o.DecodeError(`Unrecognized array type byte: ${(0,t.prettyByte)(l)}`)}}}pushMapState(l){if(l>this.maxMapLength)throw new o.DecodeError(`Max length exceeded: map length (${l}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.push({type:1,size:l,key:null,readCount:0,map:{}})}pushArrayState(l){if(l>this.maxArrayLength)throw new o.DecodeError(`Max length exceeded: array length (${l}) > maxArrayLength (${this.maxArrayLength})`);this.stack.push({type:0,size:l,array:new Array(l),position:0})}decodeUtf8String(l,h){var v;if(l>this.maxStrLength)throw new o.DecodeError(`Max length exceeded: UTF-8 byte length (${l}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+h+l)throw g;let d=this.pos+h,R;return this.stateIsMapKey()&&!((v=this.keyDecoder)===null||v===void 0)&&v.canBeCached(l)?R=this.keyDecoder.decode(this.bytes,d,l):l>i.TEXT_DECODER_THRESHOLD?R=(0,i.utf8DecodeTD)(this.bytes,d,l):R=(0,i.utf8DecodeJs)(this.bytes,d,l),this.pos+=h+l,R}stateIsMapKey(){return this.stack.length>0?this.stack[this.stack.length-1].type===1:!1}decodeBinary(l,h){if(l>this.maxBinLength)throw new o.DecodeError(`Max length exceeded: bin length (${l}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(l+h))throw g;let v=this.pos+h,d=this.bytes.subarray(v,v+l);return this.pos+=h+l,d}decodeExtension(l,h){if(l>this.maxExtLength)throw new o.DecodeError(`Max length exceeded: ext length (${l}) > maxExtLength (${this.maxExtLength})`);let v=this.view.getInt8(this.pos+h),d=this.decodeBinary(l,h+1);return this.extensionCodec.decode(d,v,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let l=this.view.getUint8(this.pos);return this.pos++,l}readI8(){let l=this.view.getInt8(this.pos);return this.pos++,l}readU16(){let l=this.view.getUint16(this.pos);return this.pos+=2,l}readI16(){let l=this.view.getInt16(this.pos);return this.pos+=2,l}readU32(){let l=this.view.getUint32(this.pos);return this.pos+=4,l}readI32(){let l=this.view.getInt32(this.pos);return this.pos+=4,l}readU64(){let l=(0,n.getUint64)(this.view,this.pos);return this.pos+=8,l}readI64(){let l=(0,n.getInt64)(this.view,this.pos);return this.pos+=8,l}readF32(){let l=this.view.getFloat32(this.pos);return this.pos+=4,l}readF64(){let l=this.view.getFloat64(this.pos);return this.pos+=8,l}};e.Decoder=T}),Nr=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeMulti=e.decode=e.defaultDecodeOptions=void 0;var t=lr();e.defaultDecodeOptions={};function r(i,a=e.defaultDecodeOptions){return new t.Decoder(a.extensionCodec,a.context,a.maxStrLength,a.maxBinLength,a.maxArrayLength,a.maxMapLength,a.maxExtLength).decode(i)}e.decode=r;function n(i,a=e.defaultDecodeOptions){return new t.Decoder(a.extensionCodec,a.context,a.maxStrLength,a.maxBinLength,a.maxArrayLength,a.maxMapLength,a.maxExtLength).decodeMulti(i)}e.decodeMulti=n}),kn=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ensureAsyncIterable=e.asyncIterableFromStream=e.isAsyncIterable=void 0;function t(a){return a[Symbol.asyncIterator]!=null}e.isAsyncIterable=t;function r(a){if(a==null)throw new Error("Assertion Failure: value must not be null nor undefined")}async function*n(a){let s=a.getReader();try{for(;;){let{done:o,value:c}=await s.read();if(o)return;r(c),yield c}}finally{s.releaseLock()}}e.asyncIterableFromStream=n;function i(a){return t(a)?a:n(a)}e.ensureAsyncIterable=i}),On=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=void 0;var t=lr(),r=kn(),n=Nr();async function i(c,u=n.defaultDecodeOptions){let m=(0,r.ensureAsyncIterable)(c);return new t.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength).decodeAsync(m)}e.decodeAsync=i;function a(c,u=n.defaultDecodeOptions){let m=(0,r.ensureAsyncIterable)(c);return new t.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength).decodeArrayStream(m)}e.decodeArrayStream=a;function s(c,u=n.defaultDecodeOptions){let m=(0,r.ensureAsyncIterable)(c);return new t.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength).decodeStream(m)}e.decodeMultiStream=s;function o(c,u=n.defaultDecodeOptions){return s(c,u)}e.decodeStream=o}),ur=ne(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.decodeTimestampExtension=e.encodeTimestampExtension=e.decodeTimestampToTimeSpec=e.encodeTimeSpecToTimestamp=e.encodeDateToTimeSpec=e.EXT_TIMESTAMP=e.ExtData=e.ExtensionCodec=e.Encoder=e.DataViewIndexOutOfBoundsError=e.DecodeError=e.Decoder=e.decodeStream=e.decodeMultiStream=e.decodeArrayStream=e.decodeAsync=e.decodeMulti=e.decode=e.encode=void 0;var t=Dn();Object.defineProperty(e,"encode",{enumerable:!0,get:function(){return t.encode}});var r=Nr();Object.defineProperty(e,"decode",{enumerable:!0,get:function(){return r.decode}}),Object.defineProperty(e,"decodeMulti",{enumerable:!0,get:function(){return r.decodeMulti}});var n=On();Object.defineProperty(e,"decodeAsync",{enumerable:!0,get:function(){return n.decodeAsync}}),Object.defineProperty(e,"decodeArrayStream",{enumerable:!0,get:function(){return n.decodeArrayStream}}),Object.defineProperty(e,"decodeMultiStream",{enumerable:!0,get:function(){return n.decodeMultiStream}}),Object.defineProperty(e,"decodeStream",{enumerable:!0,get:function(){return n.decodeStream}});var i=lr();Object.defineProperty(e,"Decoder",{enumerable:!0,get:function(){return i.Decoder}}),Object.defineProperty(e,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return i.DataViewIndexOutOfBoundsError}});var a=ar();Object.defineProperty(e,"DecodeError",{enumerable:!0,get:function(){return a.DecodeError}});var s=Lr();Object.defineProperty(e,"Encoder",{enumerable:!0,get:function(){return s.Encoder}});var o=or();Object.defineProperty(e,"ExtensionCodec",{enumerable:!0,get:function(){return o.ExtensionCodec}});var c=Br();Object.defineProperty(e,"ExtData",{enumerable:!0,get:function(){return c.ExtData}});var u=Cr();Object.defineProperty(e,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return u.EXT_TIMESTAMP}}),Object.defineProperty(e,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return u.encodeDateToTimeSpec}}),Object.defineProperty(e,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return u.encodeTimeSpecToTimestamp}}),Object.defineProperty(e,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return u.decodeTimestampToTimeSpec}}),Object.defineProperty(e,"encodeTimestampExtension",{enumerable:!0,get:function(){return u.encodeTimestampExtension}}),Object.defineProperty(e,"decodeTimestampExtension",{enumerable:!0,get:function(){return u.decodeTimestampExtension}})}),et=class extends Error{constructor(e){super(e),this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}},We=class extends et{},ve=class extends et{},$t=class extends et{},Te=typeof process<"u"&&process.release&&process.release.name==="node";if(!globalThis.document){if(!globalThis.importScripts){if(!Te)throw new et("Cannot determine runtime environment")}}var p={};function Pn(e){Object.keys(e).forEach(t=>p._free(e[t]))}var Ee={null:0,symbol:1,pairlist:2,closure:3,environment:4,promise:5,call:6,special:7,builtin:8,string:9,logical:10,integer:13,double:14,complex:15,character:16,dots:17,any:18,list:19,expression:20,bytecode:21,pointer:22,weakref:23,raw:24,s4:25,new:30,free:31,function:99};function Wr(e){return!!e&&typeof e=="object"&&Object.keys(Ee).includes(e.type)}function jt(e){return!!e&&typeof e=="object"&&"re"in e&&"im"in e}function mt(e){return p._Rf_protect(Ae(e)),e}function H(e,t){return p._Rf_protect(Ae(e)),++t.n,e}function In(e){let t=p._malloc(4);return p._R_ProtectWithIndex(Ae(e),t),{loc:p.getValue(t,"i32"),ptr:t}}function Bn(e){p._Rf_unprotect(1),p._free(e.ptr)}function Cn(e,t){return p._R_Reprotect(Ae(e),t.loc),e}function J(e){p._Rf_unprotect(e)}function vr(e,t,r){p._Rf_defineVar(Ae(t),Ae(r),Ae(e))}function Er(e,t){let r={},n={n:0};try{let i=new zr(t);H(i,n),r.code=p.allocateUTF8(e);let a=p._R_ParseEvalString(r.code,i.ptr);return k.wrap(a)}finally{Pn(r),J(n.n)}}function kt(e,t){return p.getWasmTableEntry(p.GOT.ffi_safe_eval.value)(Ae(e),Ae(t))}var Mn=new WeakMap;function Ln(e,t){return Mn.set(e,t),e}var Nn=63;function Fr(){let e=Array.from({length:4},Wn).join("-");if(e.length!==Nn)throw new Error("comlink internal error: UUID has the wrong length");return e}function Wn(){let e=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16),t=15-e.length;return t>0&&(e=Array.from({length:t},()=>0).join("")+e),e}function Ae(e){return St(e)?e.ptr:e}function qe(e,t){if(p._TYPEOF(e.ptr)!==Ee[t])throw new Error(`Unexpected object type "${e.type()}" when expecting type "${t}"`)}function Vr(e){if(Wr(e))return new(Zr(e.type))(e);if(e&&typeof e=="object"&&"type"in e&&e.type==="null")return new qr;if(e===null)return new Ze({type:"logical",names:null,values:[null]});if(typeof e=="boolean")return new Ze(e);if(typeof e=="number")return new Pt(e);if(typeof e=="string")return new Ue(e);if(jt(e))return new hr(e);if(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)return new dr(e);if(Array.isArray(e))return Fn(e);if(typeof e=="object")return ct.fromObject(e);throw new Error("Robj construction for this JS object is not yet supported")}function Fn(e){let t={n:0};if(e.every(r=>r&&typeof r=="object"&&!St(r)&&!jt(r))){let r=e,n=r.every(a=>Object.keys(a).filter(s=>!Object.keys(r[0]).includes(s)).length===0&&Object.keys(r[0]).filter(s=>!Object.keys(a).includes(s)).length===0),i=r.every(a=>Object.values(a).every(s=>tn(s)||en(s)));if(n&&i)return ct.fromD3(r)}if(e.every(r=>typeof r=="boolean"||r===null))return new Ze(e);if(e.every(r=>typeof r=="number"||r===null))return new Pt(e);if(e.every(r=>typeof r=="string"||r===null))return new Ue(e);try{let r=new Fe([new _e("c"),...e]);return H(r,t),r.eval()}finally{J(t.n)}}var G=class{constructor(e){this.ptr=e}type(){let e=p._TYPEOF(this.ptr);return Object.keys(Ee).find(t=>Ee[t]===e)}},st,yt,Qe=class extends G{constructor(e){if(!(e instanceof G))return Vr(e);super(e.ptr),D(this,st)}static wrap(e){let t=p._TYPEOF(e),r=Object.keys(Ee)[Object.values(Ee).indexOf(t)];return new(Zr(r))(new G(e))}get[Symbol.toStringTag](){return`RObject:${this.type()}`}static getPersistentObject(e){return re[e]}getPropertyValue(e){return this[e]}inspect(){Er(".Internal(inspect(x))",{x:this})}isNull(){return p._TYPEOF(this.ptr)===Ee.null}isNa(){try{let e=Er("is.na(x)",{x:this});return mt(e),e.toBoolean()}finally{J(1)}}isUnbound(){return this.ptr===re.unboundValue.ptr}attrs(){return Ot.wrap(p._ATTRIB(this.ptr))}class(){let e={n:0},t=new Fe([new _e("class"),this]);H(t,e);try{return t.eval()}finally{J(e.n)}}setNames(e){let t;if(e===null)t=re.null;else if(Array.isArray(e)&&e.every(r=>typeof r=="string"||r===null))t=new Ue(e);else throw new Error("Argument to setNames must be null or an Array of strings or null");return p._Rf_setAttrib(this.ptr,re.namesSymbol.ptr,t.ptr),this}names(){let e=Ue.wrap(p._Rf_getAttrib(this.ptr,re.namesSymbol.ptr));return e.isNull()?null:e.toArray()}includes(e){let t=this.names();return t&&t.includes(e)}toJs(e={depth:0},t=1){throw new Error("This R object cannot be converted to JS")}subset(e){return me(this,st,yt).call(this,e,re.bracketSymbol.ptr)}get(e){return me(this,st,yt).call(this,e,re.bracket2Symbol.ptr)}getDollar(e){return me(this,st,yt).call(this,e,re.dollarSymbol.ptr)}pluck(...e){let t=In(re.null);try{let r=(i,a)=>{let s=i.get(a);return Cn(s,t)},n=e.reduce(r,this);return n.isNull()?void 0:n}finally{Bn(t)}}set(e,t){let r={n:0};try{let n=new Qe(e);H(n,r);let i=new Qe(t);H(i,r);let a=new _e("[[<-"),s=p._Rf_lang4(a.ptr,this.ptr,n.ptr,i.ptr);return H(s,r),Qe.wrap(kt(s,re.baseEnv))}finally{J(r.n)}}static getMethods(e){let t=new Set,r=e;do Object.getOwnPropertyNames(r).map(n=>t.add(n));while(r=Object.getPrototypeOf(r));return[...t.keys()].filter(n=>typeof e[n]=="function")}},k=Qe;st=new WeakSet,yt=function(e,t){let r={n:0};try{let n=new Qe(e);H(n,r);let i=p._Rf_lang3(t,this.ptr,n.ptr);return H(i,r),Qe.wrap(kt(i,re.baseEnv))}finally{J(r.n)}};var qr=class extends k{constructor(){return super(new G(p.getValue(p._R_NilValue,"*"))),this}toJs(){return{type:"null"}}},_e=class extends k{constructor(e){if(e instanceof G){qe(e,"symbol"),super(e);return}let t=p.allocateUTF8(e);try{super(new G(p._Rf_install(t)))}finally{p._free(t)}}toJs(){let e=this.toObject();return{type:"symbol",printname:e.printname,symvalue:e.symvalue,internal:e.internal}}toObject(){return{printname:this.printname().isUnbound()?null:this.printname().toString(),symvalue:this.symvalue().isUnbound()?null:this.symvalue().ptr,internal:this.internal().isNull()?null:this.internal().ptr}}toString(){return this.printname().toString()}printname(){return cr.wrap(p._PRINTNAME(this.ptr))}symvalue(){return k.wrap(p._SYMVALUE(this.ptr))}internal(){return k.wrap(p._INTERNAL(this.ptr))}},Ot=class extends k{constructor(e){if(e instanceof G)return qe(e,"pairlist"),super(e),this;let t={n:0};try{let{names:r,values:n}=rt(e),i=Ot.wrap(p._Rf_allocList(n.length));H(i,t);for(let[a,s]=[0,i];!s.isNull();[a,s]=[a+1,s.cdr()])s.setcar(new k(n[a]));i.setNames(r),super(i)}finally{J(t.n)}}get length(){return this.toArray().length}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=-1}={}){let n=this.entries({depth:r}),i=n.map(([a])=>a);if(!e&&new Set(i).size!==i.length)throw new Error("Duplicate key when converting pairlist without allowDuplicateKey enabled");if(!t&&i.some(a=>!a))throw new Error("Empty or null key when converting pairlist without allowEmptyKey enabled");return Object.fromEntries(n.filter((a,s)=>n.findIndex(o=>o[0]===a[0])===s))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((r,n)=>[t.names?t.names[n]:null,r])}toJs(e={depth:0},t=1){let r=[],n=!1,i=[];for(let a=this;!a.isNull();a=a.cdr()){let s=a.tag();s.isNull()?r.push(""):(n=!0,r.push(s.toString())),e.depth&&t>=e.depth?i.push(a.car()):i.push(a.car().toJs(e,t+1))}return{type:"pairlist",names:n?r:null,values:i}}includes(e){return e in this.toObject()}setcar(e){p._SETCAR(this.ptr,e.ptr)}car(){return k.wrap(p._CAR(this.ptr))}cdr(){return k.wrap(p._CDR(this.ptr))}tag(){return k.wrap(p._TAG(this.ptr))}},Fe=class extends k{constructor(e){if(e instanceof G)return qe(e,"call"),super(e),this;let t={n:0};try{let{values:r}=rt(e),n=r.map(a=>H(new k(a),t)),i=Fe.wrap(p._Rf_allocVector(Ee.call,r.length));H(i,t);for(let[a,s]=[0,i];!s.isNull();[a,s]=[a+1,s.cdr()])s.setcar(n[a]);super(i)}finally{J(t.n)}}setcar(e){p._SETCAR(this.ptr,e.ptr)}car(){return k.wrap(p._CAR(this.ptr))}cdr(){return k.wrap(p._CDR(this.ptr))}eval(){return p.webr.evalR(this,{env:re.baseEnv})}capture(e={}){return p.webr.captureR(this,e)}deparse(){let e={n:0};try{let t=p._Rf_lang2(new _e("deparse1").ptr,p._Rf_lang2(new _e("quote").ptr,this.ptr));H(t,e);let r=Ue.wrap(kt(t,re.baseEnv));return H(r,e),r.toString()}finally{J(e.n)}}},Wt=class extends k{constructor(e,t=null){if(e instanceof G){if(qe(e,"list"),super(e),t){if(t.length!==this.length)throw new Error("Can't construct named `RList`. Supplied `names` must be the same length as the list.");this.setNames(t)}return this}let r={n:0};try{let n=rt(e),i=p._Rf_allocVector(Ee.list,n.values.length);H(i,r),n.values.forEach((s,o)=>{p._SET_VECTOR_ELT(i,o,new k(s).ptr)});let a=t||n.names;if(a&&a.length!==n.values.length)throw new Error("Can't construct named `RList`. Supplied `names` must be the same length as the list.");k.wrap(i).setNames(a),super(new G(i))}finally{J(r.n)}}get length(){return p._LENGTH(this.ptr)}isDataFrame(){let e=Ot.wrap(p._ATTRIB(this.ptr)).get("class");return!e.isNull()&&e.toArray().includes("data.frame")}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=-1}={}){let n=this.entries({depth:r}),i=n.map(([a])=>a);if(!e&&new Set(i).size!==i.length)throw new Error("Duplicate key when converting list without allowDuplicateKey enabled");if(!t&&i.some(a=>!a))throw new Error("Empty or null key when converting list without allowEmptyKey enabled");return Object.fromEntries(n.filter((a,s)=>n.findIndex(o=>o[0]===a[0])===s))}toD3(){if(!this.isDataFrame())throw new Error("Can't convert R list object to D3 format. Object must be of class 'data.frame'.");return this.entries().reduce((e,t)=>(t[1].forEach((r,n)=>e[n]=Object.assign(e[n]||{},{[t[0]]:r})),e),[])}entries(e={depth:-1}){let t=this.toJs(e);return this.isDataFrame()&&e.depth<0&&(t.values=t.values.map(r=>r.toArray())),t.values.map((r,n)=>[t.names?t.names[n]:null,r])}toJs(e={depth:0},t=1){return{type:"list",names:this.names(),values:[...Array(this.length).keys()].map(r=>e.depth&&t>=e.depth?this.get(r+1):this.get(r+1).toJs(e,t+1))}}},ct=class extends Wt{constructor(e){if(e instanceof G){if(super(e),!this.isDataFrame())throw new Error("Can't construct `RDataFrame`. Supplied R object is not a `data.frame`.");return this}return ct.fromObject(e)}static fromObject(e){let{names:t,values:r}=rt(e),n={n:0};try{let i=!!t&&t.length>0&&t.every(s=>s),a=r.length>0&&r.every(s=>Array.isArray(s)||ArrayBuffer.isView(s)||s instanceof ArrayBuffer);if(i&&a){let s=r,o=s.every(u=>u.length===s[0].length),c=s.every(u=>tn(u[0])||en(u[0]));if(o&&c){let u=new Wt({type:"list",names:t,values:s.map(y=>Vr(y))});H(u,n);let m=new Fe([new _e("as.data.frame"),u]);return H(m,n),new ct(m.eval())}}}finally{J(n.n)}throw new Error("Can't construct `data.frame`. Source object is not eligible.")}static fromD3(e){return this.fromObject(Object.fromEntries(Object.keys(e[0]).map(t=>[t,e.map(r=>r[t])])))}},ft=class extends k{exec(...e){let t={n:0};try{let r=new Fe([this,...e]);return H(r,t),r.eval()}finally{J(t.n)}}capture(e={},...t){let r={n:0};try{let n=new Fe([this,...t]);return H(n,r),n.capture(e)}finally{J(r.n)}}},cr=class extends k{constructor(e){if(e instanceof G){qe(e,"string"),super(e);return}let t=p.allocateUTF8(e);try{super(new G(p._Rf_mkChar(t)))}finally{p._free(t)}}toString(){return p.UTF8ToString(p._R_CHAR(this.ptr))}toJs(){return{type:"string",value:this.toString()}}},zr=class extends k{constructor(e={}){if(e instanceof G)return qe(e,"environment"),super(e),this;let t=0;try{let{names:r,values:n}=rt(e),i=mt(p._R_NewEnv(re.globalEnv.ptr,0,0));++t,n.forEach((a,s)=>{let o=r?r[s]:null;if(!o)throw new Error("Can't create object in new environment with empty symbol name");let c=new _e(o),u=mt(new k(a));try{vr(i,c,u)}finally{J(1)}}),super(new G(i))}finally{J(t)}}ls(e=!1,t=!0){return Ue.wrap(p._R_lsInternal3(this.ptr,Number(e),Number(t))).toArray()}bind(e,t){let r=new _e(e),n=mt(new k(t));try{vr(this,r,n)}finally{J(1)}}names(){return this.ls(!0,!0)}frame(){return k.wrap(p._FRAME(this.ptr))}subset(e){if(typeof e=="number")throw new Error("Object of type environment is not subsettable");return this.getDollar(e)}toObject({depth:e=-1}={}){let t=this.names();return Object.fromEntries([...Array(t.length).keys()].map(r=>{let n=this.getDollar(t[r]);return[t[r],e<0?n:n.toJs({depth:e})]}))}toJs(e={depth:0},t=1){let r=this.names(),n=[...Array(r.length).keys()].map(i=>e.depth&&t>=e.depth?this.getDollar(r[i]):this.getDollar(r[i]).toJs(e,t+1));return{type:"environment",names:r,values:n}}},tt=class extends k{constructor(e,t,r){if(e instanceof G)return qe(e,t),super(e),this;let n={n:0};try{let{names:i,values:a}=rt(e),s=p._Rf_allocVector(Ee[t],a.length);H(s,n),a.forEach(r(s)),k.wrap(s).setNames(i),super(new G(s))}finally{J(n.n)}}get length(){return p._LENGTH(this.ptr)}get(e){return super.get(e)}subset(e){return super.subset(e)}getDollar(){throw new Error("$ operator is invalid for atomic vectors")}detectMissing(){let e={n:0};try{let t=p._Rf_lang2(new _e("is.na").ptr,this.ptr);H(t,e);let r=Ze.wrap(kt(t,re.baseEnv));H(r,e);let n=r.toTypedArray();return Array.from(n).map(i=>!!i)}finally{J(e.n)}}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:e[r])}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1}={}){let r=this.entries(),n=r.map(([i])=>i);if(!e&&new Set(n).size!==n.length)throw new Error("Duplicate key when converting atomic vector without allowDuplicateKey enabled");if(!t&&n.some(i=>!i))throw new Error("Empty or null key when converting atomic vector without allowEmptyKey enabled");return Object.fromEntries(r.filter((i,a)=>r.findIndex(s=>s[0]===i[0])===a))}entries(){let e=this.toArray(),t=this.names();return e.map((r,n)=>[t?t[n]:null,r])}toJs(){return{type:this.type(),names:this.names(),values:this.toArray()}}},Ft,Xr=class extends tt{constructor(e){super(e,"logical",f(Xr,Ft))}getBoolean(e){return this.get(e).toArray()[0]}toBoolean(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getBoolean(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS boolean");return e}toTypedArray(){return new Int32Array(p.HEAP32.subarray(p._LOGICAL(this.ptr)/4,p._LOGICAL(this.ptr)/4+this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:!!e[r])}},Ze=Xr;Ft=new WeakMap,D(Ze,Ft,e=>{let t=p._LOGICAL(e),r=p.getValue(p._R_NaInt,"i32");return(n,i)=>{p.setValue(t+4*i,n===null?r:!!n,"i32")}});var Vt,Hr=class extends tt{constructor(e){super(e,"integer",f(Hr,Vt))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Int32Array(p.HEAP32.subarray(p._INTEGER(this.ptr)/4,p._INTEGER(this.ptr)/4+this.length))}},Jr=Hr;Vt=new WeakMap,D(Jr,Vt,e=>{let t=p._INTEGER(e),r=p.getValue(p._R_NaInt,"i32");return(n,i)=>{p.setValue(t+4*i,n===null?r:Math.round(Number(n)),"i32")}});var qt,Gr=class extends tt{constructor(e){super(e,"double",f(Gr,qt))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Float64Array(p.HEAPF64.subarray(p._REAL(this.ptr)/8,p._REAL(this.ptr)/8+this.length))}},Pt=Gr;qt=new WeakMap,D(Pt,qt,e=>{let t=p._REAL(e),r=p.getValue(p._R_NaReal,"double");return(n,i)=>{p.setValue(t+8*i,n===null?r:n,"double")}});var zt,Kr=class extends tt{constructor(e){super(e,"complex",f(Kr,zt))}getComplex(e){return this.get(e).toArray()[0]}toComplex(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getComplex(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS object");return e}toTypedArray(){return new Float64Array(p.HEAPF64.subarray(p._COMPLEX(this.ptr)/8,p._COMPLEX(this.ptr)/8+2*this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:{re:e[2*r],im:e[2*r+1]})}},hr=Kr;zt=new WeakMap,D(hr,zt,e=>{let t=p._COMPLEX(e),r=p.getValue(p._R_NaReal,"double");return(n,i)=>{p.setValue(t+8*(2*i),n===null?r:n.re,"double"),p.setValue(t+8*(2*i+1),n===null?r:n.im,"double")}});var Xt,Qr=class extends tt{constructor(e){super(e,"character",f(Qr,Xt))}getString(e){return this.get(e).toArray()[0]}toString(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getString(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS string");return e}toTypedArray(){return new Uint32Array(p.HEAPU32.subarray(p._STRING_PTR(this.ptr)/4,p._STRING_PTR(this.ptr)/4+this.length))}toArray(){return this.detectMissing().map((e,t)=>e?null:p.UTF8ToString(p._R_CHAR(p._STRING_ELT(this.ptr,t))))}},Ue=Qr;Xt=new WeakMap,D(Ue,Xt,e=>(t,r)=>{t===null?p._SET_STRING_ELT(e,r,re.naString.ptr):p._SET_STRING_ELT(e,r,new cr(t).ptr)});var Ht,Yr=class extends tt{constructor(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e)),super(e,"raw",f(Yr,Ht))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Uint8Array(p.HEAPU8.subarray(p._RAW(this.ptr),p._RAW(this.ptr)+this.length))}},dr=Yr;Ht=new WeakMap,D(dr,Ht,e=>{let t=p._RAW(e);return(r,n)=>{p.setValue(t+n,Number(r),"i8")}});function rt(e){return Wr(e)?e:Array.isArray(e)||ArrayBuffer.isView(e)?{names:null,values:e}:e&&typeof e=="object"&&!jt(e)?{names:Object.keys(e),values:Object.values(e)}:{names:null,values:[e]}}function Zr(e){let t={object:k,null:qr,symbol:_e,pairlist:Ot,closure:ft,environment:zr,call:Fe,special:ft,builtin:ft,string:cr,logical:Ze,integer:Jr,double:Pt,complex:hr,character:Ue,list:Wt,raw:dr,function:ft,dataframe:ct};return e in t?t[e]:k}function St(e){return e instanceof k}function en(e){let t=["logical","integer","double","complex","character"];return St(e)&&t.includes(e.type())||St(e)&&e.isNa()}function tn(e){return e===null||typeof e=="number"||typeof e=="boolean"||typeof e=="string"||jt(e)}var re;function It(){let e={resolve:()=>{},reject:()=>{},promise:Promise.resolve()},t=new Promise((r,n)=>{e.resolve=r,e.reject=n});return e.promise=t,e}function Vn(e){return new Promise(t=>setTimeout(t,e))}function je(e,t,r,...n){return e==null||qn(e)?e:e instanceof ArrayBuffer?new Uint8Array(e):t(e)?r(e,...n):Array.isArray(e)||ArrayBuffer.isView(e)?e.map(i=>je(i,t,r,...n)):e instanceof G?e:typeof e=="object"?Object.fromEntries(Object.entries(e).map(([i,a])=>[i,je(a,t,r,...n)])):e}function fr(e,t){let r=new XMLHttpRequest;r.open("get",e,!0),r.onload=()=>{let n=new Worker(URL.createObjectURL(new Blob([r.responseText])));t(n)},r.send()}function pr(e){if(Te)return!1;let t=new URL(location.href),r=new URL(e,location.origin);return!(t.host===r.host&&t.port===r.port&&t.protocol===r.protocol)}function qn(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}var zn=nr(ur()),Xn=new TextEncoder;async function Hn(e,t,r){try{let{taskId:n,sizeBuffer:i,dataBuffer:a,signalBuffer:s}=t,o=(0,zn.encode)(r),c=o.length<=a.length;if(Atomics.store(i,0,o.length),Atomics.store(i,1,+c),!c){let[u,m]=Jn(e);a.set(Xn.encode(u)),await _r(s,n),a=(await m).dataBuffer}a.set(o),Atomics.store(i,1,1),await _r(s,n)}catch(n){console.warn(n)}}function Jn(e){let t=Fr();return[t,new Promise(r=>{Te?e.once("message",n=>{!n.id||n.id!==t||r(n)}):e.addEventListener("message",function n(i){!i.data||!i.data.id||i.data.id!==t||(e.removeEventListener("message",n),r(i.data))}),e.start&&e.start()})]}async function _r(e,t){let r=(t>>1)%32,n=1;for(;Atomics.compareExchange(e,r+1,0,t)!==0;)await Vn(n),n<32&&(n*=2);Atomics.or(e,0,1<<r),Atomics.notify(e,0)}var $e,Se,wt,Jt,Nt=class{constructor(){D(this,wt),D(this,$e,void 0),D(this,Se,void 0),ie(this,Se,[]),ie(this,$e,[])}reset(){ie(this,Se,[]),ie(this,$e,[])}put(e){f(this,Se).length||me(this,wt,Jt).call(this),f(this,Se).shift()(e)}async get(){return f(this,$e).length||me(this,wt,Jt).call(this),f(this,$e).shift()}isEmpty(){return!f(this,$e).length}isBlocked(){return!!f(this,Se).length}get length(){return f(this,$e).length-f(this,Se).length}};$e=new WeakMap,Se=new WeakMap,wt=new WeakSet,Jt=function(){f(this,$e).push(new Promise(e=>{f(this,Se).push(e)}))};function Gn(e,t){return rn({type:"request",data:{uuid:Fr(),msg:e}},t)}function Gt(e,t,r){return rn({type:"response",data:{uuid:e,resp:t}},r)}function rn(e,t){return t&&Ln(e,t),e}function Kn(e){let t=new We(e.obj.message);return e.obj.name!=="Error"&&(t.name=e.obj.name),t.stack=e.obj.stack,t}function Qn(e){return!!e&&typeof e=="object"&&"payloadType"in e&&"obj"in e}function nn(e){return Qn(e)&&e.payloadType==="ptr"}var it,gt,mr=class{constructor(){this.inputQueue=new Nt,this.outputQueue=new Nt,this.systemQueue=new Nt,D(this,it,new Map),D(this,gt,!1)}async read(){return await this.outputQueue.get()}async flush(){let e=[];for(;!this.outputQueue.isEmpty();)e.push(await this.read());return e}async readSystem(){return await this.systemQueue.get()}write(e){if(f(this,gt))throw new ve("The webR communication channel has been closed.");this.inputQueue.put(e)}async request(e,t){let r=Gn(e,t),{resolve:n,reject:i,promise:a}=It();return f(this,it).set(r.data.uuid,{resolve:n,reject:i}),this.write(r),a}putClosedMessage(){ie(this,gt,!0),this.outputQueue.put({type:"closed"})}resolveResponse(e){let t=e.data.uuid,r=f(this,it).get(t);if(r){let n=e.data.resp;f(this,it).delete(t),n.payloadType==="err"?r.reject(Kn(n)):r.resolve(n)}else console.warn("Can't find request.")}};it=new WeakMap,gt=new WeakMap;nr(ur());new TextDecoder("utf-8");Te&&(globalThis.Worker=rr("worker_threads").Worker);var at,Kt,sn,bt,Tr=class extends mr{constructor(e){super(),D(this,Kt),D(this,at,void 0),this.close=()=>{},D(this,bt,async(r,n)=>{if(!(!n||!n.type))switch(n.type){case"resolve":ie(this,at,new Int32Array(n.data)),this.resolve();return;case"response":this.resolveResponse(n);return;case"system":this.systemQueue.put(n.data);return;default:this.outputQueue.put(n);return;case"sync-request":{let i=n,a=i.data.msg,s=i.data.reqData;switch(a.type){case"read":{let o=await this.inputQueue.get();await Hn(r,s,o);break}default:throw new ve(`Unsupported request type '${a.type}'.`)}return}case"request":throw new ve("Can't send messages of type 'request' from a worker. Please Use 'sync-request' instead.")}}),{resolve:this.resolve,reject:this.reject,promise:this.initialised}=It();let t=r=>{me(this,Kt,sn).call(this,r),this.close=()=>{r.terminate(),this.putClosedMessage()};let n={type:"init",data:{config:e,channelType:De.SharedArrayBuffer}};r.postMessage(n)};if(pr(e.baseUrl))fr(`${e.baseUrl}webr-worker.js`,r=>t(r));else{let r=new Worker(`${e.baseUrl}webr-worker.js`);t(r)}}interrupt(){if(!f(this,at))throw new ve("Failed attempt to interrupt before initialising interruptBuffer");this.inputQueue.reset(),f(this,at)[0]=1}};at=new WeakMap,Kt=new WeakSet,sn=function(e){Te?(e.on("message",t=>{f(this,bt).call(this,e,t)}),e.on("error",t=>{console.error(t),this.reject(new We("An error occurred initialising the webR SharedBufferChannel worker."))})):(e.onmessage=t=>f(this,bt).call(this,e,t.data),e.onerror=t=>{console.error(t),this.reject(new We("An error occurred initialising the webR SharedBufferChannel worker."))})},bt=new WeakMap;nr(ur());Te&&(globalThis.Worker=rr("worker_threads").Worker);var lt,Ye,ut,Qt,an,Yt,Rr,Zt,on,vt,Yn=class extends mr{constructor(e){super(),D(this,Qt),D(this,Yt),D(this,Zt),this.close=()=>{},D(this,lt,new Map),D(this,Ye,void 0),D(this,ut,!1),D(this,vt,(r,n)=>{if(!(!n||!n.type))switch(n.type){case"resolve":this.resolve();return;case"response":this.resolveResponse(n);return;case"system":this.systemQueue.put(n.data);return;default:this.outputQueue.put(n);return;case"sync-request":{let i=n.data;f(this,lt).set(i.data.uuid,i.data.msg);return}case"request":throw new ve("Can't send messages of type 'request' from a worker.Use service worker fetch request instead.")}}),{resolve:this.resolve,reject:this.reject,promise:this.initialised}=It(),console.warn("The ServiceWorker communication channel is deprecated and will be removed in a future version of webR. Consider using the PostMessage channel instead. If blocking input is required (for example, `browser()`) the SharedArrayBuffer channel should be used. See https://docs.r-wasm.org/webr/latest/serving.html for further information.");let t=r=>{me(this,Zt,on).call(this,r),this.close=()=>{r.terminate(),this.putClosedMessage()},me(this,Qt,an).call(this,`${e.serviceWorkerUrl}webr-serviceworker.js`).then(n=>{let i={type:"init",data:{config:e,channelType:De.ServiceWorker,clientId:n,location:window.location.href}};r.postMessage(i)})};if(pr(e.serviceWorkerUrl))fr(`${e.serviceWorkerUrl}webr-worker.js`,r=>t(r));else{let r=new Worker(`${e.serviceWorkerUrl}webr-worker.js`);t(r)}}activeRegistration(){var e;if(!((e=f(this,Ye))!=null&&e.active))throw new ve("Attempted to obtain a non-existent active registration.");return f(this,Ye).active}interrupt(){ie(this,ut,!0)}};lt=new WeakMap,Ye=new WeakMap,ut=new WeakMap,Qt=new WeakSet,an=async function(e){ie(this,Ye,await navigator.serviceWorker.register(e)),await navigator.serviceWorker.ready,window.addEventListener("beforeunload",()=>{var r;(r=f(this,Ye))==null||r.unregister()});let t=await new Promise(r=>{navigator.serviceWorker.addEventListener("message",function n(i){i.data.type==="registration-successful"&&(navigator.serviceWorker.removeEventListener("message",n),r(i.data.clientId))}),this.activeRegistration().postMessage({type:"register-client-main"})});return navigator.serviceWorker.addEventListener("message",r=>{me(this,Yt,Rr).call(this,r)}),t},Yt=new WeakSet,Rr=async function(e){if(e.data.type==="request"){let t=e.data.data,r=f(this,lt).get(t);if(!r)throw new ve("Request not found during service worker XHR request");switch(f(this,lt).delete(t),r.type){case"read":{let n=await this.inputQueue.get();this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Gt(t,n)});break}case"interrupt":{let n=f(this,ut);this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Gt(t,n)}),this.inputQueue.reset(),ie(this,ut,!1);break}default:throw new ve(`Unsupported request type '${r.type}'.`)}return}},Zt=new WeakSet,on=function(e){Te?(e.on("message",t=>{f(this,vt).call(this,e,t)}),e.on("error",t=>{console.error(t),this.reject(new We("An error occurred initialising the webR ServiceWorkerChannel worker."))})):(e.onmessage=t=>f(this,vt).call(this,e,t.data),e.onerror=t=>{console.error(t),this.reject(new We("An error occurred initialising the webR ServiceWorkerChannel worker."))})},vt=new WeakMap;Te&&(globalThis.Worker=rr("worker_threads").Worker);var ot,er,ln,Et,$r=class extends mr{constructor(e){super(),D(this,er),this.close=()=>{},D(this,ot,void 0),D(this,Et,async(r,n)=>{if(!(!n||!n.type))switch(n.type){case"resolve":this.resolve();return;case"response":this.resolveResponse(n);return;case"system":this.systemQueue.put(n.data);return;default:this.outputQueue.put(n);return;case"request":{let i=n,a=i.data.msg;switch(a.type){case"read":{let s=await this.inputQueue.get();if(f(this,ot)){let o=Gt(i.data.uuid,s);f(this,ot).postMessage(o)}break}default:throw new ve(`Unsupported request type '${a.type}'.`)}return}case"sync-request":throw new ve("Can't send messages of type 'sync-request' in PostMessage mode. Use 'request' instead.")}}),{resolve:this.resolve,reject:this.reject,promise:this.initialised}=It();let t=r=>{ie(this,ot,r),me(this,er,ln).call(this,r),this.close=()=>{r.terminate(),this.putClosedMessage()};let n={type:"init",data:{config:e,channelType:De.PostMessage}};r.postMessage(n)};if(pr(e.baseUrl))fr(`${e.baseUrl}webr-worker.js`,r=>t(r));else{let r=new Worker(`${e.baseUrl}webr-worker.js`);t(r)}}interrupt(){console.error("Interrupting R execution is not available when using the PostMessage channel")}};ot=new WeakMap,er=new WeakSet,ln=function(e){Te?(e.on("message",t=>{f(this,Et).call(this,e,t)}),e.on("error",t=>{console.error(t),this.reject(new We("An error occurred initialising the webR PostMessageChannel worker."))})):(e.onmessage=t=>f(this,Et).call(this,e,t.data),e.onerror=t=>{console.error(t),this.reject(new We("An error occurred initialising the webR PostMessageChannel worker."))})},Et=new WeakMap;var De={Automatic:0,SharedArrayBuffer:1,ServiceWorker:2,PostMessage:3};function Zn(e){switch(e.channelType){case De.SharedArrayBuffer:return new Tr(e);case De.ServiceWorker:return new Yn(e);case De.PostMessage:return new $r(e);case De.Automatic:default:return typeof SharedArrayBuffer<"u"?new Tr(e):new $r(e)}}var es=Te?__dirname+"/":"https://webr.r-wasm.org/v0.4.2/",ts="https://repo.r-wasm.org",un="0.4.2";function Ve(e){return!!e&&(typeof e=="object"||typeof e=="function")&&"payloadType"in e&&nn(e._payload)}function rs(e){var t;return!!(Ve(e)&&(t=e._payload.obj.methods)!=null&&t.includes("exec"))}function ns(){}function ss(e,t){return async function*(){let r={type:"callRObjectMethod",data:{payload:t._payload,prop:"getPropertyValue",args:[{payloadType:"raw",obj:"length"}],shelter:void 0}},n=await e.request(r);if(typeof n.obj!="number")throw new et("Cannot iterate over object, unexpected type for length property.");for(let i=1;i<=n.obj;i++)yield t.get(i)}}function cn(e,t,r){return async(...n)=>{let i=n.map(o=>Ve(o)?o._payload:{obj:je(o,Ve,c=>c._payload),payloadType:"raw"}),a={type:"callRObjectMethod",data:{payload:r,prop:t,args:i}},s=await e.request(a);switch(s.payloadType){case"ptr":return Ne(e,s);case"raw":return je(s,nn,(o,c)=>Ne(c,o),e).obj}}}async function is(e,t,r,...n){let i={type:"newRObject",data:{objType:t,args:je(n,Ve,s=>s._payload),shelter:r}},a=await e.request(i);switch(a.payloadType){case"raw":throw new $t("Unexpected raw payload type returned from newRObject");case"ptr":return Ne(e,a)}}function Ne(e,t){var r;let n=new Proxy((r=t.obj.methods)!=null&&r.includes("exec")?Object.assign(ns,{...t}):t,{get:(i,a)=>{var s;if(a==="_payload")return t;if(a===Symbol.asyncIterator)return ss(e,n);if((s=t.obj.methods)!=null&&s.includes(a.toString()))return cn(e,a.toString(),t)},apply:async(i,a,s)=>{let o=await Ne(e,t).exec(...s);return rs(o)?o:o.toJs()}});return n}function oe(e,t,r){return new Proxy(k,{construct:(n,i)=>is(e,r,t,...i),get:(n,i)=>cn(e,i.toString())})}var as={FONTCONFIG_PATH:"/etc/fonts",R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0",WEBR:"1",WEBR_VERSION:un},Sr={RArgs:[],REnv:as,baseUrl:es,serviceWorkerUrl:"",repoUrl:ts,homedir:"/home/web_user",interactive:!0,channelType:De.Automatic,createLazyFilesystem:!0},M,_t,tr,hn,os=class{constructor(e={}){D(this,tr),D(this,M,void 0),D(this,_t,void 0),this.version=un,this.FS={lookupPath:async r=>{let n={type:"lookupPath",data:{path:r}};return(await f(this,M).request(n)).obj},mkdir:async r=>{let n={type:"mkdir",data:{path:r}};return(await f(this,M).request(n)).obj},mount:async(r,n,i)=>{let a=[];"blobs"in n&&n.blobs&&(a=[...a,...n.blobs.map(o=>o.data instanceof Blob?o.data.arrayBuffer().then(c=>{o.data=new Uint8Array(c)}):Promise.resolve())]),"packages"in n&&n.packages&&(a=[...a,...n.packages.map(o=>o.blob instanceof Blob?o.blob.arrayBuffer().then(c=>{o.blob=new Uint8Array(c)}):Promise.resolve())]),await Promise.all(a);let s={type:"mount",data:{type:r,options:n,mountpoint:i}};await f(this,M).request(s)},syncfs:async r=>{let n={type:"syncfs",data:{populate:r}};await f(this,M).request(n)},readFile:async(r,n)=>{let i={type:"readFile",data:{path:r,flags:n}};return(await f(this,M).request(i)).obj},rmdir:async r=>{let n={type:"rmdir",data:{path:r}};await f(this,M).request(n)},writeFile:async(r,n,i)=>{let a={type:"writeFile",data:{path:r,data:n,flags:i}};await f(this,M).request(a)},unlink:async r=>{let n={type:"unlink",data:{path:r}};await f(this,M).request(n)},unmount:async r=>{let n={type:"unmount",data:{path:r}};await f(this,M).request(n)}};let t={...Sr,...e,REnv:{...Sr.REnv,...e.REnv}};ie(this,M,Zn(t)),this.objs={},this.Shelter=ls(f(this,M)),ie(this,_t,f(this,M).initialised.then(async()=>{this.globalShelter=await new this.Shelter,this.RObject=this.globalShelter.RObject,this.RLogical=this.globalShelter.RLogical,this.RInteger=this.globalShelter.RInteger,this.RDouble=this.globalShelter.RDouble,this.RComplex=this.globalShelter.RComplex,this.RCharacter=this.globalShelter.RCharacter,this.RRaw=this.globalShelter.RRaw,this.RList=this.globalShelter.RList,this.RDataFrame=this.globalShelter.RDataFrame,this.RPairlist=this.globalShelter.RPairlist,this.REnvironment=this.globalShelter.REnvironment,this.RSymbol=this.globalShelter.RSymbol,this.RString=this.globalShelter.RString,this.RCall=this.globalShelter.RCall,this.objs={baseEnv:await this.RObject.getPersistentObject("baseEnv"),globalEnv:await this.RObject.getPersistentObject("globalEnv"),null:await this.RObject.getPersistentObject("null"),true:await this.RObject.getPersistentObject("true"),false:await this.RObject.getPersistentObject("false"),na:await this.RObject.getPersistentObject("na")},me(this,tr,hn).call(this)}))}async init(){return f(this,_t)}close(){f(this,M).close()}async read(){return await f(this,M).read()}async flush(){return await f(this,M).flush()}write(e){f(this,M).write(e)}writeConsole(e){this.write({type:"stdin",data:e+`
`})}interrupt(){f(this,M).interrupt()}async installPackages(e,t){let r=Object.assign({quiet:!1,mount:!0},t),n={type:"installPackages",data:{name:e,options:r}};await f(this,M).request(n)}async destroy(e){await this.globalShelter.destroy(e)}async evalR(e,t){return this.globalShelter.evalR(e,t)}async evalRVoid(e,t){return this.evalRRaw(e,"void",t)}async evalRBoolean(e,t){return this.evalRRaw(e,"boolean",t)}async evalRNumber(e,t){return this.evalRRaw(e,"number",t)}async evalRString(e,t){return this.evalRRaw(e,"string",t)}async evalRRaw(e,t,r={}){let n=je(r,Ve,s=>s._payload),i={type:"evalRRaw",data:{code:e,options:n,outputType:t}},a=await f(this,M).request(i);switch(a.payloadType){case"raw":return a.obj;case"ptr":throw new $t("Unexpected ptr payload type returned from evalRVoid")}}async invokeWasmFunction(e,...t){let r={type:"invokeWasmFunction",data:{ptr:e,args:t}};return(await f(this,M).request(r)).obj}};M=new WeakMap,_t=new WeakMap,tr=new WeakSet,hn=async function(){for(;;){let e=await f(this,M).readSystem();switch(e.type){case"setTimeoutWasm":setTimeout((t,r)=>{this.invokeWasmFunction(t,...r)},e.data.delay,e.data.ptr,e.data.args);break;case"console.log":console.log(e.data);break;case"console.warn":console.warn(e.data);break;case"console.error":console.error(e.data);break;case"close":f(this,M).close();break;default:throw new et("Unknown system message type `"+e.type+"`")}}};var W,I,Tt,Ar=class{constructor(e){D(this,W,""),D(this,I,void 0),D(this,Tt,!1),ie(this,I,e)}async init(){if(f(this,Tt))return;let e={type:"newShelter"},t=await f(this,I).request(e);ie(this,W,t.obj),this.RObject=oe(f(this,I),f(this,W),"object"),this.RLogical=oe(f(this,I),f(this,W),"logical"),this.RInteger=oe(f(this,I),f(this,W),"integer"),this.RDouble=oe(f(this,I),f(this,W),"double"),this.RComplex=oe(f(this,I),f(this,W),"complex"),this.RCharacter=oe(f(this,I),f(this,W),"character"),this.RRaw=oe(f(this,I),f(this,W),"raw"),this.RList=oe(f(this,I),f(this,W),"list"),this.RDataFrame=oe(f(this,I),f(this,W),"dataframe"),this.RPairlist=oe(f(this,I),f(this,W),"pairlist"),this.REnvironment=oe(f(this,I),f(this,W),"environment"),this.RSymbol=oe(f(this,I),f(this,W),"symbol"),this.RString=oe(f(this,I),f(this,W),"string"),this.RCall=oe(f(this,I),f(this,W),"call"),ie(this,Tt,!0)}async purge(){let e={type:"shelterPurge",data:f(this,W)};await f(this,I).request(e)}async destroy(e){let t={type:"shelterDestroy",data:{id:f(this,W),obj:e._payload}};await f(this,I).request(t)}async size(){let e={type:"shelterSize",data:f(this,W)};return(await f(this,I).request(e)).obj}async evalR(e,t={}){let r=je(t,Ve,a=>a._payload),n={type:"evalR",data:{code:e,options:r,shelter:f(this,W)}},i=await f(this,I).request(n);switch(i.payloadType){case"raw":throw new $t("Unexpected payload type returned from evalR");default:return Ne(f(this,I),i)}}async captureR(e,t={}){let r=je(t,Ve,a=>a._payload),n={type:"captureR",data:{code:e,options:r,shelter:f(this,W)}},i=await f(this,I).request(n);switch(i.payloadType){case"ptr":throw new $t("Unexpected payload type returned from evalR");case"raw":{let a=i.obj,s=Ne(f(this,I),a.result),o=a.output,c=a.images;for(let u=0;u<o.length;++u)o[u].type!=="stdout"&&o[u].type!=="stderr"&&(o[u].data=Ne(f(this,I),o[u].data));return{result:s,output:o,images:c}}}}};W=new WeakMap,I=new WeakMap,Tt=new WeakMap;function ls(e){return new Proxy(Ar,{construct:async()=>{let t=new Ar(e);return await t.init(),t}})}async function us(e,t,r){const n=`${window.location.origin}./tools/webR`,i=new os({baseUrl:`${n}/webr-0.4.2/`});await i.init(),console.log("R is ready"),await i.evalR(`
        webr::mount(mountpoint = "/usr/lib/R/library/statmod", source = "${n}/packages/statmod_1.5.0.tgz");
        webr::mount(mountpoint = "/usr/lib/R/library/Rcpp", source = "${n}/packages/Rcpp_1.0.13.tgz");
        webr::mount(mountpoint = "/usr/lib/R/library/limma", source = "${n}/packages/limma_3.61.12.tgz");
        webr::mount(mountpoint = "/edgeR", source = "${n}/packages/edgeR/library.data");
        .libPaths(c(.libPaths(), "/edgeR"));
        library(edgeR);
        message("Running differential analysis with edgeR")
    `);const a=e.map(o=>o.map(c=>({...c}))),s=t.map(o=>o.map(c=>({...c})));for(let o=0;o<a.length;o++)await i.objs.globalEnv.bind("controlDataPart",a[o]),await i.evalR(`
        # check if controlData exists
        if (!exists("controlData")) {
          controlData <- list()
        }
        controlData[[${o+1}]] <- controlDataPart
        # clean up
        rm(controlDataPart)
      `);for(let o=0;o<s.length;o++)await i.objs.globalEnv.bind("conditionDataPart",s[o]),await i.evalR(`
        # check if conditionData exists
        if (!exists("conditionData")) {
          conditionData <- list()
        }
        conditionData[[${o+1}]] <- conditionDataPart
        # clean up
        rm(conditionDataPart)
      `);try{return await(await i.evalR(`
        # Function to process input data and perform differential expression analysis
        load_data <- function(control_list, condition_list) {
          # Merge control and condition data for filtering
          all_list <- c(control_list, condition_list)
          read_counts <- do.call(cbind, lapply(all_list, function(x) { x$readCount }))

          # Apply filtering for non-zero counts
          zeros <- apply(apply(read_counts, 1, ">", 0), 2, any)
          noness_list <- lapply(all_list, function(x) { x[zeros, ] })

          # Build count matrix and conditions factor
          count_mat <- do.call(cbind, lapply(noness_list, function(x) { x$readCount }))
          conds <- factor(c(rep("ctrl", length(control_list)), rep("cond", length(condition_list))))

          list(count_mat = count_mat, conds = conds, noness_list = noness_list)
        }
        
        perform_differential_expression <- function(count_mat, conds, noness_list) {
            # Perform edgeR differential expression analysis
            d <- DGEList(counts = count_mat, group = conds)
            d <- calcNormFactors(d)
            d <- estimateCommonDisp(d)
            d <- estimateTagwiseDisp(d)
            de.tgw <- exactTest(d, pair = c("ctrl", "cond"))

            # Prepare differential expression results
            ctrl1_noness <- noness_list[[1]]
            diff <- cbind(ctrl1_noness[, c("name", "start", "end", "strand")], de.tgw$table, QValue = p.adjust(de.tgw$table$PValue, "BH"))

            return(diff)
        }

        data <- load_data(controlData, conditionData)
        diff_results <- perform_differential_expression(data$count_mat, data$conds, data$noness_list)
        diff_results
      `)).toD3()}finally{i.close()}}async function cs(e,t,r=0){return(await us(e,t)).map((i,a)=>({id:a,name:i.name,start:i.start,end:i.end,strand:i.strand,logFC:i.logFC,logCPM:i.logCPM,pValue:i.PValue,qValue:i.QValue}))}function xr(e){let t,r,n;return r=new wn({props:{value:void 0,width:"w-14",strokeLinecap:"round"}}),{c(){t=L("div"),F(r.$$.fragment),this.h()},l(i){t=N(i,"DIV",{class:!0});var a=X(t);V(r.$$.fragment,a),a.forEach($),this.h()},h(){de(t,"class","flex items-center justify-center align-middle m-12")},m(i,a){ae(i,t,a),q(r,t,null),n=!0},p:pt,i(i){n||(O(r.$$.fragment,i),n=!0)},o(i){B(r.$$.fragment,i),n=!1},d(i){i&&$(t),z(r)}}}function hs(e){let t,r,n,i,a,s,o="This plot shows the comparison between the log2 fold-change (x-axis) and the -log10(Q-Value) for each gene. The logFC represents the log2 fold-change between control and condition read counts for each gene. The -log10(Q-Value) represents the negative log10 of the Q-Value, which is a measure of the significance of the difference in expression between control and condition samples.",c,u=e[0]&&xr();return{c(){t=L("div"),r=L("section"),n=L("div"),i=U(),u&&u.c(),a=U(),s=L("footer"),s.textContent=o,this.h()},l(m){t=N(m,"DIV",{class:!0});var y=X(t);r=N(y,"SECTION",{class:!0});var g=X(r);n=N(g,"DIV",{id:!0,style:!0}),X(n).forEach($),i=j(g),u&&u.l(g),g.forEach($),a=j(y),s=N(y,"FOOTER",{class:!0,"data-svelte-h":!0}),kr(s)!=="svelte-3fqvjw"&&(s.textContent=o),y.forEach($),this.h()},h(){de(n,"id",e[1]),wr(n,"width","100%"),wr(n,"height","100%"),de(r,"class","p-4"),de(s,"class","card-footer"),de(t,"class","card")},m(m,y){ae(m,t,y),b(t,r),b(r,n),b(r,i),u&&u.m(r,null),b(t,a),b(t,s),c=!0},p(m,[y]){m[0]?u?(u.p(m,y),y&1&&O(u,1)):(u=xr(),u.c(),O(u,1),u.m(r,null)):u&&(Or(),B(u,1,1,()=>{u=null}),Pr())},i(m){c||(O(u),c=!0)},o(m){B(u),c=!1},d(m){m&&$(t),u&&u.d()}}}function ds(e,t,r){let n,{comparisonResults:i}=t,{filterData:a}=t,s="plotly",o=!1;const c=()=>{const m=document.getElementById(s);m&&dt.relayout(m,{width:m.clientWidth,height:m.clientHeight})},u=()=>{dt.downloadImage(document.getElementById(s),{format:"svg",filename:"diana"})};return dn(()=>{window.removeEventListener("resize",c)}),e.$$set=m=>{"comparisonResults"in m&&r(2,i=m.comparisonResults),"filterData"in m&&r(3,a=m.filterData)},e.$$.update=()=>{if(e.$$.dirty&4&&r(0,n=i.length===0),e.$$.dirty&29&&!n&&!o){const m={yaxis:{title:"-log10(Q-Value)"},xaxis:{zeroline:!1},margin:{b:25,t:25,r:25},barmode:"overlay",modebar:{orientation:"v"},dragmode:"select"},y={modeBarButtonsToRemove:["autoScale2d"],responsive:!0,displaylogo:!1,modeBarButtonsToAdd:[{name:"Download plot as svg",icon:dt.Icons.camera,click:u}]},g={x:i.map(T=>T.logFC),y:i.map(T=>-Math.log10(T.qValue)),text:i.map(T=>T.name),type:"scatter",mode:"markers"};dt.newPlot(s,[g],m,y),window.addEventListener("resize",c);const E=document.getElementById(s);E==null||E.on("plotly_selected",function(T){if(T===void 0)return;const l=T.points.map(h=>h.text);a(l)}),E==null||E.on("plotly_deselect",function(){a([])}),r(4,o=!0)}},[n,s,i,a,o]}class fs extends xt{constructor(t){super(),Dt(this,t,ds,hs,At,{comparisonResults:2,filterData:3})}}function ps(e){let t,r="Export CSV",n,i;return{c(){t=L("button"),t.textContent=r,this.h()},l(a){t=N(a,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),kr(t)!=="svelte-1c38tgo"&&(t.textContent=r),this.h()},h(){de(t,"type","button"),de(t,"class","btn variant-ghost-surface mr-2 hover:variant-soft-primary")},m(a,s){ae(a,t,s),n||(i=fn(t,"click",e[3]),n=!0)},p:pt,i:pt,o:pt,d(a){a&&$(t),n=!1,i()}}}function ms(e,t,r){let n,{handler:i}=t,a=i.getAllRows();Rt(e,a,u=>r(4,n=u));function s(){const u=Object.keys(n[0]),m=n.map(y=>Object.values(y).join(","));return m.unshift(u.join(",")),m.join(`\r
`)}function o(u){let m=s();const y=document.createElement("a");y.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(m)),y.setAttribute("download",u),y.style.display="none",document.body.appendChild(y),y.click(),document.body.removeChild(y)}const c=()=>o("diana.csv");return e.$$set=u=>{"handler"in u&&r(2,i=u.handler)},[a,o,i,c]}class ys extends xt{constructor(t){super(),Dt(this,t,ms,ps,At,{handler:2})}}function Dr(e,t,r){const n=e.slice();return n[4]=t[r],n}function ws(e){let t;return{c(){t=le("Gene Name")},l(r){t=ue(r,"Gene Name")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function gs(e){let t;return{c(){t=le("Start")},l(r){t=ue(r,"Start")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function bs(e){let t;return{c(){t=le("End")},l(r){t=ue(r,"End")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function vs(e){let t;return{c(){t=le("Log2 Fold Change")},l(r){t=ue(r,"Log2 Fold Change")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function Es(e){let t;return{c(){t=le("Log CPM")},l(r){t=ue(r,"Log CPM")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function _s(e){let t;return{c(){t=le("P-Value")},l(r){t=ue(r,"P-Value")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function Ts(e){let t;return{c(){t=le("Q-Value")},l(r){t=ue(r,"Q-Value")},m(r,n){ae(r,t,n)},d(r){r&&$(t)}}}function Ur(e){let t,r,n=e[4].name+"",i,a,s,o=e[4].start+"",c,u,m,y=e[4].end+"",g,E,T,l=e[4].logFC+"",h,v,d,R=e[4].logCPM+"",_,x,A,se=e[4].pValue+"",P,ce,ee,he=e[4].qValue+"",xe,pe;return{c(){t=L("tr"),r=L("td"),i=le(n),a=U(),s=L("td"),c=le(o),u=U(),m=L("td"),g=le(y),E=U(),T=L("td"),h=le(l),v=U(),d=L("td"),_=le(R),x=U(),A=L("td"),P=le(se),ce=U(),ee=L("td"),xe=le(he),pe=U()},l(K){t=N(K,"TR",{});var S=X(t);r=N(S,"TD",{});var ze=X(r);i=ue(ze,n),ze.forEach($),a=j(S),s=N(S,"TD",{});var ye=X(s);c=ue(ye,o),ye.forEach($),u=j(S),m=N(S,"TD",{});var Xe=X(m);g=ue(Xe,y),Xe.forEach($),E=j(S),T=N(S,"TD",{});var we=X(T);h=ue(we,l),we.forEach($),v=j(S),d=N(S,"TD",{});var He=X(d);_=ue(He,R),He.forEach($),x=j(S),A=N(S,"TD",{});var ge=X(A);P=ue(ge,se),ge.forEach($),ce=j(S),ee=N(S,"TD",{});var Je=X(ee);xe=ue(Je,he),Je.forEach($),pe=j(S),S.forEach($)},m(K,S){ae(K,t,S),b(t,r),b(r,i),b(t,a),b(t,s),b(s,c),b(t,u),b(t,m),b(m,g),b(t,E),b(t,T),b(T,h),b(t,v),b(t,d),b(d,_),b(t,x),b(t,A),b(A,P),b(t,ce),b(t,ee),b(ee,xe),b(t,pe)},p(K,S){S&1&&n!==(n=K[4].name+"")&&Ce(i,n),S&1&&o!==(o=K[4].start+"")&&Ce(c,o),S&1&&y!==(y=K[4].end+"")&&Ce(g,y),S&1&&l!==(l=K[4].logFC+"")&&Ce(h,l),S&1&&R!==(R=K[4].logCPM+"")&&Ce(_,R),S&1&&se!==(se=K[4].pValue+"")&&Ce(P,se),S&1&&he!==(he=K[4].qValue+"")&&Ce(xe,he)},d(K){K&&$(t)}}}function Rs(e){let t,r,n,i,a,s,o,c,u,m,y,g,E,T,l,h,v,d,R,_,x,A,se,P,ce,ee,he,xe,pe,K,S,ze,ye,Xe,we,He,ge,Je,Ge,Bt,be,ke,Ct,Oe,Mt,Pe,ht;n=new gn({props:{handler:e[1]}}),a=new ys({props:{handler:e[1]}}),m=new Me({props:{handler:e[1],orderBy:"name",$$slots:{default:[ws]},$$scope:{ctx:e}}}),g=new Me({props:{handler:e[1],orderBy:"start",$$slots:{default:[gs]},$$scope:{ctx:e}}}),T=new Me({props:{handler:e[1],orderBy:"end",$$slots:{default:[bs]},$$scope:{ctx:e}}}),h=new Me({props:{handler:e[1],orderBy:"logFC",$$slots:{default:[vs]},$$scope:{ctx:e}}}),d=new Me({props:{handler:e[1],orderBy:"logCPM",$$slots:{default:[Es]},$$scope:{ctx:e}}}),_=new Me({props:{handler:e[1],orderBy:"pValue",$$slots:{default:[_s]},$$scope:{ctx:e}}}),A=new Me({props:{handler:e[1],orderBy:"qValue",$$slots:{default:[Ts]},$$scope:{ctx:e}}}),ce=new Le({props:{handler:e[1],filterBy:"name"}}),he=new Le({props:{handler:e[1],filterBy:"start"}}),pe=new Le({props:{handler:e[1],filterBy:"end"}}),S=new Le({props:{handler:e[1],filterBy:"logFC"}}),ye=new Le({props:{handler:e[1],filterBy:"logCPM"}}),we=new Le({props:{handler:e[1],filterBy:"pValue"}}),ge=new Le({props:{handler:e[1],filterBy:"qValue"}});let Ke=br(e[0]),Q=[];for(let w=0;w<Ke.length;w+=1)Q[w]=Ur(Dr(e,Ke,w));return ke=new bn({props:{handler:e[1]}}),Oe=new vn({props:{handler:e[1]}}),Pe=new En({props:{handler:e[1]}}),{c(){t=L("div"),r=L("header"),F(n.$$.fragment),i=U(),F(a.$$.fragment),s=U(),o=L("table"),c=L("thead"),u=L("tr"),F(m.$$.fragment),y=U(),F(g.$$.fragment),E=U(),F(T.$$.fragment),l=U(),F(h.$$.fragment),v=U(),F(d.$$.fragment),R=U(),F(_.$$.fragment),x=U(),F(A.$$.fragment),se=U(),P=L("tr"),F(ce.$$.fragment),ee=U(),F(he.$$.fragment),xe=U(),F(pe.$$.fragment),K=U(),F(S.$$.fragment),ze=U(),F(ye.$$.fragment),Xe=U(),F(we.$$.fragment),He=U(),F(ge.$$.fragment),Je=U(),Ge=L("tbody");for(let w=0;w<Q.length;w+=1)Q[w].c();Bt=U(),be=L("footer"),F(ke.$$.fragment),Ct=U(),F(Oe.$$.fragment),Mt=U(),F(Pe.$$.fragment),this.h()},l(w){t=N(w,"DIV",{class:!0});var C=X(t);r=N(C,"HEADER",{class:!0});var fe=X(r);V(n.$$.fragment,fe),i=j(fe),V(a.$$.fragment,fe),fe.forEach($),s=j(C),o=N(C,"TABLE",{class:!0});var Ie=X(o);c=N(Ie,"THEAD",{});var Be=X(c);u=N(Be,"TR",{});var Y=X(u);V(m.$$.fragment,Y),y=j(Y),V(g.$$.fragment,Y),E=j(Y),V(T.$$.fragment,Y),l=j(Y),V(h.$$.fragment,Y),v=j(Y),V(d.$$.fragment,Y),R=j(Y),V(_.$$.fragment,Y),x=j(Y),V(A.$$.fragment,Y),Y.forEach($),se=j(Be),P=N(Be,"TR",{});var Z=X(P);V(ce.$$.fragment,Z),ee=j(Z),V(he.$$.fragment,Z),xe=j(Z),V(pe.$$.fragment,Z),K=j(Z),V(S.$$.fragment,Z),ze=j(Z),V(ye.$$.fragment,Z),Xe=j(Z),V(we.$$.fragment,Z),He=j(Z),V(ge.$$.fragment,Z),Z.forEach($),Be.forEach($),Je=j(Ie),Ge=N(Ie,"TBODY",{});var nt=X(Ge);for(let te=0;te<Q.length;te+=1)Q[te].l(nt);nt.forEach($),Ie.forEach($),Bt=j(C),be=N(C,"FOOTER",{class:!0});var Re=X(be);V(ke.$$.fragment,Re),Ct=j(Re),V(Oe.$$.fragment,Re),Mt=j(Re),V(Pe.$$.fragment,Re),Re.forEach($),C.forEach($),this.h()},h(){de(r,"class","flex justify-between gap-4"),de(o,"class","table table-hover table-compact w-full table-auto"),de(be,"class","flex justify-between"),de(t,"class","overflow-x-auto space-y-4")},m(w,C){ae(w,t,C),b(t,r),q(n,r,null),b(r,i),q(a,r,null),b(t,s),b(t,o),b(o,c),b(c,u),q(m,u,null),b(u,y),q(g,u,null),b(u,E),q(T,u,null),b(u,l),q(h,u,null),b(u,v),q(d,u,null),b(u,R),q(_,u,null),b(u,x),q(A,u,null),b(c,se),b(c,P),q(ce,P,null),b(P,ee),q(he,P,null),b(P,xe),q(pe,P,null),b(P,K),q(S,P,null),b(P,ze),q(ye,P,null),b(P,Xe),q(we,P,null),b(P,He),q(ge,P,null),b(o,Je),b(o,Ge);for(let fe=0;fe<Q.length;fe+=1)Q[fe]&&Q[fe].m(Ge,null);b(t,Bt),b(t,be),q(ke,be,null),b(be,Ct),q(Oe,be,null),b(be,Mt),q(Pe,be,null),ht=!0},p(w,[C]){const fe={};C&128&&(fe.$$scope={dirty:C,ctx:w}),m.$set(fe);const Ie={};C&128&&(Ie.$$scope={dirty:C,ctx:w}),g.$set(Ie);const Be={};C&128&&(Be.$$scope={dirty:C,ctx:w}),T.$set(Be);const Y={};C&128&&(Y.$$scope={dirty:C,ctx:w}),h.$set(Y);const Z={};C&128&&(Z.$$scope={dirty:C,ctx:w}),d.$set(Z);const nt={};C&128&&(nt.$$scope={dirty:C,ctx:w}),_.$set(nt);const Re={};if(C&128&&(Re.$$scope={dirty:C,ctx:w}),A.$set(Re),C&1){Ke=br(w[0]);let te;for(te=0;te<Ke.length;te+=1){const yr=Dr(w,Ke,te);Q[te]?Q[te].p(yr,C):(Q[te]=Ur(yr),Q[te].c(),Q[te].m(Ge,null))}for(;te<Q.length;te+=1)Q[te].d(1);Q.length=Ke.length}},i(w){ht||(O(n.$$.fragment,w),O(a.$$.fragment,w),O(m.$$.fragment,w),O(g.$$.fragment,w),O(T.$$.fragment,w),O(h.$$.fragment,w),O(d.$$.fragment,w),O(_.$$.fragment,w),O(A.$$.fragment,w),O(ce.$$.fragment,w),O(he.$$.fragment,w),O(pe.$$.fragment,w),O(S.$$.fragment,w),O(ye.$$.fragment,w),O(we.$$.fragment,w),O(ge.$$.fragment,w),O(ke.$$.fragment,w),O(Oe.$$.fragment,w),O(Pe.$$.fragment,w),ht=!0)},o(w){B(n.$$.fragment,w),B(a.$$.fragment,w),B(m.$$.fragment,w),B(g.$$.fragment,w),B(T.$$.fragment,w),B(h.$$.fragment,w),B(d.$$.fragment,w),B(_.$$.fragment,w),B(A.$$.fragment,w),B(ce.$$.fragment,w),B(he.$$.fragment,w),B(pe.$$.fragment,w),B(S.$$.fragment,w),B(ye.$$.fragment,w),B(we.$$.fragment,w),B(ge.$$.fragment,w),B(ke.$$.fragment,w),B(Oe.$$.fragment,w),B(Pe.$$.fragment,w),ht=!1},d(w){w&&$(t),z(n),z(a),z(m),z(g),z(T),z(h),z(d),z(_),z(A),z(ce),z(he),z(pe),z(S),z(ye),z(we),z(ge),pn(Q,w),z(ke),z(Oe),z(Pe)}}}function $s(e,t,r){let n,{comparisonResults:i}=t,a=new _n(i,{rowsPerPage:10}),s=a.getRows();return Rt(e,s,o=>r(0,n=o)),e.$$set=o=>{"comparisonResults"in o&&r(3,i=o.comparisonResults)},e.$$.update=()=>{e.$$.dirty&8&&i&&a.setRows(i)},[n,a,s,i]}class Ss extends xt{constructor(t){super(),Dt(this,t,$s,Rs,At,{comparisonResults:3})}}function jr(e){let t,r;return t=new Ss({props:{comparisonResults:e[1]}}),{c(){F(t.$$.fragment)},l(n){V(t.$$.fragment,n)},m(n,i){q(t,n,i),r=!0},p(n,i){const a={};i&2&&(a.comparisonResults=n[1]),t.$set(a)},i(n){r||(O(t.$$.fragment,n),r=!0)},o(n){B(t.$$.fragment,n),r=!1},d(n){z(t,n)}}}function As(e){let t,r,n,i,a;r=new fs({props:{comparisonResults:e[0],filterData:e[2]}});let s=e[1].length>0&&jr(e);return{c(){t=L("div"),F(r.$$.fragment),n=U(),i=L("div"),s&&s.c(),this.h()},l(o){t=N(o,"DIV",{class:!0});var c=X(t);V(r.$$.fragment,c),c.forEach($),n=j(o),i=N(o,"DIV",{class:!0});var u=X(i);s&&s.l(u),u.forEach($),this.h()},h(){de(t,"class","m-4"),de(i,"class","m-4")},m(o,c){ae(o,t,c),q(r,t,null),ae(o,n,c),ae(o,i,c),s&&s.m(i,null),a=!0},p(o,[c]){const u={};c&1&&(u.comparisonResults=o[0]),r.$set(u),o[1].length>0?s?(s.p(o,c),c&2&&O(s,1)):(s=jr(o),s.c(),O(s,1),s.m(i,null)):s&&(Or(),B(s,1,1,()=>{s=null}),Pr())},i(o){a||(O(r.$$.fragment,o),O(s),a=!0)},o(o){B(r.$$.fragment,o),B(s),a=!1},d(o){o&&($(t),$(n),$(i)),z(r),s&&s.d()}}}function xs(e,t,r){let n,i;Rt(e,yn,g=>r(5,n=g)),Rt(e,mn,g=>r(6,i=g));let a=[],s=[],o=[],c=[];const u=Array.from(i.entries());a=u.filter(([g,E])=>g.toLowerCase().includes("0")).map(([g,E])=>E.total),s=u.filter(([g,E])=>!g.toLowerCase().includes("0")).map(([g,E])=>E.total);async function m(){const g=await Promise.all(a.map(T=>gr(n.features,T,[],0,0))),E=await Promise.all(s.map(T=>gr(n.features,T,[],0,0)));r(0,o=await cs(g,E)),r(1,c=[...o])}const y=g=>{if(g.length===0){r(1,c=o);return}r(1,c=o.filter(E=>g.includes(E.name)))};return e.$$.update=()=>{e.$$.dirty&24&&a.length&&s.length&&m()},[o,c,y,a,s]}class Ls extends xt{constructor(t){super(),Dt(this,t,xs,As,At,{})}}export{Ls as component};
