import{s as le,D as _,x as ne,e as I,a as j,c as R,b as z,g as Q,f as S,G as ue,p as h,a5 as de,i as U,h as K,H as C,y as se,z as ie,A as ae,r as Ee,I as me,B as Me,E as M,K as N,u as Se,t as Ye,a6 as O,d as ke,n as P,N as be,k as fe,v as Oe,a7 as De}from"../chunks/scheduler.DKbtAq6e.js";import{S as oe,i as ce,a as H,g as A,t as x,e as q,f as Ae,c as Ie,b as Re,m as Ve,d as Ce}from"../chunks/index.CN1Ak3go.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.DE42Ll-H.js";import{g as qe}from"../chunks/spread.CN4WR7uZ.js";import{v as he}from"../chunks/viewsStore.CZ-aDO3x.js";import{g as $e}from"../chunks/gffStore.b_i4jZ9-.js";import{t as pe,u as et}from"../chunks/userPlotStore.BTtx-SKB.js";import{g as tt}from"../chunks/entry.BN_gCBfH.js";const lt=t=>({}),Ze=t=>({}),nt=t=>({}),ge=t=>({}),st=t=>({}),ye=t=>({});function Ge(t){let e,l,n;const o=t[18].lead,a=ne(o,t,t[17],ye);return{c(){e=I("div"),a&&a.c(),this.h()},l(s){e=R(s,"DIV",{class:!0});var i=z(e);a&&a.l(i),i.forEach(S),this.h()},h(){h(e,"class",l="dropzone-lead "+t[5])},m(s,i){U(s,e,i),a&&a.m(e,null),n=!0},p(s,i){a&&a.p&&(!n||i[0]&131072)&&se(a,o,s,s[17],n?ae(o,s[17],i,st):ie(s[17]),ye),(!n||i[0]&32&&l!==(l="dropzone-lead "+s[5]))&&h(e,"class",l)},i(s){n||(H(a,s),n=!0)},o(s){x(a,s),n=!1},d(s){s&&S(e),a&&a.d(s)}}}function it(t){let e,l="Upload a file",n;return{c(){e=I("strong"),e.textContent=l,n=Ye(" or drag and drop")},l(o){e=R(o,"STRONG",{"data-svelte-h":!0}),O(e)!=="svelte-13uz6lq"&&(e.textContent=l),n=ke(o," or drag and drop")},m(o,a){U(o,e,a),U(o,n,a)},p:P,d(o){o&&(S(e),S(n))}}}function Xe(t){let e,l,n;const o=t[18].meta,a=ne(o,t,t[17],Ze);return{c(){e=I("small"),a&&a.c(),this.h()},l(s){e=R(s,"SMALL",{class:!0});var i=z(e);a&&a.l(i),i.forEach(S),this.h()},h(){h(e,"class",l="dropzone-meta "+t[7])},m(s,i){U(s,e,i),a&&a.m(e,null),n=!0},p(s,i){a&&a.p&&(!n||i[0]&131072)&&se(a,o,s,s[17],n?ae(o,s[17],i,lt):ie(s[17]),Ze),(!n||i[0]&128&&l!==(l="dropzone-meta "+s[7]))&&h(e,"class",l)},i(s){n||(H(a,s),n=!0)},o(s){x(a,s),n=!1},d(s){s&&S(e),a&&a.d(s)}}}function at(t){let e,l,n,o,a,s,i,c,u,b,d,y,p,G,f,W,v=[{type:"file"},{name:t[2]},{class:n="dropzone-input "+t[9]},t[11]()],Z={};for(let m=0;m<v.length;m+=1)Z=_(Z,v[m]);let X=t[13].lead&&Ge(t);const Y=t[18].message,T=ne(Y,t,t[17],ge),V=T||it();let L=t[13].meta&&Xe(t);return{c(){e=I("div"),l=I("input"),o=j(),a=I("div"),s=I("div"),X&&X.c(),i=j(),c=I("div"),V&&V.c(),b=j(),L&&L.c(),this.h()},l(m){e=R(m,"DIV",{class:!0,"data-testid":!0});var g=z(e);l=R(g,"INPUT",{type:!0,name:!0,class:!0}),o=Q(g),a=R(g,"DIV",{class:!0});var J=z(a);s=R(J,"DIV",{class:!0});var k=z(s);X&&X.l(k),i=Q(k),c=R(k,"DIV",{class:!0});var w=z(c);V&&V.l(w),w.forEach(S),b=Q(k),L&&L.l(k),k.forEach(S),J.forEach(S),g.forEach(S),this.h()},h(){ue(l,Z),h(c,"class",u="dropzone-message "+t[6]),h(s,"class",d="dropzone-interface-text "+t[4]),h(a,"class",y="dropzone-interface "+t[8]+" "+t[3]),h(e,"class",p="dropzone "+t[10]),h(e,"data-testid","file-dropzone"),de(e,"opacity-50",t[12].disabled)},m(m,g){U(m,e,g),K(e,l),l.autofocus&&l.focus(),t[32](l),K(e,o),K(e,a),K(a,s),X&&X.m(s,null),K(s,i),K(s,c),V&&V.m(c,null),K(s,b),L&&L.m(s,null),G=!0,f||(W=[C(l,"change",t[31]),C(l,"change",t[19]),C(l,"dragenter",t[20]),C(l,"dragover",t[21]),C(l,"dragleave",t[22]),C(l,"drop",t[23]),C(l,"click",t[24]),C(l,"keydown",t[25]),C(l,"keyup",t[26]),C(l,"keypress",t[27]),C(l,"focus",t[28]),C(l,"focusin",t[29]),C(l,"focusout",t[30])],f=!0)},p(m,g){ue(l,Z=qe(v,[{type:"file"},(!G||g[0]&4)&&{name:m[2]},(!G||g[0]&512&&n!==(n="dropzone-input "+m[9]))&&{class:n},m[11]()])),m[13].lead?X?(X.p(m,g),g[0]&8192&&H(X,1)):(X=Ge(m),X.c(),H(X,1),X.m(s,i)):X&&(A(),x(X,1,1,()=>{X=null}),q()),T&&T.p&&(!G||g[0]&131072)&&se(T,Y,m,m[17],G?ae(Y,m[17],g,nt):ie(m[17]),ge),(!G||g[0]&64&&u!==(u="dropzone-message "+m[6]))&&h(c,"class",u),m[13].meta?L?(L.p(m,g),g[0]&8192&&H(L,1)):(L=Xe(m),L.c(),H(L,1),L.m(s,null)):L&&(A(),x(L,1,1,()=>{L=null}),q()),(!G||g[0]&16&&d!==(d="dropzone-interface-text "+m[4]))&&h(s,"class",d),(!G||g[0]&264&&y!==(y="dropzone-interface "+m[8]+" "+m[3]))&&h(a,"class",y),(!G||g[0]&1024&&p!==(p="dropzone "+m[10]))&&h(e,"class",p),(!G||g[0]&5120)&&de(e,"opacity-50",m[12].disabled)},i(m){G||(H(X),H(V,m),H(L),G=!0)},o(m){x(X),x(V,m),x(L),G=!1},d(m){m&&S(e),t[32](null),X&&X.d(),V&&V.d(m),L&&L.d(),f=!1,Ee(W)}}}const ot="textarea relative flex justify-center items-center",ct="w-full absolute top-0 left-0 right-0 bottom-0 z-[1] opacity-0 disabled:!opacity-0 cursor-pointer",rt="flex justify-center items-center text-center";function ut(t,e,l){let n,o,a;const s=["files","fileInput","name","border","padding","rounded","regionInterface","regionInterfaceText","slotLead","slotMessage","slotMeta"];let i=me(e,s),{$$slots:c={},$$scope:u}=e;const b=Me(c);let{files:d=void 0}=e,{fileInput:y=void 0}=e,{name:p}=e,{border:G="border-2 border-dashed"}=e,{padding:f="p-4 py-8"}=e,{rounded:W="rounded-container-token"}=e,{regionInterface:v=""}=e,{regionInterfaceText:Z=""}=e,{slotLead:X="mb-4"}=e,{slotMessage:Y=""}=e,{slotMeta:T="opacity-75"}=e;function V(){return delete i.class,i}function L(r){N.call(this,t,r)}function m(r){N.call(this,t,r)}function g(r){N.call(this,t,r)}function J(r){N.call(this,t,r)}function k(r){N.call(this,t,r)}function w(r){N.call(this,t,r)}function D(r){N.call(this,t,r)}function Fe(r){N.call(this,t,r)}function we(r){N.call(this,t,r)}function Be(r){N.call(this,t,r)}function je(r){N.call(this,t,r)}function Qe(r){N.call(this,t,r)}function _e(){d=this.files,l(0,d)}function Pe(r){Se[r?"unshift":"push"](()=>{y=r,l(1,y)})}return t.$$set=r=>{l(33,e=_(_({},e),M(r))),l(12,i=me(e,s)),"files"in r&&l(0,d=r.files),"fileInput"in r&&l(1,y=r.fileInput),"name"in r&&l(2,p=r.name),"border"in r&&l(14,G=r.border),"padding"in r&&l(15,f=r.padding),"rounded"in r&&l(16,W=r.rounded),"regionInterface"in r&&l(3,v=r.regionInterface),"regionInterfaceText"in r&&l(4,Z=r.regionInterfaceText),"slotLead"in r&&l(5,X=r.slotLead),"slotMessage"in r&&l(6,Y=r.slotMessage),"slotMeta"in r&&l(7,T=r.slotMeta),"$$scope"in r&&l(17,u=r.$$scope)},t.$$.update=()=>{l(10,n=`${ot} ${G} ${f} ${W} ${e.class??""}`)},l(9,o=`${ct}`),l(8,a=`${rt}`),e=M(e),[d,y,p,v,Z,X,Y,T,a,o,n,V,i,b,G,f,W,u,c,L,m,g,J,k,w,D,Fe,we,Be,je,Qe,_e,Pe]}class dt extends oe{constructor(e){super(),ce(this,e,ut,at,le,{files:0,fileInput:1,name:2,border:14,padding:15,rounded:16,regionInterface:3,regionInterfaceText:4,slotLead:5,slotMessage:6,slotMeta:7},null,[-1,-1])}}function mt(t){let e,l,n,o=`${t[4]?100:t[7]}%`,a,s;return{c(){e=I("div"),l=I("div"),this.h()},l(i){e=R(i,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-labelledby":!0,"aria-valuenow":!0,"aria-valuemin":!0,"aria-valuemax":!0});var c=z(e);l=R(c,"DIV",{class:!0}),z(l).forEach(S),c.forEach(S),this.h()},h(){h(l,"class",n="progress-bar-meter "+t[5]+" svelte-12wvf64"),be(l,"width",o),h(e,"class",a="progress-bar "+t[6]+" svelte-12wvf64"),h(e,"data-testid","progress-bar"),h(e,"role","progressbar"),h(e,"aria-labelledby",t[3]),h(e,"aria-valuenow",t[0]),h(e,"aria-valuemin",t[1]),h(e,"aria-valuemax",s=t[2]-t[1])},m(i,c){U(i,e,c),K(e,l)},p(i,[c]){c&32&&n!==(n="progress-bar-meter "+i[5]+" svelte-12wvf64")&&h(l,"class",n),c&144&&o!==(o=`${i[4]?100:i[7]}%`)&&be(l,"width",o),c&64&&a!==(a="progress-bar "+i[6]+" svelte-12wvf64")&&h(e,"class",a),c&8&&h(e,"aria-labelledby",i[3]),c&1&&h(e,"aria-valuenow",i[0]),c&2&&h(e,"aria-valuemin",i[1]),c&6&&s!==(s=i[2]-i[1])&&h(e,"aria-valuemax",s)},i:P,o:P,d(i){i&&S(e)}}}const bt="w-full overflow-hidden",ft="h-full";function ht(t,e,l){let n,o,a,s,i,{value:c=void 0}=e,{min:u=0}=e,{max:b=100}=e,{height:d="h-2"}=e,{rounded:y="rounded-token"}=e,{transition:p="transition-[width]"}=e,{animIndeterminate:G="anim-indeterminate"}=e,{meter:f="bg-surface-900-50-token"}=e,{track:W="bg-surface-200-700-token"}=e,{labelledby:v=""}=e;return t.$$set=Z=>{l(15,e=_(_({},e),M(Z))),"value"in Z&&l(0,c=Z.value),"min"in Z&&l(1,u=Z.min),"max"in Z&&l(2,b=Z.max),"height"in Z&&l(8,d=Z.height),"rounded"in Z&&l(9,y=Z.rounded),"transition"in Z&&l(10,p=Z.transition),"animIndeterminate"in Z&&l(11,G=Z.animIndeterminate),"meter"in Z&&l(12,f=Z.meter),"track"in Z&&l(13,W=Z.track),"labelledby"in Z&&l(3,v=Z.labelledby)},t.$$.update=()=>{t.$$.dirty&7&&l(7,n=c?100*(c-u)/(b-u):0),t.$$.dirty&1&&l(4,o=c===void 0||c<0),t.$$.dirty&2064&&l(14,a=o?G:""),l(6,s=`${bt} ${W} ${d} ${y} ${e.class??""}`),t.$$.dirty&22016&&l(5,i=`${ft} ${f} ${y} ${a} ${p}`)},e=M(e),[c,u,b,v,o,i,s,n,d,y,p,G,f,W,a]}class pt extends oe{constructor(e){super(),ce(this,e,ht,mt,le,{value:0,min:1,max:2,height:8,rounded:9,transition:10,animIndeterminate:11,meter:12,track:13,labelledby:3})}}function $(t){const e=new Blob([t],{type:"application/octet-stream"});return URL.createObjectURL(e)}function Zt(t){const e=t.split(`
`),l=[];let n=0;for(const o of e){n++;const[a,s]=o.split(" ");if(a==="0"&&s==="0")continue;const i=[n.toString(),a,s,parseInt(a)+parseInt(s)];l.push(i.join(","))}return l.join(`
`)}function gt(t,e,l){const n=Zt(t),o=$(n),a=[0,20];return{alignment:"overlay",height:100,width:l,style:{outlineWidth:0},tracks:[{layout:"linear",data:{url:o,type:"csv",genomicFields:["position","plus","minus","total"],headerNames:["position","plus","minus","total"]},x:{field:"position",type:"genomic",linkingId:"SharedXAxis",axis:"none"},y:{field:"plus",type:"quantitative",axis:"none",domain:a},title:e,mark:"bar",color:{value:"#3498db"}},{layout:"linear",data:{url:o,type:"csv",genomicFields:["position","plus","minus"],headerNames:["position","plus","minus"]},x:{field:"position",type:"genomic",linkingId:"SharedXAxis",axis:"none"},y:{field:"minus",type:"quantitative",axis:"none",domain:a},mark:"bar",color:{value:"#2ecc71"}}]}}const Ke=Symbol("Comlink.proxy"),yt=Symbol("Comlink.endpoint"),Gt=Symbol("Comlink.releaseProxy"),ee=Symbol("Comlink.thrown"),He=t=>typeof t=="object"&&t!==null||typeof t=="function",Xt={canHandle:t=>He(t)&&t[Ke],serialize(t){const{port1:e,port2:l}=new MessageChannel;return xe(t,e),[l,[l]]},deserialize(t){return t.start(),Te(t)}},Lt={canHandle:t=>He(t)&&ee in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Ne=new Map([["proxy",Xt],["throw",Lt]]);function xe(t,e=self){e.addEventListener("message",function l(n){if(!n||!n.data)return;const{id:o,type:a,path:s}=Object.assign({path:[]},n.data),i=(n.data.argumentList||[]).map(F);let c;try{const u=s.slice(0,-1).reduce((d,y)=>d[y],t),b=s.reduce((d,y)=>d[y],t);switch(a){case"GET":c=b;break;case"SET":u[s.slice(-1)[0]]=F(n.data.value),c=!0;break;case"APPLY":c=b.apply(u,i);break;case"CONSTRUCT":{const d=new b(...i);c=Yt(d)}break;case"ENDPOINT":{const{port1:d,port2:y}=new MessageChannel;xe(t,y),c=St(d,[d])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[ee]:0}}Promise.resolve(c).catch(u=>({value:u,[ee]:0})).then(u=>{const[b,d]=re(u);e.postMessage(Object.assign(Object.assign({},b),{id:o}),d),a==="RELEASE"&&(e.removeEventListener("message",l),ze(e))})}),e.start&&e.start()}function Wt(t){return t.constructor.name==="MessagePort"}function ze(t){Wt(t)&&t.close()}function Te(t,e){return te(t,[],e)}function E(t){if(t)throw new Error("Proxy has been released and is not useable")}function te(t,e=[],l=function(){}){let n=!1;const o=new Proxy(l,{get(a,s){if(E(n),s===Gt)return()=>B(t,{type:"RELEASE",path:e.map(i=>i.toString())}).then(()=>{ze(t),n=!0});if(s==="then"){if(e.length===0)return{then:()=>o};const i=B(t,{type:"GET",path:e.map(c=>c.toString())}).then(F);return i.then.bind(i)}return te(t,[...e,s])},set(a,s,i){E(n);const[c,u]=re(i);return B(t,{type:"SET",path:[...e,s].map(b=>b.toString()),value:c},u).then(F)},apply(a,s,i){E(n);const c=e[e.length-1];if(c===yt)return B(t,{type:"ENDPOINT"}).then(F);if(c==="bind")return te(t,e.slice(0,-1));const[u,b]=Le(i);return B(t,{type:"APPLY",path:e.map(d=>d.toString()),argumentList:u},b).then(F)},construct(a,s){E(n);const[i,c]=Le(s);return B(t,{type:"CONSTRUCT",path:e.map(u=>u.toString()),argumentList:i},c).then(F)}});return o}function vt(t){return Array.prototype.concat.apply([],t)}function Le(t){const e=t.map(re);return[e.map(l=>l[0]),vt(e.map(l=>l[1]))]}const Ue=new WeakMap;function St(t,e){return Ue.set(t,e),t}function Yt(t){return Object.assign(t,{[Ke]:!0})}function re(t){for(const[e,l]of Ne)if(l.canHandle(t)){const[n,o]=l.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},Ue.get(t)||[]]}function F(t){switch(t.type){case"HANDLER":return Ne.get(t.name).deserialize(t.value);case"RAW":return t.value}}function B(t,e,l){return new Promise(n=>{const o=kt();t.addEventListener("message",function a(s){!s.data||!s.data.id||s.data.id!==o||(t.removeEventListener("message",a),n(s.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),l)})}function kt(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const Je="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0ICQ9U3ltYm9sKCJDb21saW5rLnByb3h5IiksQT1TeW1ib2woIkNvbWxpbmsuZW5kcG9pbnQiKSxSPVN5bWJvbCgiQ29tbGluay5yZWxlYXNlUHJveHkiKSx5PVN5bWJvbCgiQ29tbGluay50aHJvd24iKSxfPWU9PnR5cGVvZiBlPT0ib2JqZWN0IiYmZSE9PW51bGx8fHR5cGVvZiBlPT0iZnVuY3Rpb24iLEw9e2NhbkhhbmRsZTplPT5fKGUpJiZlWyRdLHNlcmlhbGl6ZShlKXtjb25zdHtwb3J0MTpyLHBvcnQyOml9PW5ldyBNZXNzYWdlQ2hhbm5lbDtyZXR1cm4gdyhlLHIpLFtpLFtpXV19LGRlc2VyaWFsaXplKGUpe3JldHVybiBlLnN0YXJ0KCksQyhlKX19LE89e2NhbkhhbmRsZTplPT5fKGUpJiZ5IGluIGUsc2VyaWFsaXplKHt2YWx1ZTplfSl7bGV0IHI7cmV0dXJuIGUgaW5zdGFuY2VvZiBFcnJvcj9yPXtpc0Vycm9yOiEwLHZhbHVlOnttZXNzYWdlOmUubWVzc2FnZSxuYW1lOmUubmFtZSxzdGFjazplLnN0YWNrfX06cj17aXNFcnJvcjohMSx2YWx1ZTplfSxbcixbXV19LGRlc2VyaWFsaXplKGUpe3Rocm93IGUuaXNFcnJvcj9PYmplY3QuYXNzaWduKG5ldyBFcnJvcihlLnZhbHVlLm1lc3NhZ2UpLGUudmFsdWUpOmUudmFsdWV9fSxFPW5ldyBNYXAoW1sicHJveHkiLExdLFsidGhyb3ciLE9dXSk7ZnVuY3Rpb24gdyhlLHI9c2VsZil7ci5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixmdW5jdGlvbiBpKHMpe2lmKCFzfHwhcy5kYXRhKXJldHVybjtjb25zdHtpZDpvLHR5cGU6YSxwYXRoOm59PU9iamVjdC5hc3NpZ24oe3BhdGg6W119LHMuZGF0YSksdT0ocy5kYXRhLmFyZ3VtZW50TGlzdHx8W10pLm1hcChtKTtsZXQgbDt0cnl7Y29uc3QgYz1uLnNsaWNlKDAsLTEpLnJlZHVjZSgoZCxoKT0+ZFtoXSxlKSxmPW4ucmVkdWNlKChkLGgpPT5kW2hdLGUpO3N3aXRjaChhKXtjYXNlIkdFVCI6bD1mO2JyZWFrO2Nhc2UiU0VUIjpjW24uc2xpY2UoLTEpWzBdXT1tKHMuZGF0YS52YWx1ZSksbD0hMDticmVhaztjYXNlIkFQUExZIjpsPWYuYXBwbHkoYyx1KTticmVhaztjYXNlIkNPTlNUUlVDVCI6e2NvbnN0IGQ9bmV3IGYoLi4udSk7bD16KGQpfWJyZWFrO2Nhc2UiRU5EUE9JTlQiOntjb25zdHtwb3J0MTpkLHBvcnQyOmh9PW5ldyBNZXNzYWdlQ2hhbm5lbDt3KGUsaCksbD1OKGQsW2RdKX1icmVhaztjYXNlIlJFTEVBU0UiOmw9dm9pZCAwO2JyZWFrO2RlZmF1bHQ6cmV0dXJufX1jYXRjaChjKXtsPXt2YWx1ZTpjLFt5XTowfX1Qcm9taXNlLnJlc29sdmUobCkuY2F0Y2goYz0+KHt2YWx1ZTpjLFt5XTowfSkpLnRoZW4oYz0+e2NvbnN0W2YsZF09UyhjKTtyLnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxmKSx7aWQ6b30pLGQpLGE9PT0iUkVMRUFTRSImJihyLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGkpLEYocikpfSl9KSxyLnN0YXJ0JiZyLnN0YXJ0KCl9ZnVuY3Rpb24gVChlKXtyZXR1cm4gZS5jb25zdHJ1Y3Rvci5uYW1lPT09Ik1lc3NhZ2VQb3J0In1mdW5jdGlvbiBGKGUpe1QoZSkmJmUuY2xvc2UoKX1mdW5jdGlvbiBDKGUscil7cmV0dXJuIGIoZSxbXSxyKX1mdW5jdGlvbiBwKGUpe2lmKGUpdGhyb3cgbmV3IEVycm9yKCJQcm94eSBoYXMgYmVlbiByZWxlYXNlZCBhbmQgaXMgbm90IHVzZWFibGUiKX1mdW5jdGlvbiBiKGUscj1bXSxpPWZ1bmN0aW9uKCl7fSl7bGV0IHM9ITE7Y29uc3Qgbz1uZXcgUHJveHkoaSx7Z2V0KGEsbil7aWYocChzKSxuPT09UilyZXR1cm4oKT0+ZyhlLHt0eXBlOiJSRUxFQVNFIixwYXRoOnIubWFwKHU9PnUudG9TdHJpbmcoKSl9KS50aGVuKCgpPT57RihlKSxzPSEwfSk7aWYobj09PSJ0aGVuIil7aWYoci5sZW5ndGg9PT0wKXJldHVybnt0aGVuOigpPT5vfTtjb25zdCB1PWcoZSx7dHlwZToiR0VUIixwYXRoOnIubWFwKGw9PmwudG9TdHJpbmcoKSl9KS50aGVuKG0pO3JldHVybiB1LnRoZW4uYmluZCh1KX1yZXR1cm4gYihlLFsuLi5yLG5dKX0sc2V0KGEsbix1KXtwKHMpO2NvbnN0W2wsY109Uyh1KTtyZXR1cm4gZyhlLHt0eXBlOiJTRVQiLHBhdGg6Wy4uLnIsbl0ubWFwKGY9PmYudG9TdHJpbmcoKSksdmFsdWU6bH0sYykudGhlbihtKX0sYXBwbHkoYSxuLHUpe3Aocyk7Y29uc3QgbD1yW3IubGVuZ3RoLTFdO2lmKGw9PT1BKXJldHVybiBnKGUse3R5cGU6IkVORFBPSU5UIn0pLnRoZW4obSk7aWYobD09PSJiaW5kIilyZXR1cm4gYihlLHIuc2xpY2UoMCwtMSkpO2NvbnN0W2MsZl09TSh1KTtyZXR1cm4gZyhlLHt0eXBlOiJBUFBMWSIscGF0aDpyLm1hcChkPT5kLnRvU3RyaW5nKCkpLGFyZ3VtZW50TGlzdDpjfSxmKS50aGVuKG0pfSxjb25zdHJ1Y3QoYSxuKXtwKHMpO2NvbnN0W3UsbF09TShuKTtyZXR1cm4gZyhlLHt0eXBlOiJDT05TVFJVQ1QiLHBhdGg6ci5tYXAoYz0+Yy50b1N0cmluZygpKSxhcmd1bWVudExpc3Q6dX0sbCkudGhlbihtKX19KTtyZXR1cm4gb31mdW5jdGlvbiBEKGUpe3JldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLGUpfWZ1bmN0aW9uIE0oZSl7Y29uc3Qgcj1lLm1hcChTKTtyZXR1cm5bci5tYXAoaT0+aVswXSksRChyLm1hcChpPT5pWzFdKSldfWNvbnN0IFA9bmV3IFdlYWtNYXA7ZnVuY3Rpb24gTihlLHIpe3JldHVybiBQLnNldChlLHIpLGV9ZnVuY3Rpb24geihlKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihlLHtbJF06ITB9KX1mdW5jdGlvbiBTKGUpe2Zvcihjb25zdFtyLGldb2YgRSlpZihpLmNhbkhhbmRsZShlKSl7Y29uc3RbcyxvXT1pLnNlcmlhbGl6ZShlKTtyZXR1cm5be3R5cGU6IkhBTkRMRVIiLG5hbWU6cix2YWx1ZTpzfSxvXX1yZXR1cm5be3R5cGU6IlJBVyIsdmFsdWU6ZX0sUC5nZXQoZSl8fFtdXX1mdW5jdGlvbiBtKGUpe3N3aXRjaChlLnR5cGUpe2Nhc2UiSEFORExFUiI6cmV0dXJuIEUuZ2V0KGUubmFtZSkuZGVzZXJpYWxpemUoZS52YWx1ZSk7Y2FzZSJSQVciOnJldHVybiBlLnZhbHVlfX1mdW5jdGlvbiBnKGUscixpKXtyZXR1cm4gbmV3IFByb21pc2Uocz0+e2NvbnN0IG89VSgpO2UuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsZnVuY3Rpb24gYShuKXshbi5kYXRhfHwhbi5kYXRhLmlkfHxuLmRhdGEuaWQhPT1vfHwoZS5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIixhKSxzKG4uZGF0YSkpfSksZS5zdGFydCYmZS5zdGFydCgpLGUucG9zdE1lc3NhZ2UoT2JqZWN0LmFzc2lnbih7aWQ6b30sciksaSl9KX1mdW5jdGlvbiBVKCl7cmV0dXJuIG5ldyBBcnJheSg0KS5maWxsKDApLm1hcCgoKT0+TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKk51bWJlci5NQVhfU0FGRV9JTlRFR0VSKS50b1N0cmluZygxNikpLmpvaW4oIi0iKX1jb25zdCBXPWFzeW5jKCk9PldlYkFzc2VtYmx5LnZhbGlkYXRlKG5ldyBVaW50OEFycmF5KFswLDk3LDExNSwxMDksMSwwLDAsMCwxLDUsMSw5NiwwLDEsMTIzLDMsMiwxLDAsMTAsMTAsMSw4LDAsNjUsMCwyNTMsMTUsMjUzLDk4LDExXSkpLHg9ImVhZ2VyIixrPSJsYXp5IixqPXtzc3c6WyJzaW1kIl0sbWluaW1hcDI6WyJzaW1kIl19LHQ9e3Rvb2xzOltdLGNvbmZpZzp7fSxmaWxlczpbXSxiYXNlOnt9LGZzOnt9LGFzeW5jIGluaXQoKXtpZih0LnRvb2xzLmxlbmd0aD09PTApdGhyb3ciRXhwZWN0aW5nIGF0IGxlYXN0IDEgdG9vbC4iO2lmKG5ldyBTZXQodC50b29scy5tYXAocj0+YCR7ci50b29sfS8ke3IucHJvZ3JhbXx8ci50b29sfWApKS5zaXplIT09dC50b29scy5sZW5ndGgpdGhyb3ciRm91bmQgZHVwbGljYXRlIHRvb2xzOyBjYW4gb25seSBoYXZlIGVhY2ggdG9vbC9wcm9ncmFtIGNvbWJpbmF0aW9uIGF0IG1vc3Qgb25jZS4iO2lmKHQuYmFzZT10LnRvb2xzLmZpbmQocj0+ci5yZWluaXQhPT0hMCksIXQuYmFzZSl0aHJvdyJDb3VsZCBub3QgZmluZCBhIHRvb2wgd2l0aCBgcmVpbml0OiBmYWxzZWAgdG8gdXNlIGFzIHRoZSBiYXNlIG1vZHVsZS4gVG8gZml4IHRoaXMgaXNzdWUsIGluY2x1ZGUgdGhlIHRvb2wgYGJhc2UvMS4wLjBgIHdoZW4gaW5pdGlhbGl6aW5nIEFpb2xpLiI7cmV0dXJuIHQuYmFzZS5pc0Jhc2VNb2R1bGU9ITAsYXdhaXQgdGhpcy5fc2V0dXAodC5iYXNlKSxhd2FpdCB0aGlzLl9pbml0TW9kdWxlcygpLHQuX2xvZygiUmVhZHkiKSwhMH0sYXN5bmMgX2luaXRNb2R1bGVzKCl7YXdhaXQgUHJvbWlzZS5hbGwodC50b29scy5tYXAodGhpcy5fc2V0dXApKSxhd2FpdCB0aGlzLl9zZXR1cEZTKCl9LG1vdW50KGU9W10pe2NvbnN0IHI9YCR7dC5jb25maWcuZGlyU2hhcmVkfSR7dC5jb25maWcuZGlyRGF0YX1gLGk9YCR7dC5jb25maWcuZGlyU2hhcmVkfSR7dC5jb25maWcuZGlyTW91bnRlZH1gO2xldCBzPVtdLG89W10sYT1bXTshQXJyYXkuaXNBcnJheShlKSYmIShlIGluc3RhbmNlb2YgRmlsZUxpc3QpJiYoZT1bZV0pLHQuX2xvZyhgTW91bnRpbmcgJHtlLmxlbmd0aH0gZmlsZXNgKTtmb3IobGV0IG4gb2YgZSl7aWYobiBpbnN0YW5jZW9mIEZpbGV8fChuPT1udWxsP3ZvaWQgMDpuLmRhdGEpaW5zdGFuY2VvZiBCbG9iJiZuLm5hbWV8fHR5cGVvZihuPT1udWxsP3ZvaWQgMDpuLmRhdGEpPT0ic3RyaW5nIiYmbi5uYW1lKXR5cGVvZihuPT1udWxsP3ZvaWQgMDpuLmRhdGEpPT0ic3RyaW5nIiYmKG4uZGF0YT1uZXcgQmxvYihbbi5kYXRhXSx7dHlwZToidGV4dC9wbGFpbiJ9KSkscy5wdXNoKG4pO2Vsc2UgaWYobi5uYW1lJiZuLnVybClvLnB1c2gobik7ZWxzZSBpZih0eXBlb2Ygbj09InN0cmluZyImJm4uc3RhcnRzV2l0aCgiaHR0cCIpKW49e3VybDpuLG5hbWU6bi5zcGxpdCgiLy8iKS5wb3AoKS5yZXBsYWNlKC9cLy9nLCItIil9LG8ucHVzaChuKTtlbHNlIHRocm93J0Nhbm5vdCBtb3VudCBmaWxlKHMpIHNwZWNpZmllZC4gTXVzdCBiZSBhIEZpbGUsIEJsb2IsIGEgVVJMIHN0cmluZywgb3IgeyBuYW1lOiAiZmlsZS50eHQiLCBkYXRhOiAic3RyaW5nIiB9Lic7YS5wdXNoKG4ubmFtZSl9dHJ5e3QuZnMudW5tb3VudChpKX1jYXRjaHt9Zm9yKGxldCBuIG9mIG8pdC5mcy5jcmVhdGVMYXp5RmlsZShyLG4ubmFtZSxuLnVybCwhMCwhMCk7cmV0dXJuIHQuZmlsZXM9dC5maWxlcy5jb25jYXQocyksdC5iYXNlLm1vZHVsZS5GUy5tb3VudCh0LmJhc2UubW9kdWxlLldPUktFUkZTLHtmaWxlczp0LmZpbGVzLmZpbHRlcihuPT5uIGluc3RhbmNlb2YgRmlsZSksYmxvYnM6dC5maWxlcy5maWx0ZXIobj0+KG49PW51bGw/dm9pZCAwOm4uZGF0YSlpbnN0YW5jZW9mIEJsb2IpfSxpKSxzLm1hcChuPT57Y29uc3QgdT1gJHtpfS8ke24ubmFtZX1gLGw9YCR7cn0vJHtuLm5hbWV9YDt0cnl7dC5mcy51bmxpbmsobCl9Y2F0Y2h7fXQuX2xvZyhgQ3JlYXRpbmcgc3ltbGluazogJHtsfSAtLT4gJHt1fWApLHQuZnMuc3ltbGluayh1LGwpfSksYS5tYXAobj0+YCR7cn0vJHtufWApfSxhc3luYyBleGVjKGUscj1udWxsKXtpZih0Ll9sb2coYEV4ZWN1dGluZyAlYyR7ZX0lYyBhcmdzPSR7cn1gLCJjb2xvcjpkYXJrYmx1ZTsgZm9udC13ZWlnaHQ6Ym9sZCIsIiIpLCFlKXRocm93IkV4cGVjdGluZyBhIGNvbW1hbmQiO2xldCBpPWU7cj09bnVsbCYmKHI9ZS5zcGxpdCgiICIpLGk9ci5zaGlmdCgpKTtjb25zdCBzPXQudG9vbHMuZmluZChhPT57dmFyIHU7bGV0IG49aTtyZXR1cm4oKHU9YT09bnVsbD92b2lkIDA6YS5mZWF0dXJlcyk9PW51bGw/dm9pZCAwOnUuc2ltZCk9PT0hMCYmKG49YCR7bn0tc2ltZGApLGEucHJvZ3JhbT09bn0pO2lmKHM9PW51bGwpdGhyb3dgUHJvZ3JhbSAke2l9IG5vdCBmb3VuZC5gO3Muc3Rkb3V0PSIiLHMuc3RkZXJyPSIiLHMubG9hZGluZz09ayYmKHMubG9hZGluZz14LGF3YWl0IHRoaXMuX2luaXRNb2R1bGVzKCkpO3RyeXtzLm1vZHVsZS5jYWxsTWFpbihyKX1jYXRjaChhKXtjb25zb2xlLmVycm9yKGEpfXRyeXtzLm1vZHVsZS5GUy5jbG9zZShzLm1vZHVsZS5GUy5zdHJlYW1zWzFdKSxzLm1vZHVsZS5GUy5jbG9zZShzLm1vZHVsZS5GUy5zdHJlYW1zWzJdKX1jYXRjaHt9cy5tb2R1bGUuRlMuc3RyZWFtc1sxXT1zLm1vZHVsZS5GUy5vcGVuKCIvZGV2L3N0ZG91dCIsInciKSxzLm1vZHVsZS5GUy5zdHJlYW1zWzJdPXMubW9kdWxlLkZTLm9wZW4oIi9kZXYvc3RkZXJyIiwidyIpO2xldCBvPXtzdGRvdXQ6cy5zdGRvdXQsc3RkZXJyOnMuc3RkZXJyfTtpZih0LmNvbmZpZy5wcmludEludGVybGVhdmVkJiYobz1zLnN0ZG91dCkscy5yZWluaXQ9PT0hMCl7Y29uc3QgYT10LmJhc2UubW9kdWxlLkZTLmN3ZCgpO09iamVjdC5hc3NpZ24ocyxzLmNvbmZpZykscy5yZWFkeT0hMSxhd2FpdCB0aGlzLmluaXQoKSxzLmlzQmFzZU1vZHVsZSYmdGhpcy5tb3VudCgpLHRoaXMuY2QoYSl9cmV0dXJuIG99LGNhdChlKXtyZXR1cm4gdC5fZmlsZW9wKCJjYXQiLGUpfSxscyhlKXtyZXR1cm4gdC5fZmlsZW9wKCJscyIsZSl9LGRvd25sb2FkKGUpe3JldHVybiB0Ll9maWxlb3AoImRvd25sb2FkIixlKX0scHdkKCl7cmV0dXJuIHQuZnMuY3dkKCl9LGNkKGUpe2ZvcihsZXQgciBvZiB0LnRvb2xzKSFyLm1vZHVsZXx8ci5tb2R1bGUuRlMuY2hkaXIoZSl9LG1rZGlyKGUpe3JldHVybiB0LmZzLm1rZGlyKGUpLCEwfSxyZWFkKHtwYXRoOmUsbGVuZ3RoOnIsZmxhZzppPSJyIixvZmZzZXQ6cz0wLHBvc2l0aW9uOm89MH0pe2NvbnN0IGE9dC5mcy5vcGVuKGUsaSksbj1uZXcgVWludDhBcnJheShyKTtyZXR1cm4gdC5mcy5yZWFkKGEsbixzLHIsbyksdC5mcy5jbG9zZShhKSxufSx3cml0ZSh7cGF0aDplLGJ1ZmZlcjpyLGZsYWc6aT0idysiLG9mZnNldDpzPTAscG9zaXRpb246bz0wfSl7Y29uc3QgYT10LmZzLm9wZW4oZSxpKTt0LmZzLndyaXRlKGEscixzLHIubGVuZ3RoLG8pLHQuZnMuY2xvc2UoYSl9LF9zdGRpblR4dDoiIixfc3RkaW5QdHI6MCxnZXQgc3RkaW4oKXtyZXR1cm4gdC5fc3RkaW5UeHR9LHNldCBzdGRpbihlPSIiKXt0Ll9sb2coYFNldHRpbmcgc3RkaW4gdG8gJWMke2V9JWNgLCJjb2xvcjpkYXJrYmx1ZSIsIiIpLHQuX3N0ZGluVHh0PWUsdC5fc3RkaW5QdHI9MH0sYXN5bmMgX3NldHVwKGUpe2lmKGUucmVhZHkpcmV0dXJuO2lmKHQuX2xvZyhgU2V0dGluZyB1cCAke2UudG9vbH0gKGJhc2UgPSAke2UuaXNCYXNlTW9kdWxlPT09ITB9KS4uLmApLGUuY29uZmlnPU9iamVjdC5hc3NpZ24oe30sZSksZS51cmxQcmVmaXh8fChlLnVybFByZWZpeD1gJHt0LmNvbmZpZy51cmxDRE59LyR7ZS50b29sfS8ke2UudmVyc2lvbn1gKSxlLnByb2dyYW18fChlLnByb2dyYW09ZS50b29sKSxlLmZlYXR1cmVzfHwoZS5mZWF0dXJlcz17fSwoaltlLnByb2dyYW1dfHxbXSkuaW5jbHVkZXMoInNpbWQiKSYmKGF3YWl0IFcoKT8oZS5wcm9ncmFtKz0iLXNpbWQiLGUuZmVhdHVyZXMuc2ltZD0hMCk6dC5fbG9nKGBXZWJBc3NlbWJseSBTSU1EIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyOyB3aWxsIGxvYWQgbm9uLVNJTUQgdmVyc2lvbiBvZiAke2UucHJvZ3JhbX0uYCkpKSxlLmlzQmFzZU1vZHVsZSYmKGUubG9hZGluZz14KSxlLmxvYWRpbmc9PT1rKXt0Ll9sb2coYFdpbGwgbGF6eS1sb2FkICR7ZS50b29sfTsgc2tpcHBpbmcgaW5pdGlhbGl6YXRpb24uYCk7cmV0dXJufXNlbGYuaW1wb3J0U2NyaXB0cyhgJHtlLnVybFByZWZpeH0vJHtlLnByb2dyYW19LmpzYCksZS5tb2R1bGU9YXdhaXQgTW9kdWxlKHt0aGlzUHJvZ3JhbTplLnByb2dyYW0sbG9jYXRlRmlsZTooaSxzKT0+YCR7ZS51cmxQcmVmaXh9LyR7aX1gLHN0ZGluOigpPT50Ll9zdGRpblB0cjx0LnN0ZGluLmxlbmd0aD90LnN0ZGluLmNoYXJDb2RlQXQodC5fc3RkaW5QdHIrKyk6KHQuc3RkaW49IiIsbnVsbCkscHJpbnQ6aT0+ZS5zdGRvdXQrPWAke2l9CmAscHJpbnRFcnI6dC5jb25maWcucHJpbnRJbnRlcmxlYXZlZD9pPT5lLnN0ZG91dCs9YCR7aX0KYDppPT5lLnN0ZGVycis9YCR7aX0KYH0pO2NvbnN0IHI9ZS5tb2R1bGUuRlM7ZS5pc0Jhc2VNb2R1bGU/KHQuX2xvZyhgU2V0dGluZyB1cCAke2UudG9vbH0gd2l0aCBiYXNlIG1vZHVsZSBmaWxlc3lzdGVtLi4uYCksci5ta2Rpcih0LmNvbmZpZy5kaXJTaGFyZWQsNTExKSxyLm1rZGlyKGAke3QuY29uZmlnLmRpclNoYXJlZH0vJHt0LmNvbmZpZy5kaXJEYXRhfWAsNTExKSxyLm1rZGlyKGAke3QuY29uZmlnLmRpclNoYXJlZH0vJHt0LmNvbmZpZy5kaXJNb3VudGVkfWAsNTExKSxyLmNoZGlyKGAke3QuY29uZmlnLmRpclNoYXJlZH0vJHt0LmNvbmZpZy5kaXJEYXRhfWApLHQuZnM9cik6KHQuX2xvZyhgU2V0dGluZyB1cCAke2UudG9vbH0gd2l0aCBmaWxlc3lzdGVtLi4uYCksci5ta2Rpcih0LmNvbmZpZy5kaXJTaGFyZWQpLHIubW91bnQoZS5tb2R1bGUuUFJPWFlGUyx7cm9vdDp0LmNvbmZpZy5kaXJTaGFyZWQsZnM6dC5mc30sdC5jb25maWcuZGlyU2hhcmVkKSxyLmNoZGlyKHQuZnMuY3dkKCkpKSxlLnN0ZG91dD0iIixlLnN0ZGVycj0iIixlLnJlYWR5PSEwfSxhc3luYyBfc2V0dXBGUygpe2NvbnN0IGU9dC5mcztmb3IobGV0IHIgb2YgdC50b29scyl7aWYoIXIucmVhZHkpY29udGludWU7Y29uc3QgaT1yLm1vZHVsZS5GUyxzPWAvJHtyLnRvb2x9YCxvPWAke3QuY29uZmlnLmRpclNoYXJlZH0ke3N9YDshaS5hbmFseXplUGF0aChzKS5leGlzdHN8fGUuYW5hbHl6ZVBhdGgobykuZXhpc3RzfHwodC5fbG9nKGBNb3VudGluZyAke3N9IG9udG8gJHt0LmJhc2UudG9vbH0gZmlsZXN5c3RlbSBhdCAke299YCksZS5ta2RpcihvKSxlLm1vdW50KHQuYmFzZS5tb2R1bGUuUFJPWFlGUyx7cm9vdDpzLGZzOml9LG8pKX19LF9maWxlb3AoZSxyKXt0Ll9sb2coYFJ1bm5pbmcgJHtlfSAke3J9YCk7Y29uc3QgaT10LmZzLmFuYWx5emVQYXRoKHIpO2lmKCFpLmV4aXN0cylyZXR1cm4gdC5fbG9nKGBGaWxlICR7cn0gbm90IGZvdW5kLmApLCExO3N3aXRjaChlKXtjYXNlImNhdCI6cmV0dXJuIHQuZnMucmVhZEZpbGUocix7ZW5jb2Rpbmc6InV0ZjgifSk7Y2FzZSJscyI6cmV0dXJuIHQuZnMuaXNGaWxlKGkub2JqZWN0Lm1vZGUpP3QuZnMuc3RhdChyKTp0LmZzLnJlYWRkaXIocik7Y2FzZSJkb3dubG9hZCI6Y29uc3Qgcz1uZXcgQmxvYihbdGhpcy5jYXQocildKTtyZXR1cm4gVVJMLmNyZWF0ZU9iamVjdFVSTChzKX1yZXR1cm4hMX0sX2xvZyhlKXtpZighdC5jb25maWcuZGVidWcpcmV0dXJuO2xldCByPVsuLi5hcmd1bWVudHNdO3Iuc2hpZnQoKSxjb25zb2xlLmxvZyhgJWNbV2ViV29ya2VyXSVjICR7ZX1gLCJmb250LXdlaWdodDpib2xkIiwiIiwuLi5yKX19O3codCl9KSgpOwo=",We=typeof window<"u"&&window.Blob&&new Blob([atob(Je)],{type:"text/javascript;charset=utf-8"});function It(){const t=We&&(window.URL||window.webkitURL).createObjectURL(We);try{return t?new Worker(t):new Worker("data:application/javascript;base64,"+Je)}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}const Rt="https://biowasm.com/cdn/v3",Vt="https://stg.biowasm.com/cdn/v3",Ct={urlCDN:Rt,urlCDNStg:Vt,dirShared:"/shared",dirMounted:"/mnt",dirData:"/data",printInterleaved:!0,callback:null,debug:!1,env:"prd"};class Kt{constructor(e,l={}){if(e==null)throw"Expecting array of tools as input to Aioli constructor.";return Array.isArray(e)||(e=[e]),l=Object.assign({},Ct,l),e=e.map(this._parseTool),l.env==="stg"&&(l.urlCDN=l.urlCDNStg),this.tools=e,this.config=l,this.config.callback!=null&&(this.callback=this.config.callback),delete this.config.callback,this.init()}async init(){const e=new It;this.callback&&(e.onmessage=n=>{n.data.type==="biowasm"&&this.callback(n.data.value)});const l=Te(e);return l.tools=this.tools,l.config=this.config,await l.init(),l}_parseTool(e){if(typeof e!="string")return e;const l=e.split("/");if(l.length!=2&&l.length!=3)throw"Expecting '<tool>/<version>' or '<tool>/<program>/<version>'";return{tool:l[0],program:l.length==3?l[1]:l[0],version:l[l.length-1]}}}function Ht(t){const e=t.split(`
`),l=[],n=[];for(const a of e)a.startsWith("#")?l.push(a):a.trim()!==""&&n.push(a);return n.sort((a,s)=>{const i=a.split("	"),c=s.split("	"),u=i[0].localeCompare(c[0]);return u!==0?u:Number.parseInt(i[3],10)-Number.parseInt(c[3],10)}),[...l,...n].join(`
`)}function Nt(t){const e=t.split(`
`);for(const l of e)if(l.startsWith("##sequence-region")){const n=l.split(/\s+/),o=n[1],a=Number.parseInt(n[3],10);return[o,a]}throw new Error("Could not find the assembly information in the GFF file")}function xt(t){const e=t.split(`
`),l=[];for(const n of e){if(n.startsWith("##FASTA"))break;l.push(n)}return l.join(`
`)}async function zt(t,e,l,n){const o=xt(t),a=Ht(o);console.log(a);const s=await new Kt([{tool:"tabix",version:"1.17",urlPrefix:`${window.location.origin}./tools/tabix`},{tool:"bgzip",version:"1.17",urlPrefix:`${window.location.origin}./tools/bgzip`}]),i=await s.mount([{name:e,data:a}]);await s.exec(`bgzip ${i[0]}`),await s.exec(`tabix -p gff ${i[0]}.gz`);const c=await s.fs.stat(`${i[0]}.gz`),u=await s.read({path:`${i[0]}.gz`,length:c.size}),b=$(u),d=await s.fs.stat(`${i[0]}.gz.tbi`),y=await s.read({path:`${i[0]}.gz.tbi`,length:d.size}),p=$(y);return{alignment:"overlay",id:"gff",linkingId:"SharedXAxis",height:160,width:n,data:{url:b,indexUrl:p,type:"gff",attributesToFields:[{attribute:"gene_biotype",defaultValue:"unknown"},{attribute:"Name",defaultValue:"unknown"},{attribute:"ID",defaultValue:"unknown"}]},color:{type:"nominal",field:"gene_biotype",domain:["protein_coding","tRNA","rRNA","ncRNA","pseudogene","unknown"],range:["#e74c3c","#1abc9c","#f1c40f","#8e44ad","#2c3e50","#3498db"]},tracks:[{dataTransform:[{type:"filter",field:"type",oneOf:["gene","CDS"]},{type:"filter",field:"strand",oneOf:["+"]}],mark:"triangleRight",x:{field:"end",type:"genomic",axis:l},size:{value:30}},{dataTransform:[{type:"filter",field:"type",oneOf:["gene","CDS"]}],mark:"text",text:{field:"Name",type:"nominal"},x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},style:{dy:-15}},{dataTransform:[{type:"filter",field:"type",oneOf:["gene","CDS"]},{type:"filter",field:"strand",oneOf:["-"]}],mark:"triangleLeft",x:{field:"start",type:"genomic"},size:{value:30},style:{align:"right"}},{dataTransform:[{type:"filter",field:"type",oneOf:["gene","CDS"]},{type:"filter",field:"strand",oneOf:["+"]}],mark:"rule",x:{field:"start",type:"genomic"},strokeWidth:{value:10},xe:{field:"end",type:"genomic"},style:{linePattern:{type:"triangleRight",size:5}}},{dataTransform:[{type:"filter",field:"type",oneOf:["gene","CDS"]},{type:"filter",field:"strand",oneOf:["-"]}],mark:"rule",x:{field:"start",type:"genomic"},strokeWidth:{value:10},xe:{field:"end",type:"genomic"},style:{linePattern:{type:"triangleLeft",size:5}}}],row:{field:"strand",type:"nominal",domain:["+","-"]},visibility:[{operation:"less-than",measure:"width",threshold:"|xe-x|",transitionPadding:30,target:"mark"}],style:{background:"lightgray",backgroundOpacity:0},opacity:{value:.8}}}function Tt(t){const e=[],l=t.split(`
`);let n=null,o=null,a=null;for(const s of l)if(s.startsWith("ID   ")){const i=s.match(/^ID\s+(\S+)/);i&&(o=i[1],o=o.replace(";",""))}else if(s.startsWith("OS   ")){const i=s.match(/^OS\s+(.+)/);i&&(a=i[1].trim().replace(/ /g,"_"))}else if(s.startsWith("FT   ")){const i=s.match(/^FT\s+(\S+)\s+(\d+)\.\.(\d+)(\s+)?(.*)?$/);if(i)n&&e.push(n),n={type:i[1],start:parseInt(i[2],10),end:parseInt(i[3],10),strand:"+",attributes:{}};else if(n&&s.startsWith("FT                   /")){const c=s.match(/^FT\s+\/(\S+)=(.*)$/);c&&(n.attributes[c[1]]=c[2].replace(/"/g,""))}}else if(s.startsWith("XX")&&n)break;if(n&&e.push(n),!o)throw new Error("SeqID not found in EMBL file");return a||(a="unknown"),{seqid:o,source:a,features:e}}function Ut(t){const{seqid:e,source:l,features:n}=t;return n.map(o=>{const a=Object.entries(o.attributes).map(([s,i])=>`${s}=${i}`).join(";");return{seqid:e,source:l,type:o.type,start:o.start,end:o.end,score:".",strand:o.strand,phase:".",attributes:a}})}function Jt(t){const e=["##gff-version 3","#!gff-spec-version 1.21","#!gff-spec-date 2012-07-03"],l=t.map(n=>[n.seqid,n.source,n.type,n.start,n.end,n.score,n.strand,n.phase,n.attributes].join("	"));return[...e,...l].join(`
`)}function Ft(t){const e=Tt(t),l=Ut(e);return Jt(l)}function wt(t){let e,l,n,o;function a(i){t[3](i)}let s={name:"files",multiple:!0,$$slots:{meta:[Qt],message:[jt]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.files=t[0]),l=new dt({props:s}),Se.push(()=>Ae(l,"files",a)),l.$on("change",t[2]),{c(){e=I("div"),Ie(l.$$.fragment),this.h()},l(i){e=R(i,"DIV",{class:!0});var c=z(e);Re(l.$$.fragment,c),c.forEach(S),this.h()},h(){h(e,"class","px-2 w-full")},m(i,c){U(i,e,c),Ve(l,e,null),o=!0},p(i,c){const u={};c&256&&(u.$$scope={dirty:c,ctx:i}),!n&&c&1&&(n=!0,u.files=i[0],Oe(()=>n=!1)),l.$set(u)},i(i){o||(H(l.$$.fragment,i),o=!0)},o(i){x(l.$$.fragment,i),o=!1},d(i){i&&S(e),Ce(l)}}}function Bt(t){let e,l;return e=new pt({}),{c(){Ie(e.$$.fragment)},l(n){Re(e.$$.fragment,n)},m(n,o){Ve(e,n,o),l=!0},p:P,i(n){l||(H(e.$$.fragment,n),l=!0)},o(n){x(e.$$.fragment,n),l=!1},d(n){Ce(e,n)}}}function jt(t){let e,l='<span class="font-semibold">Load files</span> or drag and drop';return{c(){e=I("p"),e.innerHTML=l,this.h()},l(n){e=R(n,"P",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-10rbgmq"&&(e.innerHTML=l),this.h()},h(){h(e,"class","text-xl ")},m(n,o){U(n,e,o)},p:P,d(n){n&&S(e)}}}function Qt(t){let e;return{c(){e=Ye("GFF and user plot files allowed.")},l(l){e=ke(l,"GFF and user plot files allowed.")},m(l,n){U(l,e,n)},d(l){l&&S(e)}}}function _t(t){let e,l,n,o='<div><section class="img-bg svelte-1ls4hyu"></section></div> <img class="logo-img mt-20 svelte-1ls4hyu" src="/images/logo2.png" alt="Skeleton Logo"/>',a,s,i="Transposon Sequencing Data Visualiser",c,u,b,d;const y=[Bt,wt],p=[];function G(f,W){return f[1]?0:1}return u=G(t),b=p[u]=y[u](t),{c(){e=I("div"),l=I("div"),n=I("figure"),n.innerHTML=o,a=j(),s=I("h1"),s.textContent=i,c=j(),b.c(),this.h()},l(f){e=R(f,"DIV",{class:!0});var W=z(e);l=R(W,"DIV",{class:!0});var v=z(l);n=R(v,"FIGURE",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-14r1dnn"&&(n.innerHTML=o),a=Q(v),s=R(v,"H1",{class:!0,"data-svelte-h":!0}),O(s)!=="svelte-1opypuh"&&(s.textContent=i),c=Q(v),b.l(v),v.forEach(S),W.forEach(S),this.h()},h(){h(n,"class","card-hover rounded-full svelte-1ls4hyu"),h(s,"class","text-center text-3xl"),h(l,"class","flex flex-col items-center align-baseline justify-center max-w-4xl space-y-10 "),h(e,"class","flex justify-center ")},m(f,W){U(f,e,W),K(e,l),K(l,n),K(l,a),K(l,s),K(l,c),p[u].m(l,null),d=!0},p(f,[W]){let v=u;u=G(f),u===v?p[u].p(f,W):(A(),x(p[v],1,1,()=>{p[v]=null}),q(),b=p[u],b?b.p(f,W):(b=p[u]=y[u](f),b.c()),H(b,1),b.m(l,null))},i(f){d||(H(b),d=!0)},o(f){x(b),d=!1},d(f){f&&S(e),p[u].d()}}}const ve=1e3;function Pt(t){const e=t.split(`
`);let l="",n="",o=!1;for(const a of e){if(a.startsWith("##FASTA")){o=!0;continue}o&&(a.startsWith(">")?n=a:l+=a.trim())}return`${n}'
'${l}`}function Et(t,e,l){let n,o;fe(t,he,d=>l(6,n=d)),fe(t,pe,d=>l(7,o=d));let a,s=!1,i,c;function u(d){if(!a||a.length===0)return;l(1,s=!0);let y=[];for(let p=0;p<a.length;p++){const G=a[p],f=G.name,W=new FileReader;y.push(new Promise((v,Z)=>{W.onload=X=>{var L,m;let Y=(m=(L=X.target)==null?void 0:L.result)==null?void 0:m.toString(),T=!1;if(f.endsWith(".embl")&&(Y=Ft(Y),T=!0),f.endsWith(".gff")||f.endsWith(".gff3")||T){let g="none";n.length===0&&p===0?g="top":g="bottom",[i,c]=Nt(Y),console.log(i,c);const J=zt(Y,f,g,ve);$e.fromText(Y);const k=Pt(Y);console.log(k),pe.fromFasta(k),console.log(o),v(J)}else{const g=[],J=Y.split(`
`);for(const k of J){const[w,D]=k.split(" ");g.push({plus:Number.parseInt(w),minus:Number.parseInt(D)})}et.update(k=>(console.log(f),k.set(f,g),k))}i||(i="chr1",c=Y==null?void 0:Y.split(`
`).length);const V=gt(Y,f,ve);v(V)},W.onerror=Z,W.readAsText(G)}))}Promise.all(y).then(p=>{De(he,n=p,n),tt("/track"),l(1,s=!1)}).catch(p=>{console.error("Error reading files:",p),l(1,s=!1)})}function b(d){a=d,l(0,a)}return[a,s,u,b]}class ll extends oe{constructor(e){super(),ce(this,e,Et,_t,le,{})}}export{ll as component};
