import{s as be,e as Q,h as x,u as $,i as ee,j as te,r as we,t as le,b as Ae,f as ne,v as B,k as ke,n as se,l as Be,c as J,w as Re}from"../chunks/scheduler.Cxdq5DjT.js";import{S as Ie,i as ze,e as T,s as U,c as E,a as j,f as q,d as b,E as ae,l as v,p as oe,g as w,h as z,F,q as H,r as X,u as R,v as Y,t as G,k as N,b as O,A as Ue,w as ye,x as Le,y as Te,z as Ee,C as qe,j as Se}from"../chunks/index.Bp_61F_m.js";import{e as re}from"../chunks/each.J0AVf1RG.js";import{g as We}from"../chunks/stores.WwSWR20J.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.DkJRRaEQ.js";import{g as Ge}from"../chunks/spread.CN4WR7uZ.js";import{P as Ne}from"../chunks/ProgressRadial.BwNK8EGC.js";import{a as Oe}from"../chunks/annotationStore.D01fgoLY.js";import{i as K}from"../chunks/insertStore.DYjMpW1P.js";import{t as Je}from"../chunks/TAStore.BBwXKcJP.js";import{r as Z}from"../chunks/refStore.QQqVLbSJ.js";import{i as ie}from"../chunks/igvStore.CMW3l6uz.js";const Ke=s=>({}),ce=s=>({}),Qe=s=>({}),fe=s=>({}),Xe=s=>({}),ue=s=>({});function de(s){let t,e,l;const c=s[18].lead,a=x(c,s,s[17],ue);return{c(){t=T("div"),a&&a.c(),this.h()},l(n){t=E(n,"DIV",{class:!0});var f=j(t);a&&a.l(f),f.forEach(b),this.h()},h(){v(t,"class",e="dropzone-lead "+s[5])},m(n,f){w(n,t,f),a&&a.m(t,null),l=!0},p(n,f){a&&a.p&&(!l||f[0]&131072)&&$(a,c,n,n[17],l?te(c,n[17],f,Xe):ee(n[17]),ue),(!l||f[0]&32&&e!==(e="dropzone-lead "+n[5]))&&v(t,"class",e)},i(n){l||(H(a,n),l=!0)},o(n){R(a,n),l=!1},d(n){n&&b(t),a&&a.d(n)}}}function Ye(s){let t,e="Upload a file",l;return{c(){t=T("strong"),t.textContent=e,l=G(" or drag and drop")},l(c){t=E(c,"STRONG",{"data-svelte-h":!0}),N(t)!=="svelte-13uz6lq"&&(t.textContent=e),l=O(c," or drag and drop")},m(c,a){w(c,t,a),w(c,l,a)},p:se,d(c){c&&(b(t),b(l))}}}function me(s){let t,e,l;const c=s[18].meta,a=x(c,s,s[17],ce);return{c(){t=T("small"),a&&a.c(),this.h()},l(n){t=E(n,"SMALL",{class:!0});var f=j(t);a&&a.l(f),f.forEach(b),this.h()},h(){v(t,"class",e="dropzone-meta "+s[7])},m(n,f){w(n,t,f),a&&a.m(t,null),l=!0},p(n,f){a&&a.p&&(!l||f[0]&131072)&&$(a,c,n,n[17],l?te(c,n[17],f,Ke):ee(n[17]),ce),(!l||f[0]&128&&e!==(e="dropzone-meta "+n[7]))&&v(t,"class",e)},i(n){l||(H(a,n),l=!0)},o(n){R(a,n),l=!1},d(n){n&&b(t),a&&a.d(n)}}}function Ze(s){let t,e,l,c,a,n,f,g,S,I,M,p,h,m,L,y,A=[{type:"file"},{name:s[2]},{class:l="dropzone-input "+s[9]},s[11]()],P={};for(let r=0;r<A.length;r+=1)P=Q(P,A[r]);let u=s[13].lead&&de(s);const C=s[18].message,k=x(C,s,s[17],fe),_=k||Ye();let o=s[13].meta&&me(s);return{c(){t=T("div"),e=T("input"),c=U(),a=T("div"),n=T("div"),u&&u.c(),f=U(),g=T("div"),_&&_.c(),I=U(),o&&o.c(),this.h()},l(r){t=E(r,"DIV",{class:!0,"data-testid":!0});var d=j(t);e=E(d,"INPUT",{type:!0,name:!0,class:!0}),c=q(d),a=E(d,"DIV",{class:!0});var D=j(a);n=E(D,"DIV",{class:!0});var V=j(n);u&&u.l(V),f=q(V),g=E(V,"DIV",{class:!0});var W=j(g);_&&_.l(W),W.forEach(b),I=q(V),o&&o.l(V),V.forEach(b),D.forEach(b),d.forEach(b),this.h()},h(){ae(e,P),v(g,"class",S="dropzone-message "+s[6]),v(n,"class",M="dropzone-interface-text "+s[4]),v(a,"class",p="dropzone-interface "+s[8]+" "+s[3]),v(t,"class",h="dropzone "+s[10]),v(t,"data-testid","file-dropzone"),oe(t,"opacity-50",s[12].disabled)},m(r,d){w(r,t,d),z(t,e),e.autofocus&&e.focus(),s[32](e),z(t,c),z(t,a),z(a,n),u&&u.m(n,null),z(n,f),z(n,g),_&&_.m(g,null),z(n,I),o&&o.m(n,null),m=!0,L||(y=[F(e,"change",s[31]),F(e,"change",s[19]),F(e,"dragenter",s[20]),F(e,"dragover",s[21]),F(e,"dragleave",s[22]),F(e,"drop",s[23]),F(e,"click",s[24]),F(e,"keydown",s[25]),F(e,"keyup",s[26]),F(e,"keypress",s[27]),F(e,"focus",s[28]),F(e,"focusin",s[29]),F(e,"focusout",s[30])],L=!0)},p(r,d){ae(e,P=Ge(A,[{type:"file"},(!m||d[0]&4)&&{name:r[2]},(!m||d[0]&512&&l!==(l="dropzone-input "+r[9]))&&{class:l},r[11]()])),r[13].lead?u?(u.p(r,d),d[0]&8192&&H(u,1)):(u=de(r),u.c(),H(u,1),u.m(n,f)):u&&(X(),R(u,1,1,()=>{u=null}),Y()),k&&k.p&&(!m||d[0]&131072)&&$(k,C,r,r[17],m?te(C,r[17],d,Qe):ee(r[17]),fe),(!m||d[0]&64&&S!==(S="dropzone-message "+r[6]))&&v(g,"class",S),r[13].meta?o?(o.p(r,d),d[0]&8192&&H(o,1)):(o=me(r),o.c(),H(o,1),o.m(n,null)):o&&(X(),R(o,1,1,()=>{o=null}),Y()),(!m||d[0]&16&&M!==(M="dropzone-interface-text "+r[4]))&&v(n,"class",M),(!m||d[0]&264&&p!==(p="dropzone-interface "+r[8]+" "+r[3]))&&v(a,"class",p),(!m||d[0]&1024&&h!==(h="dropzone "+r[10]))&&v(t,"class",h),(!m||d[0]&5120)&&oe(t,"opacity-50",r[12].disabled)},i(r){m||(H(u),H(_,r),H(o),m=!0)},o(r){R(u),R(_,r),R(o),m=!1},d(r){r&&b(t),s[32](null),u&&u.d(),_&&_.d(r),o&&o.d(),L=!1,we(y)}}}const xe="textarea relative flex justify-center items-center",$e="w-full absolute top-0 left-0 right-0 bottom-0 z-[1] opacity-0 disabled:!opacity-0 cursor-pointer",et="flex justify-center items-center text-center";function tt(s,t,e){let l,c,a;const n=["files","fileInput","name","border","padding","rounded","regionInterface","regionInterfaceText","slotLead","slotMessage","slotMeta"];let f=le(t,n),{$$slots:g={},$$scope:S}=t;const I=Ae(g);let{files:M=void 0}=t,{fileInput:p=void 0}=t,{name:h}=t,{border:m="border-2 border-dashed"}=t,{padding:L="p-4 py-8"}=t,{rounded:y="rounded-container-token"}=t,{regionInterface:A=""}=t,{regionInterfaceText:P=""}=t,{slotLead:u="mb-4"}=t,{slotMessage:C=""}=t,{slotMeta:k="opacity-75"}=t;function _(){return delete f.class,f}function o(i){B.call(this,s,i)}function r(i){B.call(this,s,i)}function d(i){B.call(this,s,i)}function D(i){B.call(this,s,i)}function V(i){B.call(this,s,i)}function W(i){B.call(this,s,i)}function De(i){B.call(this,s,i)}function Me(i){B.call(this,s,i)}function Ve(i){B.call(this,s,i)}function je(i){B.call(this,s,i)}function Ce(i){B.call(this,s,i)}function Fe(i){B.call(this,s,i)}function He(){M=this.files,e(0,M)}function Pe(i){ke[i?"unshift":"push"](()=>{p=i,e(1,p)})}return s.$$set=i=>{e(33,t=Q(Q({},t),ne(i))),e(12,f=le(t,n)),"files"in i&&e(0,M=i.files),"fileInput"in i&&e(1,p=i.fileInput),"name"in i&&e(2,h=i.name),"border"in i&&e(14,m=i.border),"padding"in i&&e(15,L=i.padding),"rounded"in i&&e(16,y=i.rounded),"regionInterface"in i&&e(3,A=i.regionInterface),"regionInterfaceText"in i&&e(4,P=i.regionInterfaceText),"slotLead"in i&&e(5,u=i.slotLead),"slotMessage"in i&&e(6,C=i.slotMessage),"slotMeta"in i&&e(7,k=i.slotMeta),"$$scope"in i&&e(17,S=i.$$scope)},s.$$.update=()=>{e(10,l=`${xe} ${m} ${L} ${y} ${t.class??""}`)},e(9,c=`${$e}`),e(8,a=`${et}`),t=ne(t),[M,p,h,A,P,u,C,k,a,c,l,_,f,I,m,L,y,S,g,o,r,d,D,V,W,De,Me,Ve,je,Ce,Fe,He,Pe]}class st extends Ie{constructor(t){super(),ze(this,t,tt,Ze,be,{files:0,fileInput:1,name:2,border:14,padding:15,rounded:16,regionInterface:3,regionInterfaceText:4,slotLead:5,slotMessage:6,slotMeta:7},null,[-1,-1])}}function he(s,t,e){const l=s.slice();return l[11]=t[e],l[13]=e,l}function lt(s){let t,e='<span class="font-semibold">Load files</span> or drag and drop';return{c(){t=T("p"),t.innerHTML=e,this.h()},l(l){t=E(l,"P",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-10rbgmq"&&(t.innerHTML=e),this.h()},h(){v(t,"class","text-xl ")},m(l,c){w(l,t,c)},p:se,d(l){l&&b(t)}}}function nt(s){let t;return{c(){t=G("Only GFF+FASTA and .userplot files allowed.")},l(e){t=O(e,"Only GFF+FASTA and .userplot files allowed.")},m(e,l){w(e,t,l)},d(e){e&&b(t)}}}function ge(s){let t,e,l,c,a=s[2].name+"",n,f,g,S='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',I,M;return{c(){t=T("div"),e=T("div"),l=T("p"),c=G("Reference: "),n=G(a),f=U(),g=T("button"),g.innerHTML=S,this.h()},l(p){t=E(p,"DIV",{class:!0});var h=j(t);e=E(h,"DIV",{class:!0});var m=j(e);l=E(m,"P",{class:!0});var L=j(l);c=O(L,"Reference: "),n=O(L,a),L.forEach(b),f=q(m),g=E(m,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),N(g)!=="svelte-220c8p"&&(g.innerHTML=S),m.forEach(b),h.forEach(b),this.h()},h(){v(l,"class","text-center text-lg"),v(g,"type","button"),v(g,"class","btn-icon variant-ringed-tertiary"),v(e,"class","flex justify-center items-center space-x-2"),v(t,"class","card p-4 m-2")},m(p,h){w(p,t,h),z(t,e),z(e,l),z(l,c),z(l,n),z(e,f),z(e,g),I||(M=F(g,"click",Z.reset),I=!0)},p(p,h){h&4&&a!==(a=p[2].name+"")&&Se(n,a)},d(p){p&&b(t),I=!1,M()}}}function _e(s){let t,e,l,c,a=s[11][0]+"",n,f,g,S='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',I,M;function p(){return s[6](s[11])}return{c(){t=T("div"),e=T("div"),l=T("p"),c=G("Data: "),n=G(a),f=U(),g=T("button"),g.innerHTML=S,this.h()},l(h){t=E(h,"DIV",{class:!0});var m=j(t);e=E(m,"DIV",{class:!0});var L=j(e);l=E(L,"P",{class:!0});var y=j(l);c=O(y,"Data: "),n=O(y,a),y.forEach(b),f=q(L),g=E(L,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),N(g)!=="svelte-1ocj3pe"&&(g.innerHTML=S),L.forEach(b),m.forEach(b),this.h()},h(){v(l,"class","text-center text-lg"),v(g,"type","button"),v(g,"class","btn-icon variant-ringed-tertiary"),v(e,"class","flex justify-center items-center space-x-2"),v(t,"class","card p-4 m-2")},m(h,m){w(h,t,m),z(t,e),z(e,l),z(l,c),z(l,n),z(e,f),z(e,g),I||(M=F(g,"click",p),I=!0)},p(h,m){s=h,m&8&&a!==(a=s[11][0]+"")&&Se(n,a)},d(h){h&&b(t),I=!1,M()}}}function pe(s){let t,e,l;return e=new Ne({props:{value:void 0,width:"w-14",strokeLinecap:"round"}}),{c(){t=T("div"),ye(e.$$.fragment),this.h()},l(c){t=E(c,"DIV",{class:!0});var a=j(t);Le(e.$$.fragment,a),a.forEach(b),this.h()},h(){v(t,"class","flex items-center justify-center align-middle ml-8")},m(c,a){w(c,t,a),Te(e,t,null),l=!0},p:se,i(c){l||(H(e.$$.fragment,c),l=!0)},o(c){R(e.$$.fragment,c),l=!1},d(c){c&&b(t),Ee(e)}}}function at(s){let t,e,l,c='<div><section class="img-bg svelte-cmzijy"></section></div> <img class="logo-img mt-16 svelte-cmzijy" src="/images/logo2.png" alt="Skeleton Logo"/>',a,n,f="Transposon Sequencing Data Visualiser",g,S,I,M,p,h,m,L,y;function A(o){s[5](o)}let P={name:"files",multiple:!0,$$slots:{meta:[nt],message:[lt]},$$scope:{ctx:s}};s[0]!==void 0&&(P.files=s[0]),I=new st({props:P}),ke.push(()=>Ue(I,"files",A)),I.$on("change",s[4]),I.$on("click",ve),I.$on("drop",ve);let u=s[2].name&&ge(s),C=re(s[3]),k=[];for(let o=0;o<C.length;o+=1)k[o]=_e(he(s,C,o));let _=s[1]&&pe();return{c(){t=T("div"),e=T("div"),l=T("figure"),l.innerHTML=c,a=U(),n=T("h1"),n.textContent=f,g=U(),S=T("div"),ye(I.$$.fragment),p=U(),h=T("div"),u&&u.c(),m=U();for(let o=0;o<k.length;o+=1)k[o].c();L=U(),_&&_.c(),this.h()},l(o){t=E(o,"DIV",{class:!0});var r=j(t);e=E(r,"DIV",{class:!0});var d=j(e);l=E(d,"FIGURE",{class:!0,"data-svelte-h":!0}),N(l)!=="svelte-vpzkus"&&(l.innerHTML=c),a=q(d),n=E(d,"H1",{class:!0,"data-svelte-h":!0}),N(n)!=="svelte-1opypuh"&&(n.textContent=f),g=q(d),S=E(d,"DIV",{class:!0});var D=j(S);Le(I.$$.fragment,D),D.forEach(b),d.forEach(b),r.forEach(b),p=q(o),h=E(o,"DIV",{class:!0});var V=j(h);u&&u.l(V),m=q(V);for(let W=0;W<k.length;W+=1)k[W].l(V);L=q(V),_&&_.l(V),V.forEach(b),this.h()},h(){v(l,"class","card-hover rounded-full svelte-cmzijy"),v(n,"class","text-center text-3xl"),v(S,"class","px-2 w-full"),v(e,"class","flex flex-col items-center align-baseline justify-center max-w-4xl space-y-10 "),v(t,"class","flex justify-center mb-6"),v(h,"class","flex flex-wrap space-4 justify-center")},m(o,r){w(o,t,r),z(t,e),z(e,l),z(e,a),z(e,n),z(e,g),z(e,S),Te(I,S,null),w(o,p,r),w(o,h,r),u&&u.m(h,null),z(h,m);for(let d=0;d<k.length;d+=1)k[d]&&k[d].m(h,null);z(h,L),_&&_.m(h,null),y=!0},p(o,[r]){const d={};if(r&16384&&(d.$$scope={dirty:r,ctx:o}),!M&&r&1&&(M=!0,d.files=o[0],Be(()=>M=!1)),I.$set(d),o[2].name?u?u.p(o,r):(u=ge(o),u.c(),u.m(h,m)):u&&(u.d(1),u=null),r&8){C=re(o[3]);let D;for(D=0;D<C.length;D+=1){const V=he(o,C,D);k[D]?k[D].p(V,r):(k[D]=_e(V),k[D].c(),k[D].m(h,L))}for(;D<k.length;D+=1)k[D].d(1);k.length=C.length}o[1]?_?(_.p(o,r),r&2&&H(_,1)):(_=pe(),_.c(),H(_,1),_.m(h,null)):_&&(X(),R(_,1,1,()=>{_=null}),Y())},i(o){y||(H(I.$$.fragment,o),H(_),y=!0)},o(o){R(I.$$.fragment,o),R(_),y=!1},d(o){o&&(b(t),b(p),b(h)),Ee(I),u&&u.d(),qe(k,o),_&&_.d()}}}function ot(s){const t=s.split(`
`);let e="",l="",c=!1;for(const a of t){if(a.startsWith("##FASTA")){c=!0;continue}c&&(a.startsWith(">")?(l&&(e+=l+`
`),l=a+`
`):l+=a.trim())}return l&&(e+=l+`
`),e.trim()}function ve(){const s=document.getElementsByName("files")[0];s.value=""}function rt(s,t,e){let l,c,a;J(s,ie,p=>e(7,l=p)),J(s,Z,p=>e(2,c=p)),J(s,K,p=>e(3,a=p));const n=We();let f,g=!1;function S(p){if(console.log("Files dropped:",f),!f||f.length===0)return;e(1,g=!0);let h=[];for(let m=0;m<f.length;m++){const L=f[m],y=L.name,A=new FileReader;h.push(new Promise((P,u)=>{A.onload=async C=>{var _,o;let k=(o=(_=C.target)==null?void 0:_.result)==null?void 0:o.toString();if(y.endsWith(".gff")||y.endsWith(".gff3")){await Oe.load(k);const r=ot(k);await Z.load(y,r).catch(d=>{console.error("Error loading reference:",d);const V={message:"Error loading reference: "+d,background:"variant-ghost-error"};n.trigger(V)}),Re(ie,l.locus=void 0,l),await Je.load(r),P(0)}else if(y.endsWith(".userplot")||y.endsWith(".plot"))await K.load(y,k);else{console.error("Unsupported file type:",y);const d={message:"Unsupported file type: "+y,background:"variant-ghost-error"};n.trigger(d),u("Unsupported file type: "+y)}P(0)},A.onerror=u,A.readAsText(L)}))}Promise.all(h).then(m=>{e(1,g=!1)}).catch(m=>{console.error("Error reading files:",m),e(1,g=!1)})}function I(p){f=p,e(0,f)}return[f,g,c,a,S,I,p=>K.remove(p[0])]}class kt extends Ie{constructor(t){super(),ze(this,t,rt,at,be,{})}}export{kt as component};
