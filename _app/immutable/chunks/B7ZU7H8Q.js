import{B as z,c as w}from"./CMHs0aaK.js";import{d as L,w as h}from"./DWhds3qF.js";function q(e){const o=[];return e.forEach((a,l)=>{a.forEach(r=>{const c=r+2,t=`${l}	${r}	${c}`;o.push(t)})}),o.join(`
`)}function A(){const e={raw:new Map},{subscribe:o,set:a,update:l}=h(e);return{subscribe:o,set:a,update:l,reset:()=>a(e),load:async r=>{const c=r.split(`
`);let t="",i="";const f=new Map;for(const u of c)u.startsWith(">")?(t&&i&&f.set(t,i),t=u.substring(1).split(/\s+/)[0].trim(),i=""):i+=u.trim();t&&i&&f.set(t,i);const d=new Map;f.forEach((u,v)=>{const m=[],x=u.toUpperCase();for(let p=0;p<x.length-1;p++)x[p]==="T"&&x[p+1]==="A"&&m.push(p);d.set(v,m)});const b=q(d),n=await new z([{tool:"tabix",version:"1.17",urlPrefix:`${window.location.origin}/tools/tabix`},{tool:"bgzip",version:"1.17",urlPrefix:`${window.location.origin}/tools/bgzip`}]),s=await n.mount([{name:"data.bed",data:b}]);await n.exec(`bgzip ${s[0]}`),await n.exec(`tabix -p bed ${s[0]}.gz`);const g=await n.fs.stat(`${s[0]}.gz`),$=await n.read({path:`${s[0]}.gz`,length:g.size}),S=w($),F=await n.fs.stat(`${s[0]}.gz.tbi`),M=await n.read({path:`${s[0]}.gz.tbi`,length:F.size}),U=w(M);a({raw:d,url:S,indexUrl:U})}}}const B=A();L(B,e=>e);function C(){const e={text:void 0,url:void 0,indexUrl:void 0,filename:void 0},{subscribe:o,set:a,update:l}=h(e);return{subscribe:o,set:a,update:l,reset:()=>a(e),load:async(r,c)=>{const t=await new z([{tool:"samtools",version:"1.17",urlPrefix:`${window.location.origin}/tools/samtools`}]),i=await t.mount([{name:"fasta.fa",data:c}]);await t.exec(`samtools faidx --output fasta.fa --fai-idx fasta.fai ${i[0]}`);const f=await t.fs.stat("fasta.fa"),d=await t.read({path:"fasta.fa",length:f.size}),b=w(d),n=await t.fs.stat("fasta.fai"),s=await t.read({path:"fasta.fai",length:n.size}),g=w(s);a({filename:r,text:c,url:b,indexUrl:g})}}}const P=C(),R=h({locus:void 0});export{R as i,P as r,B as t};
