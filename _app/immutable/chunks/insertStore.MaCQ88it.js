import{d as h,w as p}from"./index.1X6iZZfA.js";function d(){const{subscribe:c,set:i,update:n}=p(new Map);return{subscribe:c,set:i,update:n,reset:()=>i(new Map),load:async(t,e)=>{const s=await w(e);t.toLowerCase().includes("0")||(s.isTreatment=!0),n(r=>(r.set(t,s),r))},remove:t=>n(e=>(e.delete(t),e)),setIsTreatment:(t,e)=>n(s=>{const r=s.get(t);return r&&(r.isTreatment=e),s}),containsControlAndTreatment:()=>{let t=!1,e=!1;return c(s=>{s.forEach(r=>{console.log(r.isTreatment),r.isTreatment?t=!0:e=!0})}),t&&e}}}async function w(c,i=5e4){var r;const n=c.split(`
`),t={wig:c,chromosomes:new Map,isTreatment:!1},e={};let s;for(let a=0;a<n.length;a+=i)n.slice(a,a+i).forEach(o=>{if(o.startsWith("variableStep"))s=o.split("chrom=")[1].split(/\s+/)[0],e[s]=new Map;else{if(o.startsWith("fixedStep"))throw new Error("Fixed step WIG files are not supported");if(/^\d/.test(o)){const[m,f]=o.split(/\s+/).map(u=>parseInt(u,10));if(s===void 0)throw new Error("Invalid WIG file format: missing chromosome (chrom=) line");e[s].set(m,(e[s].get(m)||0)+Math.abs(f))}}}),await new Promise(o=>setTimeout(o,0));for(const a in e){const l=Math.max(...Array.from(e[a].keys()));for(let o=0;o<=l;o++)t.chromosomes.set(a,t.chromosomes.get(a)||[]),(r=t.chromosomes.get(a))==null||r.push(e[a].get(o)||0)}return t}const T=d(),I=h(T,c=>{let i=!1,n=!1;return c.forEach(t=>{t.isTreatment?i=!0:n=!0}),i&&n});export{I as c,T as i};
